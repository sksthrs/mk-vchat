/*! For license information please see mekiku.js.LICENSE.txt */
(()=>{var e={571:e=>{var t;globalThis,t=function(){return function(e){var t={};function n(i){if(t[i])return t[i].exports;var o=t[i]={i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(i,o,function(t){return e[t]}.bind(null,o));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s="./src/peer.js")}({"./node_modules/@jitsi/sdp-interop/lib/array-equals.js":function(e,t){e.exports=function e(t){if(!t)return!1;if(this.length!=t.length)return!1;for(var n=0,i=this.length;n<i;n++)if(this[n]instanceof Array&&t[n]instanceof Array){if(!e.apply(this[n],[t[n]]))return!1}else if(this[n]!=t[n])return!1;return!0}},"./node_modules/@jitsi/sdp-interop/lib/index.js":function(e,t,n){t.Interop=n("./node_modules/@jitsi/sdp-interop/lib/interop.js")},"./node_modules/@jitsi/sdp-interop/lib/interop.js":function(e,t,n){"use strict";var i=n("./node_modules/@jitsi/sdp-interop/lib/transform.js"),o=n("./node_modules/@jitsi/sdp-interop/lib/array-equals.js");function r(e){"number"==typeof e.mid&&(e.mid=e.mid.toString())}function s(){this.cache={mlB2UMap:{},mlU2BMap:{}}}e.exports=s,s.prototype.candidateToUnifiedPlan=function(e){var t=new RTCIceCandidate(e);return t.sdpMLineIndex=this.cache.mlB2UMap[t.sdpMLineIndex],t},s.prototype.candidateToPlanB=function(e){var t=new RTCIceCandidate(e);if(0===t.sdpMid.indexOf("audio"))t.sdpMid="audio";else{if(0!==t.sdpMid.indexOf("video"))throw new Error("candidate with "+t.sdpMid+" not allowed");t.sdpMid="video"}return t.sdpMLineIndex=this.cache.mlU2BMap[t.sdpMLineIndex],t},s.prototype.getFirstSendingIndexFromAnswer=function(e){if(!this.cache.answer)return null;var t=i.parse(this.cache.answer);if(t&&t.media&&Array.isArray(t.media))for(var n=0;n<t.media.length;n++)if(t.media[n].type==e&&(!t.media[n].direction||"sendrecv"===t.media[n].direction||"sendonly"===t.media[n].direction))return n;return null},s.prototype.toPlanB=function(e){var t=this;if("object"!=typeof e||null===e||"string"!=typeof e.sdp)return console.warn("An empty description was passed as an argument."),e;var n=i.parse(e.sdp);if(void 0===n.media||!Array.isArray(n.media)||0===n.media.length)return console.warn("The description has no media."),e;if(n.media.length<=3&&n.media.every((function(e){return-1!==["video","audio","data"].indexOf(e.mid)})))return console.warn("This description does not look like Unified Plan."),e;for(var s=e.sdp,c=!1,u=0;u<n.media.length;u++)n.media[u].rtp.forEach((function(e){if("NULL"===e.codec){c=!0;var n=i.parse(t.cache.offer);e.codec=n.media[u].rtp[0].codec}}));c&&(s=i.write(n)),this.cache[e.type]=s;var d=n.media;n.media=[];var l={},h=[],p={};d.forEach((function(e){if(r(e),("string"!=typeof e.rtcpMux||"rtcp-mux"!==e.rtcpMux)&&"inactive"!==e.direction&&"application"!==e.type)throw new Error("Cannot convert to Plan B because m-lines without the rtcp-mux attribute were found.");void 0!==l[e.type]&&"inactive"!==l[e.type].direction||(l[e.type]=e)})),d.forEach((function(e){var t=e.type;if("application"===t)return e.mid="data",n.media.push(e),void h.push(e.mid);"object"==typeof e.sources&&Object.keys(e.sources).forEach((function(n){"object"!=typeof l[t].sources&&(l[t].sources={}),l[t].sources[n]=e.sources[n],void 0!==e.msid&&(l[t].sources[n].msid=e.msid)})),void 0!==e.ssrcGroups&&Array.isArray(e.ssrcGroups)&&(void 0!==l[t].ssrcGroups&&Array.isArray(l[t].ssrcGroups)||(l[t].ssrcGroups=[]),o.apply(l[t].ssrcGroups,[e.ssrcGroups])||(l[t].ssrcGroups=l[t].ssrcGroups.concat(e.ssrcGroups)));var i=e.direction;p[t]=(p[t]||0)|a[i||"inactive"],l[t]===e&&(e.mid=t,delete e.bundleOnly,delete e.msid,"inactive"!==i&&h.push(t),n.media.push(e))})),n.groups.some((function(e){if("BUNDLE"===e.type)return e.mids=h.join(" "),!0})),n.msidSemantic={semantic:"WMS",token:"*"};var f=i.write(n);return new RTCSessionDescription({type:e.type,sdp:f})},s.prototype.toUnifiedPlan=function(e){var t=this;if("object"!=typeof e||null===e||"string"!=typeof e.sdp)return console.warn("An empty description was passed as an argument."),e;var n=i.parse(e.sdp);if(void 0===n.media||!Array.isArray(n.media)||0===n.media.length)return console.warn("The description has no media."),e;if(n.media.length>3||!n.media.every((function(e){return-1!==["video","audio","data"].indexOf(e.mid)})))return console.warn("This description does not look like Plan B."),e;var s=[];n.media.forEach((function(e){s.push(e.mid)}));var a,c=!1;if(void 0!==n.groups&&Array.isArray(n.groups)&&(c=n.groups.every((function(e){return"BUNDLE"!==e.type||o.apply(e.mids.sort(),[s.sort()])}))),!c)throw new Error("Cannot convert to Unified Plan because m-lines that are not bundled were found.");void 0!==this.cache[e.type]&&(a=i.parse(this.cache[e.type]));var u={audio:{},video:{}},d={},l=0,h=0;if(n.media.forEach((function(n){if(("string"!=typeof n.rtcpMux||"rtcp-mux"!==n.rtcpMux)&&"inactive"!==n.direction&&"application"!==n.type)throw new Error("Cannot convert to Unified Plan because m-lines without the rtcp-mux attribute were found.");if("application"===n.type){var i=null;return a&&a.media&&(i=a.media.find((function(e){return"application"===e.type}))),void(i?d[i.mid]=i:d[n.mid]=n)}var o=n.sources,s=n.ssrcGroups,c=n.candidates,p=n.iceUfrag,f=n.icePwd,m=n.fingerprint,g=n.port;delete n.sources,delete n.ssrcGroups,delete n.candidates,delete n.iceUfrag,delete n.icePwd,delete n.fingerprint,delete n.port,delete n.mid;var y={};void 0!==s&&Array.isArray(s)&&s.forEach((function(e){"SIM"!==e.semantics&&void 0!==e.ssrcs&&Array.isArray(e.ssrcs)&&e.ssrcs.forEach((function(t){void 0===y[t]&&(y[t]=[]),y[t].push(e)}))}));var v={};"object"==typeof o&&Object.keys(o).forEach((function(i){var s;if("offer"!==e.type||o[i].msid)if(void 0!==y[i]&&Array.isArray(y[i])&&y[i].some((function(e){return e.ssrcs.some((function(e){if("object"==typeof v[e])return s=v[e],!0}))})),"object"==typeof s)s.sources[i]=o[i],delete o[i].msid;else{if(s=Object.create(n),v[i]=s,void 0!==o[i].msid&&(s.msid=o[i].msid,delete o[i].msid),s.sources={},s.sources[i]=o[i],s.ssrcGroups=y[i],void 0!==a&&void 0!==a.media&&Array.isArray(a.media)&&a.media.forEach((function(e){"object"==typeof e.sources&&Object.keys(e.sources).forEach((function(t){t===i&&(s.mid=e.mid)}))})),r(s),void 0===s.mid){if("answer"===e.type)throw new Error("An unmapped SSRC was found.");s.mid=[n.type,"-",i].join("")}s.candidates=c,s.iceUfrag=p,s.icePwd=f,s.fingerprint=m,s.port=g,d[s.mid]=s,t.cache.mlU2BMap[h]=l,void 0===t.cache.mlB2UMap[l]&&(t.cache.mlB2UMap[l]=h),h++}else u[n.type][i]=o[i]})),l++})),n.media=[],s=[],"answer"===e.type)for(var p=0;p<a.media.length;p++){var f=a.media[p];r(f),void 0===d[f.mid]&&(delete f.msid,delete f.sources,delete f.ssrcGroups,f.direction&&"sendrecv"!==f.direction?"sendonly"===f.direction&&(f.direction="inactive"):f.direction="recvonly"),n.media.push(f),"string"==typeof f.mid&&s.push(f.mid)}else void 0!==a&&void 0!==a.media&&Array.isArray(a.media)&&a.media.forEach((function(e){r(e),s.push(e.mid),void 0!==d[e.mid]?n.media.push(d[e.mid]):(delete e.msid,delete e.sources,delete e.ssrcGroups,e.direction&&"sendrecv"!==e.direction||(e.direction="recvonly"),e.direction&&"sendonly"!==e.direction||(e.direction="inactive"),n.media.push(e))})),Object.keys(d).forEach((function(e){-1===s.indexOf(e)&&(s.push(e),"recvonly"===d[e].direction?n.media.some((function(t){if(("sendrecv"===t.direction||"sendonly"===t.direction)&&t.type===d[e].type)return Object.keys(d[e].sources).forEach((function(n){t.sources[n]=d[e].sources[n]})),!0})):n.media.push(d[e]))}));["audio","video"].forEach((function(e){if(n&&n.media&&Array.isArray(n.media)){var i=null;if(Object.keys(u[e]).length>0&&null===(i=t.getFirstSendingIndexFromAnswer(e)))for(var o=0;o<n.media.length;o++)if(n.media[o].type===e){i=o;break}if(i&&n.media.length>i){var r=n.media[i];Object.keys(u[e]).forEach((function(t){r.sources&&r.sources[t]&&console.warn("Replacing an existing SSRC."),r.sources||(r.sources={}),r.sources[t]=u[e][t]}))}}})),n.groups.some((function(e){if("BUNDLE"===e.type)return e.mids=s.join(" "),!0})),n.msidSemantic={semantic:"WMS",token:"*"};var m=i.write(n);return this.cache[e.type]=m,new RTCSessionDescription({type:e.type,sdp:m})};var a={inactive:0,recvonly:1,sendonly:2,sendrecv:3}},"./node_modules/@jitsi/sdp-interop/lib/transform.js":function(e,t,n){var i=n("./node_modules/@jitsi/sdp-interop/node_modules/sdp-transform/lib/index.js");t.write=function(e,t){return void 0!==e&&void 0!==e.media&&Array.isArray(e.media)&&e.media.forEach((function(e){void 0!==e.sources&&0!==Object.keys(e.sources).length&&(e.ssrcs=[],Object.keys(e.sources).forEach((function(t){var n=e.sources[t];Object.keys(n).forEach((function(i){e.ssrcs.push({id:t,attribute:i,value:n[i]})}))})),delete e.sources),void 0!==e.ssrcGroups&&Array.isArray(e.ssrcGroups)&&e.ssrcGroups.forEach((function(e){void 0!==e.ssrcs&&Array.isArray(e.ssrcs)&&(e.ssrcs=e.ssrcs.join(" "))}))})),void 0!==e&&void 0!==e.groups&&Array.isArray(e.groups)&&e.groups.forEach((function(e){void 0!==e.mids&&Array.isArray(e.mids)&&(e.mids=e.mids.join(" "))})),i.write(e,t)},t.parse=function(e){var t=i.parse(e);return void 0!==t&&void 0!==t.media&&Array.isArray(t.media)&&t.media.forEach((function(e){void 0!==e.ssrcs&&Array.isArray(e.ssrcs)&&(e.sources={},e.ssrcs.forEach((function(t){e.sources[t.id]||(e.sources[t.id]={}),e.sources[t.id][t.attribute]=t.value})),delete e.ssrcs),void 0!==e.ssrcGroups&&Array.isArray(e.ssrcGroups)&&e.ssrcGroups.forEach((function(e){"string"==typeof e.ssrcs&&(e.ssrcs=e.ssrcs.split(" "))}))})),void 0!==t&&void 0!==t.groups&&Array.isArray(t.groups)&&t.groups.forEach((function(e){"string"==typeof e.mids&&(e.mids=e.mids.split(" "))})),t}},"./node_modules/@jitsi/sdp-interop/node_modules/sdp-transform/lib/grammar.js":function(e,t){var n=e.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w\/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-\.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(e){return e.encoding?"rtpmap:%d %s/%s/%s":e.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(e){return null!=e.address?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%d trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(e){return null!=e.subtype?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))? (\S*)(?: (\S*))?/,names:["value","direction","uri","config"],format:function(e){return"extmap:%d"+(e.direction?"/%s":"%v")+" %s"+(e.config?" %s":"")}},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(e){return null!=e.sessionConfig?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(e){var t="candidate:%s %d %s %d %s %d typ %s";return t+=null!=e.raddr?" raddr %s rport %d":"%v%v",t+=null!=e.tcptype?" tcptype %s":"%v",null!=e.generation&&(t+=" generation %d"),(t+=null!=e["network-id"]?" network-id %d":"%v")+(null!=e["network-cost"]?" network-cost %d":"%v")}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_]*)(?::(.*))?/,names:["id","attribute","value"],format:function(e){var t="ssrc:%d";return null!=e.attribute&&(t+=" %s",null!=e.value&&(t+=":%s")),t}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_\/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(e){return null!=e.maxMessageSize?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(e){return e.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(e){return"imageattr:%s %s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(e){return"simulcast:%s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{push:"invalid",names:["value"]}]};Object.keys(n).forEach((function(e){n[e].forEach((function(e){e.reg||(e.reg=/(.*)/),e.format||(e.format="%s")}))}))},"./node_modules/@jitsi/sdp-interop/node_modules/sdp-transform/lib/index.js":function(e,t,n){var i=n("./node_modules/@jitsi/sdp-interop/node_modules/sdp-transform/lib/parser.js"),o=n("./node_modules/@jitsi/sdp-interop/node_modules/sdp-transform/lib/writer.js");t.write=o,t.parse=i.parse,t.parseFmtpConfig=i.parseFmtpConfig,t.parseParams=i.parseParams,t.parsePayloads=i.parsePayloads,t.parseRemoteCandidates=i.parseRemoteCandidates,t.parseImageAttributes=i.parseImageAttributes,t.parseSimulcastStreamList=i.parseSimulcastStreamList},"./node_modules/@jitsi/sdp-interop/node_modules/sdp-transform/lib/parser.js":function(e,t,n){var i=function(e){return String(Number(e))===e?Number(e):e},o=function(e,t,n){var o=e.name&&e.names;e.push&&!t[e.push]?t[e.push]=[]:o&&!t[e.name]&&(t[e.name]={});var r=e.push?{}:o?t[e.name]:t;!function(e,t,n,o){if(o&&!n)t[o]=i(e[1]);else for(var r=0;r<n.length;r+=1)null!=e[r+1]&&(t[n[r]]=i(e[r+1]))}(n.match(e.reg),r,e.names,e.name),e.push&&t[e.push].push(r)},r=n("./node_modules/@jitsi/sdp-interop/node_modules/sdp-transform/lib/grammar.js"),s=RegExp.prototype.test.bind(/^([a-z])=(.*)/);t.parse=function(e){var t={},n=[],i=t;return e.split(/(\r\n|\r|\n)/).filter(s).forEach((function(e){var t=e[0],s=e.slice(2);"m"===t&&(n.push({rtp:[],fmtp:[]}),i=n[n.length-1]);for(var a=0;a<(r[t]||[]).length;a+=1){var c=r[t][a];if(c.reg.test(s))return o(c,i,s)}})),t.media=n,t};var a=function(e,t){var n=t.split(/=(.+)/,2);return 2===n.length&&(e[n[0]]=i(n[1])),e};t.parseParams=function(e){return e.split(/\;\s?/).reduce(a,{})},t.parseFmtpConfig=t.parseParams,t.parsePayloads=function(e){return e.split(" ").map(Number)},t.parseRemoteCandidates=function(e){for(var t=[],n=e.split(" ").map(i),o=0;o<n.length;o+=3)t.push({component:n[o],ip:n[o+1],port:n[o+2]});return t},t.parseImageAttributes=function(e){return e.split(" ").map((function(e){return e.substring(1,e.length-1).split(",").reduce(a,{})}))},t.parseSimulcastStreamList=function(e){return e.split(";").map((function(e){return e.split(",").map((function(e){var t,n=!1;return"~"!==e[0]?t=i(e):(t=i(e.substring(1,e.length)),n=!0),{scid:t,paused:n}}))}))}},"./node_modules/@jitsi/sdp-interop/node_modules/sdp-transform/lib/writer.js":function(e,t,n){var i=n("./node_modules/@jitsi/sdp-interop/node_modules/sdp-transform/lib/grammar.js"),o=/%[sdv%]/g,r=function(e){var t=1,n=arguments,i=n.length;return e.replace(o,(function(e){if(t>=i)return e;var o=n[t];switch(t+=1,e){case"%%":return"%";case"%s":return String(o);case"%d":return Number(o);case"%v":return""}}))},s=function(e,t,n){var i=[e+"="+(t.format instanceof Function?t.format(t.push?n:n[t.name]):t.format)];if(t.names)for(var o=0;o<t.names.length;o+=1){var s=t.names[o];t.name?i.push(n[t.name][s]):i.push(n[t.names[o]])}else i.push(n[t.name]);return r.apply(null,i)},a=["v","o","s","i","u","e","p","c","b","t","r","z","a"],c=["i","c","b","a"];e.exports=function(e,t){t=t||{},null==e.version&&(e.version=0),null==e.name&&(e.name=" "),e.media.forEach((function(e){null==e.payloads&&(e.payloads="")}));var n=t.outerOrder||a,o=t.innerOrder||c,r=[];return n.forEach((function(t){i[t].forEach((function(n){n.name in e&&null!=e[n.name]?r.push(s(t,n,e)):n.push in e&&null!=e[n.push]&&e[n.push].forEach((function(e){r.push(s(t,n,e))}))}))})),e.media.forEach((function(e){r.push(s("m",i.m[0],e)),o.forEach((function(t){i[t].forEach((function(n){n.name in e&&null!=e[n.name]?r.push(s(t,n,e)):n.push in e&&null!=e[n.push]&&e[n.push].forEach((function(e){r.push(s(t,n,e))}))}))}))})),r.join("\r\n")+"\r\n"}},"./node_modules/after/index.js":function(e,t){function n(){}e.exports=function(e,t,i){var o=!1;return i=i||n,r.count=e,0===e?t():r;function r(e,n){if(r.count<=0)throw new Error("after called too many times");--r.count,e?(o=!0,t(e),t=i):0!==r.count||o||t(null,n)}}},"./node_modules/arraybuffer.slice/index.js":function(e,t){e.exports=function(e,t,n){var i=e.byteLength;if(t=t||0,n=n||i,e.slice)return e.slice(t,n);if(t<0&&(t+=i),n<0&&(n+=i),n>i&&(n=i),t>=i||t>=n||0===i)return new ArrayBuffer(0);for(var o=new Uint8Array(e),r=new Uint8Array(n-t),s=t,a=0;s<n;s++,a++)r[a]=o[s];return r.buffer}},"./node_modules/backo2/index.js":function(e,t){function n(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}e.exports=n,n.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-n:e+n}return 0|Math.min(e,this.max)},n.prototype.reset=function(){this.attempts=0},n.prototype.setMin=function(e){this.ms=e},n.prototype.setMax=function(e){this.max=e},n.prototype.setJitter=function(e){this.jitter=e}},"./node_modules/base64-arraybuffer/lib/base64-arraybuffer.js":function(e,t){!function(e){"use strict";t.encode=function(t){var n,i=new Uint8Array(t),o=i.length,r="";for(n=0;n<o;n+=3)r+=e[i[n]>>2],r+=e[(3&i[n])<<4|i[n+1]>>4],r+=e[(15&i[n+1])<<2|i[n+2]>>6],r+=e[63&i[n+2]];return o%3==2?r=r.substring(0,r.length-1)+"=":o%3==1&&(r=r.substring(0,r.length-2)+"=="),r},t.decode=function(t){var n,i,o,r,s,a=.75*t.length,c=t.length,u=0;"="===t[t.length-1]&&(a--,"="===t[t.length-2]&&a--);var d=new ArrayBuffer(a),l=new Uint8Array(d);for(n=0;n<c;n+=4)i=e.indexOf(t[n]),o=e.indexOf(t[n+1]),r=e.indexOf(t[n+2]),s=e.indexOf(t[n+3]),l[u++]=i<<2|o>>4,l[u++]=(15&o)<<4|r>>2,l[u++]=(3&r)<<6|63&s;return d}}("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/")},"./node_modules/base64-js/index.js":function(e,t,n){"use strict";t.byteLength=function(e){var t=u(e),n=t[0],i=t[1];return 3*(n+i)/4-i},t.toByteArray=function(e){var t,n,i=u(e),s=i[0],a=i[1],c=new r(function(e,t,n){return 3*(t+n)/4-n}(0,s,a)),d=0,l=a>0?s-4:s;for(n=0;n<l;n+=4)t=o[e.charCodeAt(n)]<<18|o[e.charCodeAt(n+1)]<<12|o[e.charCodeAt(n+2)]<<6|o[e.charCodeAt(n+3)],c[d++]=t>>16&255,c[d++]=t>>8&255,c[d++]=255&t;return 2===a&&(t=o[e.charCodeAt(n)]<<2|o[e.charCodeAt(n+1)]>>4,c[d++]=255&t),1===a&&(t=o[e.charCodeAt(n)]<<10|o[e.charCodeAt(n+1)]<<4|o[e.charCodeAt(n+2)]>>2,c[d++]=t>>8&255,c[d++]=255&t),c},t.fromByteArray=function(e){for(var t,n=e.length,o=n%3,r=[],s=16383,a=0,c=n-o;a<c;a+=s)r.push(d(e,a,a+s>c?c:a+s));return 1===o?(t=e[n-1],r.push(i[t>>2]+i[t<<4&63]+"==")):2===o&&(t=(e[n-2]<<8)+e[n-1],r.push(i[t>>10]+i[t>>4&63]+i[t<<2&63]+"=")),r.join("")};for(var i=[],o=[],r="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,c=s.length;a<c;++a)i[a]=s[a],o[s.charCodeAt(a)]=a;function u(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function d(e,t,n){for(var o,r,s=[],a=t;a<n;a+=3)o=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(255&e[a+2]),s.push(i[(r=o)>>18&63]+i[r>>12&63]+i[r>>6&63]+i[63&r]);return s.join("")}o["-".charCodeAt(0)]=62,o["_".charCodeAt(0)]=63},"./node_modules/blob/index.js":function(e,t){var n=void 0!==n?n:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder&&MozBlobBuilder,i=function(){try{return 2===new Blob(["hi"]).size}catch(e){return!1}}(),o=i&&function(){try{return 2===new Blob([new Uint8Array([1,2])]).size}catch(e){return!1}}(),r=n&&n.prototype.append&&n.prototype.getBlob;function s(e){return e.map((function(e){if(e.buffer instanceof ArrayBuffer){var t=e.buffer;if(e.byteLength!==t.byteLength){var n=new Uint8Array(e.byteLength);n.set(new Uint8Array(t,e.byteOffset,e.byteLength)),t=n.buffer}return t}return e}))}function a(e,t){t=t||{};var i=new n;return s(e).forEach((function(e){i.append(e)})),t.type?i.getBlob(t.type):i.getBlob()}function c(e,t){return new Blob(s(e),t||{})}"undefined"!=typeof Blob&&(a.prototype=Blob.prototype,c.prototype=Blob.prototype),e.exports=i?o?Blob:c:r?a:void 0},"./node_modules/component-bind/index.js":function(e,t){var n=[].slice;e.exports=function(e,t){if("string"==typeof t&&(t=e[t]),"function"!=typeof t)throw new Error("bind() requires a function");var i=n.call(arguments,2);return function(){return t.apply(e,i.concat(n.call(arguments)))}}},"./node_modules/component-emitter/index.js":function(e,t,n){function i(e){if(e)return function(e){for(var t in i.prototype)e[t]=i.prototype[t];return e}(e)}e.exports=i,i.prototype.on=i.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},i.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},i.prototype.off=i.prototype.removeListener=i.prototype.removeAllListeners=i.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,i=this._callbacks["$"+e];if(!i)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var o=0;o<i.length;o++)if((n=i[o])===t||n.fn===t){i.splice(o,1);break}return 0===i.length&&delete this._callbacks["$"+e],this},i.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),n=this._callbacks["$"+e],i=1;i<arguments.length;i++)t[i-1]=arguments[i];if(n){i=0;for(var o=(n=n.slice(0)).length;i<o;++i)n[i].apply(this,t)}return this},i.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},i.prototype.hasListeners=function(e){return!!this.listeners(e).length}},"./node_modules/component-inherit/index.js":function(e,t){e.exports=function(e,t){var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},"./node_modules/debug/src/browser.js":function(e,t,n){(function(i){function o(){var e;try{e=t.storage.debug}catch(e){}return!e&&void 0!==i&&"env"in i&&(e=i.env.DEBUG),e}(t=e.exports=n("./node_modules/debug/src/debug.js")).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function(e){var n=this.useColors;if(e[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+e[0]+(n?"%c ":" ")+"+"+t.humanize(this.diff),n){var i="color: "+this.color;e.splice(1,0,i,"color: inherit");var o=0,r=0;e[0].replace(/%[a-zA-Z%]/g,(function(e){"%%"!==e&&(o++,"%c"===e&&(r=o))})),e.splice(r,0,i)}},t.save=function(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}},t.load=o,t.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},t.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},t.enable(o())}).call(this,n("./node_modules/process/browser.js"))},"./node_modules/debug/src/debug.js":function(e,t,n){function i(e){var n;function i(){if(i.enabled){var e=i,o=+new Date,r=o-(n||o);e.diff=r,e.prev=n,e.curr=o,n=o;for(var s=new Array(arguments.length),a=0;a<s.length;a++)s[a]=arguments[a];s[0]=t.coerce(s[0]),"string"!=typeof s[0]&&s.unshift("%O");var c=0;s[0]=s[0].replace(/%([a-zA-Z%])/g,(function(n,i){if("%%"===n)return n;c++;var o=t.formatters[i];if("function"==typeof o){var r=s[c];n=o.call(e,r),s.splice(c,1),c--}return n})),t.formatArgs.call(e,s);var u=i.log||t.log||console.log.bind(console);u.apply(e,s)}}return i.namespace=e,i.enabled=t.enabled(e),i.useColors=t.useColors(),i.color=function(e){var n,i=0;for(n in e)i=(i<<5)-i+e.charCodeAt(n),i|=0;return t.colors[Math.abs(i)%t.colors.length]}(e),i.destroy=o,"function"==typeof t.init&&t.init(i),t.instances.push(i),i}function o(){var e=t.instances.indexOf(this);return-1!==e&&(t.instances.splice(e,1),!0)}(t=e.exports=i.debug=i.default=i).coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){t.enable("")},t.enable=function(e){var n;t.save(e),t.names=[],t.skips=[];var i=("string"==typeof e?e:"").split(/[\s,]+/),o=i.length;for(n=0;n<o;n++)i[n]&&("-"===(e=i[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")));for(n=0;n<t.instances.length;n++){var r=t.instances[n];r.enabled=t.enabled(r.namespace)}},t.enabled=function(e){if("*"===e[e.length-1])return!0;var n,i;for(n=0,i=t.skips.length;n<i;n++)if(t.skips[n].test(e))return!1;for(n=0,i=t.names.length;n<i;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=n("./node_modules/ms/index.js"),t.instances=[],t.names=[],t.skips=[],t.formatters={}},"./node_modules/decode-uri-component/index.js":function(e,t,n){"use strict";var i="%[a-f0-9]{2}",o=new RegExp(i,"gi"),r=new RegExp("("+i+")+","gi");function s(e,t){try{return decodeURIComponent(e.join(""))}catch(e){}if(1===e.length)return e;t=t||1;var n=e.slice(0,t),i=e.slice(t);return Array.prototype.concat.call([],s(n),s(i))}function a(e){try{return decodeURIComponent(e)}catch(i){for(var t=e.match(o),n=1;n<t.length;n++)t=(e=s(t,n).join("")).match(o);return e}}e.exports=function(e){if("string"!=typeof e)throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof e+"`");try{return e=e.replace(/\+/g," "),decodeURIComponent(e)}catch(t){return function(e){for(var t={"%FE%FF":"��","%FF%FE":"��"},n=r.exec(e);n;){try{t[n[0]]=decodeURIComponent(n[0])}catch(e){var i=a(n[0]);i!==n[0]&&(t[n[0]]=i)}n=r.exec(e)}t["%C2"]="�";for(var o=Object.keys(t),s=0;s<o.length;s++){var c=o[s];e=e.replace(new RegExp(c,"g"),t[c])}return e}(e)}}},"./node_modules/detect-browser/index.js":function(e,t,n){"use strict";(function(e){var n=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var i=Array(e),o=0;for(t=0;t<n;t++)for(var r=arguments[t],s=0,a=r.length;s<a;s++,o++)i[o]=r[s];return i};Object.defineProperty(t,"__esModule",{value:!0});var i=function(e,t,n){this.name=e,this.version=t,this.os=n};t.BrowserInfo=i;var o=function(t){this.version=t,this.name="node",this.os=e.platform};t.NodeInfo=o;var r=function(){this.bot=!0,this.name="bot",this.version=null,this.os=null};t.BotInfo=r;var s=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["vivaldi",/Vivaldi\/([0-9\.]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/Edg\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FBAV\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["searchbot",/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/]],a=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/],["Search Bot",/(nuhk)|(Googlebot)|(Yammybot)|(Openbot)|(Slurp)|(MSNBot)|(Ask Jeeves\/Teoma)|(ia_archiver)/]];function c(e){var t=""!==e&&s.reduce((function(t,n){var i=n[0],o=n[1];if(t)return t;var r=o.exec(e);return!!r&&[i,r]}),!1);if(!t)return null;var o=t[0],a=t[1];if("searchbot"===o)return new r;var c=a[1]&&a[1].split(/[._]/).slice(0,3);return c?c.length<3&&(c=n(c,function(e){for(var t=[],n=0;n<e;n++)t.push("0");return t}(3-c.length))):c=[],new i(o,c.join("."),u(e))}function u(e){for(var t=0,n=a.length;t<n;t++){var i=a[t],o=i[0];if(i[1].test(e))return o}return null}function d(){return void 0!==e&&e.version?new o(e.version.slice(1)):null}t.detect=function(e){return e?c(e):"undefined"!=typeof navigator?c(navigator.userAgent):d()},t.parseUserAgent=c,t.detectOS=u,t.getNodeVersion=d}).call(this,n("./node_modules/process/browser.js"))},"./node_modules/engine.io-client/lib/globalThis.browser.js":function(e,t){e.exports="undefined"!=typeof self?self:"undefined"!=typeof window?window:Function("return this")()},"./node_modules/engine.io-client/lib/index.js":function(e,t,n){e.exports=n("./node_modules/engine.io-client/lib/socket.js"),e.exports.parser=n("./node_modules/engine.io-parser/lib/browser.js")},"./node_modules/engine.io-client/lib/socket.js":function(e,t,n){var i=n("./node_modules/engine.io-client/lib/transports/index.js"),o=n("./node_modules/component-emitter/index.js"),r=n("./node_modules/debug/src/browser.js")("engine.io-client:socket"),s=n("./node_modules/indexof/index.js"),a=n("./node_modules/engine.io-parser/lib/browser.js"),c=n("./node_modules/parseuri/index.js"),u=n("./node_modules/parseqs/index.js");function d(e,t){if(!(this instanceof d))return new d(e,t);t=t||{},e&&"object"==typeof e&&(t=e,e=null),e?(e=c(e),t.hostname=e.host,t.secure="https"===e.protocol||"wss"===e.protocol,t.port=e.port,e.query&&(t.query=e.query)):t.host&&(t.hostname=c(t.host).host),this.secure=null!=t.secure?t.secure:"undefined"!=typeof location&&"https:"===location.protocol,t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.agent=t.agent||!1,this.hostname=t.hostname||("undefined"!=typeof location?location.hostname:"localhost"),this.port=t.port||("undefined"!=typeof location&&location.port?location.port:this.secure?443:80),this.query=t.query||{},"string"==typeof this.query&&(this.query=u.decode(this.query)),this.upgrade=!1!==t.upgrade,this.path=(t.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!t.forceJSONP,this.jsonp=!1!==t.jsonp,this.forceBase64=!!t.forceBase64,this.enablesXDR=!!t.enablesXDR,this.withCredentials=!1!==t.withCredentials,this.timestampParam=t.timestampParam||"t",this.timestampRequests=t.timestampRequests,this.transports=t.transports||["polling","websocket"],this.transportOptions=t.transportOptions||{},this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.policyPort=t.policyPort||843,this.rememberUpgrade=t.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=t.onlyBinaryUpgrades,this.perMessageDeflate=!1!==t.perMessageDeflate&&(t.perMessageDeflate||{}),!0===this.perMessageDeflate&&(this.perMessageDeflate={}),this.perMessageDeflate&&null==this.perMessageDeflate.threshold&&(this.perMessageDeflate.threshold=1024),this.pfx=t.pfx||void 0,this.key=t.key||void 0,this.passphrase=t.passphrase||void 0,this.cert=t.cert||void 0,this.ca=t.ca||void 0,this.ciphers=t.ciphers||void 0,this.rejectUnauthorized=void 0===t.rejectUnauthorized||t.rejectUnauthorized,this.forceNode=!!t.forceNode,this.isReactNative="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase(),("undefined"==typeof self||this.isReactNative)&&(t.extraHeaders&&Object.keys(t.extraHeaders).length>0&&(this.extraHeaders=t.extraHeaders),t.localAddress&&(this.localAddress=t.localAddress)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingIntervalTimer=null,this.pingTimeoutTimer=null,this.open()}e.exports=d,d.priorWebsocketSuccess=!1,o(d.prototype),d.protocol=a.protocol,d.Socket=d,d.Transport=n("./node_modules/engine.io-client/lib/transport.js"),d.transports=n("./node_modules/engine.io-client/lib/transports/index.js"),d.parser=n("./node_modules/engine.io-parser/lib/browser.js"),d.prototype.createTransport=function(e){r('creating transport "%s"',e);var t=function(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}(this.query);t.EIO=a.protocol,t.transport=e;var n=this.transportOptions[e]||{};return this.id&&(t.sid=this.id),new i[e]({query:t,socket:this,agent:n.agent||this.agent,hostname:n.hostname||this.hostname,port:n.port||this.port,secure:n.secure||this.secure,path:n.path||this.path,forceJSONP:n.forceJSONP||this.forceJSONP,jsonp:n.jsonp||this.jsonp,forceBase64:n.forceBase64||this.forceBase64,enablesXDR:n.enablesXDR||this.enablesXDR,withCredentials:n.withCredentials||this.withCredentials,timestampRequests:n.timestampRequests||this.timestampRequests,timestampParam:n.timestampParam||this.timestampParam,policyPort:n.policyPort||this.policyPort,pfx:n.pfx||this.pfx,key:n.key||this.key,passphrase:n.passphrase||this.passphrase,cert:n.cert||this.cert,ca:n.ca||this.ca,ciphers:n.ciphers||this.ciphers,rejectUnauthorized:n.rejectUnauthorized||this.rejectUnauthorized,perMessageDeflate:n.perMessageDeflate||this.perMessageDeflate,extraHeaders:n.extraHeaders||this.extraHeaders,forceNode:n.forceNode||this.forceNode,localAddress:n.localAddress||this.localAddress,requestTimeout:n.requestTimeout||this.requestTimeout,protocols:n.protocols||void 0,isReactNative:this.isReactNative})},d.prototype.open=function(){var e;if(this.rememberUpgrade&&d.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))e="websocket";else{if(0===this.transports.length){var t=this;return void setTimeout((function(){t.emit("error","No transports available")}),0)}e=this.transports[0]}this.readyState="opening";try{e=this.createTransport(e)}catch(e){return this.transports.shift(),void this.open()}e.open(),this.setTransport(e)},d.prototype.setTransport=function(e){r("setting transport %s",e.name);var t=this;this.transport&&(r("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=e,e.on("drain",(function(){t.onDrain()})).on("packet",(function(e){t.onPacket(e)})).on("error",(function(e){t.onError(e)})).on("close",(function(){t.onClose("transport close")}))},d.prototype.probe=function(e){r('probing transport "%s"',e);var t=this.createTransport(e,{probe:1}),n=!1,i=this;function o(){if(i.onlyBinaryUpgrades){var o=!this.supportsBinary&&i.transport.supportsBinary;n=n||o}n||(r('probe transport "%s" opened',e),t.send([{type:"ping",data:"probe"}]),t.once("packet",(function(o){if(!n)if("pong"===o.type&&"probe"===o.data){if(r('probe transport "%s" pong',e),i.upgrading=!0,i.emit("upgrading",t),!t)return;d.priorWebsocketSuccess="websocket"===t.name,r('pausing current transport "%s"',i.transport.name),i.transport.pause((function(){n||"closed"!==i.readyState&&(r("changing transport and sending upgrade packet"),h(),i.setTransport(t),t.send([{type:"upgrade"}]),i.emit("upgrade",t),t=null,i.upgrading=!1,i.flush())}))}else{r('probe transport "%s" failed',e);var s=new Error("probe error");s.transport=t.name,i.emit("upgradeError",s)}})))}function s(){n||(n=!0,h(),t.close(),t=null)}function a(n){var o=new Error("probe error: "+n);o.transport=t.name,s(),r('probe transport "%s" failed because of error: %s',e,n),i.emit("upgradeError",o)}function c(){a("transport closed")}function u(){a("socket closed")}function l(e){t&&e.name!==t.name&&(r('"%s" works - aborting "%s"',e.name,t.name),s())}function h(){t.removeListener("open",o),t.removeListener("error",a),t.removeListener("close",c),i.removeListener("close",u),i.removeListener("upgrading",l)}d.priorWebsocketSuccess=!1,t.once("open",o),t.once("error",a),t.once("close",c),this.once("close",u),this.once("upgrading",l),t.open()},d.prototype.onOpen=function(){if(r("socket open"),this.readyState="open",d.priorWebsocketSuccess="websocket"===this.transport.name,this.emit("open"),this.flush(),"open"===this.readyState&&this.upgrade&&this.transport.pause){r("starting upgrade probes");for(var e=0,t=this.upgrades.length;e<t;e++)this.probe(this.upgrades[e])}},d.prototype.onPacket=function(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(r('socket receive: type "%s", data "%s"',e.type,e.data),this.emit("packet",e),this.emit("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"pong":this.setPing(),this.emit("pong");break;case"error":var t=new Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emit("data",e.data),this.emit("message",e.data)}else r('packet received with socket readyState "%s"',this.readyState)},d.prototype.onHandshake=function(e){this.emit("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.onOpen(),"closed"!==this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},d.prototype.onHeartbeat=function(e){clearTimeout(this.pingTimeoutTimer);var t=this;t.pingTimeoutTimer=setTimeout((function(){"closed"!==t.readyState&&t.onClose("ping timeout")}),e||t.pingInterval+t.pingTimeout)},d.prototype.setPing=function(){var e=this;clearTimeout(e.pingIntervalTimer),e.pingIntervalTimer=setTimeout((function(){r("writing ping packet - expecting pong within %sms",e.pingTimeout),e.ping(),e.onHeartbeat(e.pingTimeout)}),e.pingInterval)},d.prototype.ping=function(){var e=this;this.sendPacket("ping",(function(){e.emit("ping")}))},d.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emit("drain"):this.flush()},d.prototype.flush=function(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(r("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},d.prototype.write=d.prototype.send=function(e,t,n){return this.sendPacket("message",e,t,n),this},d.prototype.sendPacket=function(e,t,n,i){if("function"==typeof t&&(i=t,t=void 0),"function"==typeof n&&(i=n,n=null),"closing"!==this.readyState&&"closed"!==this.readyState){(n=n||{}).compress=!1!==n.compress;var o={type:e,data:t,options:n};this.emit("packetCreate",o),this.writeBuffer.push(o),i&&this.once("flush",i),this.flush()}},d.prototype.close=function(){if("opening"===this.readyState||"open"===this.readyState){this.readyState="closing";var e=this;this.writeBuffer.length?this.once("drain",(function(){this.upgrading?i():t()})):this.upgrading?i():t()}function t(){e.onClose("forced close"),r("socket closing - telling transport to close"),e.transport.close()}function n(){e.removeListener("upgrade",n),e.removeListener("upgradeError",n),t()}function i(){e.once("upgrade",n),e.once("upgradeError",n)}return this},d.prototype.onError=function(e){r("socket error %j",e),d.priorWebsocketSuccess=!1,this.emit("error",e),this.onClose("transport error",e)},d.prototype.onClose=function(e,t){"opening"!==this.readyState&&"open"!==this.readyState&&"closing"!==this.readyState||(r('socket close with reason: "%s"',e),clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",e,t),this.writeBuffer=[],this.prevBufferLen=0)},d.prototype.filterUpgrades=function(e){for(var t=[],n=0,i=e.length;n<i;n++)~s(this.transports,e[n])&&t.push(e[n]);return t}},"./node_modules/engine.io-client/lib/transport.js":function(e,t,n){var i=n("./node_modules/engine.io-parser/lib/browser.js"),o=n("./node_modules/component-emitter/index.js");function r(e){this.path=e.path,this.hostname=e.hostname,this.port=e.port,this.secure=e.secure,this.query=e.query,this.timestampParam=e.timestampParam,this.timestampRequests=e.timestampRequests,this.readyState="",this.agent=e.agent||!1,this.socket=e.socket,this.enablesXDR=e.enablesXDR,this.withCredentials=e.withCredentials,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.forceNode=e.forceNode,this.isReactNative=e.isReactNative,this.extraHeaders=e.extraHeaders,this.localAddress=e.localAddress}e.exports=r,o(r.prototype),r.prototype.onError=function(e,t){var n=new Error(e);return n.type="TransportError",n.description=t,this.emit("error",n),this},r.prototype.open=function(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this},r.prototype.close=function(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this},r.prototype.send=function(e){if("open"!==this.readyState)throw new Error("Transport not open");this.write(e)},r.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},r.prototype.onData=function(e){var t=i.decodePacket(e,this.socket.binaryType);this.onPacket(t)},r.prototype.onPacket=function(e){this.emit("packet",e)},r.prototype.onClose=function(){this.readyState="closed",this.emit("close")}},"./node_modules/engine.io-client/lib/transports/index.js":function(e,t,n){var i=n("./node_modules/engine.io-client/lib/xmlhttprequest.js"),o=n("./node_modules/engine.io-client/lib/transports/polling-xhr.js"),r=n("./node_modules/engine.io-client/lib/transports/polling-jsonp.js"),s=n("./node_modules/engine.io-client/lib/transports/websocket.js");t.polling=function(e){var t=!1,n=!1,s=!1!==e.jsonp;if("undefined"!=typeof location){var a="https:"===location.protocol,c=location.port;c||(c=a?443:80),t=e.hostname!==location.hostname||c!==e.port,n=e.secure!==a}if(e.xdomain=t,e.xscheme=n,"open"in new i(e)&&!e.forceJSONP)return new o(e);if(!s)throw new Error("JSONP disabled");return new r(e)},t.websocket=s},"./node_modules/engine.io-client/lib/transports/polling-jsonp.js":function(e,t,n){var i=n("./node_modules/engine.io-client/lib/transports/polling.js"),o=n("./node_modules/component-inherit/index.js"),r=n("./node_modules/engine.io-client/lib/globalThis.browser.js");e.exports=d;var s,a=/\n/g,c=/\\n/g;function u(){}function d(e){i.call(this,e),this.query=this.query||{},s||(s=r.___eio=r.___eio||[]),this.index=s.length;var t=this;s.push((function(e){t.onData(e)})),this.query.j=this.index,"function"==typeof addEventListener&&addEventListener("beforeunload",(function(){t.script&&(t.script.onerror=u)}),!1)}o(d,i),d.prototype.supportsBinary=!1,d.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),i.prototype.doClose.call(this)},d.prototype.doPoll=function(){var e=this,t=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),t.async=!0,t.src=this.uri(),t.onerror=function(t){e.onError("jsonp poll error",t)};var n=document.getElementsByTagName("script")[0];n?n.parentNode.insertBefore(t,n):(document.head||document.body).appendChild(t),this.script=t,"undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent)&&setTimeout((function(){var e=document.createElement("iframe");document.body.appendChild(e),document.body.removeChild(e)}),100)},d.prototype.doWrite=function(e,t){var n=this;if(!this.form){var i,o=document.createElement("form"),r=document.createElement("textarea"),s=this.iframeId="eio_iframe_"+this.index;o.className="socketio",o.style.position="absolute",o.style.top="-1000px",o.style.left="-1000px",o.target=s,o.method="POST",o.setAttribute("accept-charset","utf-8"),r.name="d",o.appendChild(r),document.body.appendChild(o),this.form=o,this.area=r}function u(){d(),t()}function d(){if(n.iframe)try{n.form.removeChild(n.iframe)}catch(e){n.onError("jsonp polling iframe removal error",e)}try{var e='<iframe src="javascript:0" name="'+n.iframeId+'">';i=document.createElement(e)}catch(e){(i=document.createElement("iframe")).name=n.iframeId,i.src="javascript:0"}i.id=n.iframeId,n.form.appendChild(i),n.iframe=i}this.form.action=this.uri(),d(),e=e.replace(c,"\\\n"),this.area.value=e.replace(a,"\\n");try{this.form.submit()}catch(e){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"===n.iframe.readyState&&u()}:this.iframe.onload=u}},"./node_modules/engine.io-client/lib/transports/polling-xhr.js":function(e,t,n){var i=n("./node_modules/engine.io-client/lib/xmlhttprequest.js"),o=n("./node_modules/engine.io-client/lib/transports/polling.js"),r=n("./node_modules/component-emitter/index.js"),s=n("./node_modules/component-inherit/index.js"),a=n("./node_modules/debug/src/browser.js")("engine.io-client:polling-xhr"),c=n("./node_modules/engine.io-client/lib/globalThis.browser.js");function u(){}function d(e){if(o.call(this,e),this.requestTimeout=e.requestTimeout,this.extraHeaders=e.extraHeaders,"undefined"!=typeof location){var t="https:"===location.protocol,n=location.port;n||(n=t?443:80),this.xd="undefined"!=typeof location&&e.hostname!==location.hostname||n!==e.port,this.xs=e.secure!==t}}function l(e){this.method=e.method||"GET",this.uri=e.uri,this.xd=!!e.xd,this.xs=!!e.xs,this.async=!1!==e.async,this.data=void 0!==e.data?e.data:null,this.agent=e.agent,this.isBinary=e.isBinary,this.supportsBinary=e.supportsBinary,this.enablesXDR=e.enablesXDR,this.withCredentials=e.withCredentials,this.requestTimeout=e.requestTimeout,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.extraHeaders=e.extraHeaders,this.create()}function h(){for(var e in l.requests)l.requests.hasOwnProperty(e)&&l.requests[e].abort()}e.exports=d,e.exports.Request=l,s(d,o),d.prototype.supportsBinary=!0,d.prototype.request=function(e){return(e=e||{}).uri=this.uri(),e.xd=this.xd,e.xs=this.xs,e.agent=this.agent||!1,e.supportsBinary=this.supportsBinary,e.enablesXDR=this.enablesXDR,e.withCredentials=this.withCredentials,e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized,e.requestTimeout=this.requestTimeout,e.extraHeaders=this.extraHeaders,new l(e)},d.prototype.doWrite=function(e,t){var n="string"!=typeof e&&void 0!==e,i=this.request({method:"POST",data:e,isBinary:n}),o=this;i.on("success",t),i.on("error",(function(e){o.onError("xhr post error",e)})),this.sendXhr=i},d.prototype.doPoll=function(){a("xhr poll");var e=this.request(),t=this;e.on("data",(function(e){t.onData(e)})),e.on("error",(function(e){t.onError("xhr poll error",e)})),this.pollXhr=e},r(l.prototype),l.prototype.create=function(){var e={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized;var t=this.xhr=new i(e),n=this;try{a("xhr open %s: %s",this.method,this.uri),t.open(this.method,this.uri,this.async);try{if(this.extraHeaders)for(var o in t.setDisableHeaderCheck&&t.setDisableHeaderCheck(!0),this.extraHeaders)this.extraHeaders.hasOwnProperty(o)&&t.setRequestHeader(o,this.extraHeaders[o])}catch(e){}if("POST"===this.method)try{this.isBinary?t.setRequestHeader("Content-type","application/octet-stream"):t.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(e){}try{t.setRequestHeader("Accept","*/*")}catch(e){}"withCredentials"in t&&(t.withCredentials=this.withCredentials),this.requestTimeout&&(t.timeout=this.requestTimeout),this.hasXDR()?(t.onload=function(){n.onLoad()},t.onerror=function(){n.onError(t.responseText)}):t.onreadystatechange=function(){if(2===t.readyState)try{var e=t.getResponseHeader("Content-Type");(n.supportsBinary&&"application/octet-stream"===e||"application/octet-stream; charset=UTF-8"===e)&&(t.responseType="arraybuffer")}catch(e){}4===t.readyState&&(200===t.status||1223===t.status?n.onLoad():setTimeout((function(){n.onError("number"==typeof t.status?t.status:0)}),0))},a("xhr data %s",this.data),t.send(this.data)}catch(e){return void setTimeout((function(){n.onError(e)}),0)}"undefined"!=typeof document&&(this.index=l.requestsCount++,l.requests[this.index]=this)},l.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},l.prototype.onData=function(e){this.emit("data",e),this.onSuccess()},l.prototype.onError=function(e){this.emit("error",e),this.cleanup(!0)},l.prototype.cleanup=function(e){if(void 0!==this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=u:this.xhr.onreadystatechange=u,e)try{this.xhr.abort()}catch(e){}"undefined"!=typeof document&&delete l.requests[this.index],this.xhr=null}},l.prototype.onLoad=function(){var e;try{var t;try{t=this.xhr.getResponseHeader("Content-Type")}catch(e){}e=("application/octet-stream"===t||"application/octet-stream; charset=UTF-8"===t)&&this.xhr.response||this.xhr.responseText}catch(e){this.onError(e)}null!=e&&this.onData(e)},l.prototype.hasXDR=function(){return"undefined"!=typeof XDomainRequest&&!this.xs&&this.enablesXDR},l.prototype.abort=function(){this.cleanup()},l.requestsCount=0,l.requests={},"undefined"!=typeof document&&("function"==typeof attachEvent?attachEvent("onunload",h):"function"==typeof addEventListener&&addEventListener("onpagehide"in c?"pagehide":"unload",h,!1))},"./node_modules/engine.io-client/lib/transports/polling.js":function(e,t,n){var i=n("./node_modules/engine.io-client/lib/transport.js"),o=n("./node_modules/parseqs/index.js"),r=n("./node_modules/engine.io-parser/lib/browser.js"),s=n("./node_modules/component-inherit/index.js"),a=n("./node_modules/yeast/index.js"),c=n("./node_modules/debug/src/browser.js")("engine.io-client:polling");e.exports=d;var u=null!=new(n("./node_modules/engine.io-client/lib/xmlhttprequest.js"))({xdomain:!1}).responseType;function d(e){var t=e&&e.forceBase64;u&&!t||(this.supportsBinary=!1),i.call(this,e)}s(d,i),d.prototype.name="polling",d.prototype.doOpen=function(){this.poll()},d.prototype.pause=function(e){var t=this;function n(){c("paused"),t.readyState="paused",e()}if(this.readyState="pausing",this.polling||!this.writable){var i=0;this.polling&&(c("we are currently polling - waiting to pause"),i++,this.once("pollComplete",(function(){c("pre-pause polling complete"),--i||n()}))),this.writable||(c("we are currently writing - waiting to pause"),i++,this.once("drain",(function(){c("pre-pause writing complete"),--i||n()})))}else n()},d.prototype.poll=function(){c("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},d.prototype.onData=function(e){var t=this;c("polling got data %s",e),r.decodePayload(e,this.socket.binaryType,(function(e,n,i){if("opening"===t.readyState&&"open"===e.type&&t.onOpen(),"close"===e.type)return t.onClose(),!1;t.onPacket(e)})),"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState?this.poll():c('ignoring poll - transport state "%s"',this.readyState))},d.prototype.doClose=function(){var e=this;function t(){c("writing close packet"),e.write([{type:"close"}])}"open"===this.readyState?(c("transport open - closing"),t()):(c("transport not open - deferring close"),this.once("open",t))},d.prototype.write=function(e){var t=this;this.writable=!1;var n=function(){t.writable=!0,t.emit("drain")};r.encodePayload(e,this.supportsBinary,(function(e){t.doWrite(e,n)}))},d.prototype.uri=function(){var e=this.query||{},t=this.secure?"https":"http",n="";return!1!==this.timestampRequests&&(e[this.timestampParam]=a()),this.supportsBinary||e.sid||(e.b64=1),e=o.encode(e),this.port&&("https"===t&&443!==Number(this.port)||"http"===t&&80!==Number(this.port))&&(n=":"+this.port),e.length&&(e="?"+e),t+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+n+this.path+e}},"./node_modules/engine.io-client/lib/transports/websocket.js":function(e,t,n){(function(t){var i,o,r=n("./node_modules/engine.io-client/lib/transport.js"),s=n("./node_modules/engine.io-parser/lib/browser.js"),a=n("./node_modules/parseqs/index.js"),c=n("./node_modules/component-inherit/index.js"),u=n("./node_modules/yeast/index.js"),d=n("./node_modules/debug/src/browser.js")("engine.io-client:websocket");if("undefined"!=typeof WebSocket?i=WebSocket:"undefined"!=typeof self&&(i=self.WebSocket||self.MozWebSocket),"undefined"==typeof window)try{o=n(0)}catch(e){}var l=i||o;function h(e){e&&e.forceBase64&&(this.supportsBinary=!1),this.perMessageDeflate=e.perMessageDeflate,this.usingBrowserWebSocket=i&&!e.forceNode,this.protocols=e.protocols,this.usingBrowserWebSocket||(l=o),r.call(this,e)}e.exports=h,c(h,r),h.prototype.name="websocket",h.prototype.supportsBinary=!0,h.prototype.doOpen=function(){if(this.check()){var e=this.uri(),t=this.protocols,n={};this.isReactNative||(n.agent=this.agent,n.perMessageDeflate=this.perMessageDeflate,n.pfx=this.pfx,n.key=this.key,n.passphrase=this.passphrase,n.cert=this.cert,n.ca=this.ca,n.ciphers=this.ciphers,n.rejectUnauthorized=this.rejectUnauthorized),this.extraHeaders&&(n.headers=this.extraHeaders),this.localAddress&&(n.localAddress=this.localAddress);try{this.ws=this.usingBrowserWebSocket&&!this.isReactNative?t?new l(e,t):new l(e):new l(e,t,n)}catch(e){return this.emit("error",e)}void 0===this.ws.binaryType&&(this.supportsBinary=!1),this.ws.supports&&this.ws.supports.binary?(this.supportsBinary=!0,this.ws.binaryType="nodebuffer"):this.ws.binaryType="arraybuffer",this.addEventListeners()}},h.prototype.addEventListeners=function(){var e=this;this.ws.onopen=function(){e.onOpen()},this.ws.onclose=function(){e.onClose()},this.ws.onmessage=function(t){e.onData(t.data)},this.ws.onerror=function(t){e.onError("websocket error",t)}},h.prototype.write=function(e){var n=this;this.writable=!1;for(var i=e.length,o=0,r=i;o<r;o++)!function(e){s.encodePacket(e,n.supportsBinary,(function(o){if(!n.usingBrowserWebSocket){var r={};e.options&&(r.compress=e.options.compress),n.perMessageDeflate&&("string"==typeof o?t.byteLength(o):o.length)<n.perMessageDeflate.threshold&&(r.compress=!1)}try{n.usingBrowserWebSocket?n.ws.send(o):n.ws.send(o,r)}catch(e){d("websocket closed before onclose event")}--i||(n.emit("flush"),setTimeout((function(){n.writable=!0,n.emit("drain")}),0))}))}(e[o])},h.prototype.onClose=function(){r.prototype.onClose.call(this)},h.prototype.doClose=function(){void 0!==this.ws&&this.ws.close()},h.prototype.uri=function(){var e=this.query||{},t=this.secure?"wss":"ws",n="";return this.port&&("wss"===t&&443!==Number(this.port)||"ws"===t&&80!==Number(this.port))&&(n=":"+this.port),this.timestampRequests&&(e[this.timestampParam]=u()),this.supportsBinary||(e.b64=1),(e=a.encode(e)).length&&(e="?"+e),t+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+n+this.path+e},h.prototype.check=function(){return!(!l||"__initialize"in l&&this.name===h.prototype.name)}}).call(this,n("./node_modules/node-libs-browser/node_modules/buffer/index.js").Buffer)},"./node_modules/engine.io-client/lib/xmlhttprequest.js":function(e,t,n){var i=n("./node_modules/has-cors/index.js"),o=n("./node_modules/engine.io-client/lib/globalThis.browser.js");e.exports=function(e){var t=e.xdomain,n=e.xscheme,r=e.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!t||i))return new XMLHttpRequest}catch(e){}try{if("undefined"!=typeof XDomainRequest&&!n&&r)return new XDomainRequest}catch(e){}if(!t)try{return new(o[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(e){}}},"./node_modules/engine.io-parser/lib/browser.js":function(e,t,n){var i,o=n("./node_modules/engine.io-parser/lib/keys.js"),r=n("./node_modules/has-binary2/index.js"),s=n("./node_modules/arraybuffer.slice/index.js"),a=n("./node_modules/after/index.js"),c=n("./node_modules/engine.io-parser/lib/utf8.js");"undefined"!=typeof ArrayBuffer&&(i=n("./node_modules/base64-arraybuffer/lib/base64-arraybuffer.js"));var u="undefined"!=typeof navigator&&/Android/i.test(navigator.userAgent),d="undefined"!=typeof navigator&&/PhantomJS/i.test(navigator.userAgent),l=u||d;t.protocol=3;var h=t.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},p=o(h),f={type:"error",data:"parser error"},m=n("./node_modules/blob/index.js");function g(e,t,n){for(var i=new Array(e.length),o=a(e.length,n),r=function(e,n,o){t(n,(function(t,n){i[e]=n,o(t,i)}))},s=0;s<e.length;s++)r(s,e[s],o)}t.encodePacket=function(e,n,i,o){"function"==typeof n&&(o=n,n=!1),"function"==typeof i&&(o=i,i=null);var r=void 0===e.data?void 0:e.data.buffer||e.data;if("undefined"!=typeof ArrayBuffer&&r instanceof ArrayBuffer)return function(e,n,i){if(!n)return t.encodeBase64Packet(e,i);var o=e.data,r=new Uint8Array(o),s=new Uint8Array(1+o.byteLength);s[0]=h[e.type];for(var a=0;a<r.length;a++)s[a+1]=r[a];return i(s.buffer)}(e,n,o);if(void 0!==m&&r instanceof m)return function(e,n,i){if(!n)return t.encodeBase64Packet(e,i);if(l)return function(e,n,i){if(!n)return t.encodeBase64Packet(e,i);var o=new FileReader;return o.onload=function(){t.encodePacket({type:e.type,data:o.result},n,!0,i)},o.readAsArrayBuffer(e.data)}(e,n,i);var o=new Uint8Array(1);return o[0]=h[e.type],i(new m([o.buffer,e.data]))}(e,n,o);if(r&&r.base64)return function(e,n){return n("b"+t.packets[e.type]+e.data.data)}(e,o);var s=h[e.type];return void 0!==e.data&&(s+=i?c.encode(String(e.data),{strict:!1}):String(e.data)),o(""+s)},t.encodeBase64Packet=function(e,n){var i,o="b"+t.packets[e.type];if(void 0!==m&&e.data instanceof m){var r=new FileReader;return r.onload=function(){var e=r.result.split(",")[1];n(o+e)},r.readAsDataURL(e.data)}try{i=String.fromCharCode.apply(null,new Uint8Array(e.data))}catch(t){for(var s=new Uint8Array(e.data),a=new Array(s.length),c=0;c<s.length;c++)a[c]=s[c];i=String.fromCharCode.apply(null,a)}return o+=btoa(i),n(o)},t.decodePacket=function(e,n,i){if(void 0===e)return f;if("string"==typeof e){if("b"===e.charAt(0))return t.decodeBase64Packet(e.substr(1),n);if(i&&!1===(e=function(e){try{e=c.decode(e,{strict:!1})}catch(e){return!1}return e}(e)))return f;var o=e.charAt(0);return Number(o)==o&&p[o]?e.length>1?{type:p[o],data:e.substring(1)}:{type:p[o]}:f}o=new Uint8Array(e)[0];var r=s(e,1);return m&&"blob"===n&&(r=new m([r])),{type:p[o],data:r}},t.decodeBase64Packet=function(e,t){var n=p[e.charAt(0)];if(!i)return{type:n,data:{base64:!0,data:e.substr(1)}};var o=i.decode(e.substr(1));return"blob"===t&&m&&(o=new m([o])),{type:n,data:o}},t.encodePayload=function(e,n,i){"function"==typeof n&&(i=n,n=null);var o=r(e);return n&&o?m&&!l?t.encodePayloadAsBlob(e,i):t.encodePayloadAsArrayBuffer(e,i):e.length?void g(e,(function(e,i){t.encodePacket(e,!!o&&n,!1,(function(e){i(null,function(e){return e.length+":"+e}(e))}))}),(function(e,t){return i(t.join(""))})):i("0:")},t.decodePayload=function(e,n,i){if("string"!=typeof e)return t.decodePayloadAsBinary(e,n,i);var o;if("function"==typeof n&&(i=n,n=null),""===e)return i(f,0,1);for(var r,s,a="",c=0,u=e.length;c<u;c++){var d=e.charAt(c);if(":"===d){if(""===a||a!=(r=Number(a)))return i(f,0,1);if(a!=(s=e.substr(c+1,r)).length)return i(f,0,1);if(s.length){if(o=t.decodePacket(s,n,!1),f.type===o.type&&f.data===o.data)return i(f,0,1);if(!1===i(o,c+r,u))return}c+=r,a=""}else a+=d}return""!==a?i(f,0,1):void 0},t.encodePayloadAsArrayBuffer=function(e,n){if(!e.length)return n(new ArrayBuffer(0));g(e,(function(e,n){t.encodePacket(e,!0,!0,(function(e){return n(null,e)}))}),(function(e,t){var i=t.reduce((function(e,t){var n;return e+(n="string"==typeof t?t.length:t.byteLength).toString().length+n+2}),0),o=new Uint8Array(i),r=0;return t.forEach((function(e){var t="string"==typeof e,n=e;if(t){for(var i=new Uint8Array(e.length),s=0;s<e.length;s++)i[s]=e.charCodeAt(s);n=i.buffer}o[r++]=t?0:1;var a=n.byteLength.toString();for(s=0;s<a.length;s++)o[r++]=parseInt(a[s]);for(o[r++]=255,i=new Uint8Array(n),s=0;s<i.length;s++)o[r++]=i[s]})),n(o.buffer)}))},t.encodePayloadAsBlob=function(e,n){g(e,(function(e,n){t.encodePacket(e,!0,!0,(function(e){var t=new Uint8Array(1);if(t[0]=1,"string"==typeof e){for(var i=new Uint8Array(e.length),o=0;o<e.length;o++)i[o]=e.charCodeAt(o);e=i.buffer,t[0]=0}var r=(e instanceof ArrayBuffer?e.byteLength:e.size).toString(),s=new Uint8Array(r.length+1);for(o=0;o<r.length;o++)s[o]=parseInt(r[o]);if(s[r.length]=255,m){var a=new m([t.buffer,s.buffer,e]);n(null,a)}}))}),(function(e,t){return n(new m(t))}))},t.decodePayloadAsBinary=function(e,n,i){"function"==typeof n&&(i=n,n=null);for(var o=e,r=[];o.byteLength>0;){for(var a=new Uint8Array(o),c=0===a[0],u="",d=1;255!==a[d];d++){if(u.length>310)return i(f,0,1);u+=a[d]}o=s(o,2+u.length),u=parseInt(u);var l=s(o,0,u);if(c)try{l=String.fromCharCode.apply(null,new Uint8Array(l))}catch(e){var h=new Uint8Array(l);for(l="",d=0;d<h.length;d++)l+=String.fromCharCode(h[d])}r.push(l),o=s(o,u)}var p=r.length;r.forEach((function(e,o){i(t.decodePacket(e,n,!0),o,p)}))}},"./node_modules/engine.io-parser/lib/keys.js":function(e,t){e.exports=Object.keys||function(e){var t=[],n=Object.prototype.hasOwnProperty;for(var i in e)n.call(e,i)&&t.push(i);return t}},"./node_modules/engine.io-parser/lib/utf8.js":function(e,t){var n,i,o,r=String.fromCharCode;function s(e){for(var t,n,i=[],o=0,r=e.length;o<r;)(t=e.charCodeAt(o++))>=55296&&t<=56319&&o<r?56320==(64512&(n=e.charCodeAt(o++)))?i.push(((1023&t)<<10)+(1023&n)+65536):(i.push(t),o--):i.push(t);return i}function a(e,t){if(e>=55296&&e<=57343){if(t)throw Error("Lone surrogate U+"+e.toString(16).toUpperCase()+" is not a scalar value");return!1}return!0}function c(e,t){return r(e>>t&63|128)}function u(e,t){if(0==(4294967168&e))return r(e);var n="";return 0==(4294965248&e)?n=r(e>>6&31|192):0==(4294901760&e)?(a(e,t)||(e=65533),n=r(e>>12&15|224),n+=c(e,6)):0==(4292870144&e)&&(n=r(e>>18&7|240),n+=c(e,12),n+=c(e,6)),n+r(63&e|128)}function d(){if(o>=i)throw Error("Invalid byte index");var e=255&n[o];if(o++,128==(192&e))return 63&e;throw Error("Invalid continuation byte")}function l(e){var t,r;if(o>i)throw Error("Invalid byte index");if(o==i)return!1;if(t=255&n[o],o++,0==(128&t))return t;if(192==(224&t)){if((r=(31&t)<<6|d())>=128)return r;throw Error("Invalid continuation byte")}if(224==(240&t)){if((r=(15&t)<<12|d()<<6|d())>=2048)return a(r,e)?r:65533;throw Error("Invalid continuation byte")}if(240==(248&t)&&(r=(7&t)<<18|d()<<12|d()<<6|d())>=65536&&r<=1114111)return r;throw Error("Invalid UTF-8 detected")}e.exports={version:"2.1.2",encode:function(e,t){for(var n=!1!==(t=t||{}).strict,i=s(e),o=i.length,r=-1,a="";++r<o;)a+=u(i[r],n);return a},decode:function(e,t){var a=!1!==(t=t||{}).strict;n=s(e),i=n.length,o=0;for(var c,u=[];!1!==(c=l(a));)u.push(c);return function(e){for(var t,n=e.length,i=-1,o="";++i<n;)(t=e[i])>65535&&(o+=r((t-=65536)>>>10&1023|55296),t=56320|1023&t),o+=r(t);return o}(u)}}},"./node_modules/enum/lib/enum.js":function(e,t,n){"use strict";n.r(t),function(e){n.d(t,"default",(function(){return a}));var i=n("./node_modules/enum/lib/enumItem.js"),o=n("./node_modules/enum/lib/isType.js"),r=n("./node_modules/enum/lib/indexOf.js");const s=(()=>{const e=new ArrayBuffer(2);return new DataView(e).setInt16(0,256,!0),256===new Int16Array(e)[0]?"LE":"BE"})();class a{constructor(e,t){if(this.size=4,this.indirection=1,t&&Object(o.isString)(t)&&(t={name:t}),this._options=t||{},this._options.separator=this._options.separator||" | ",this._options.endianness=this._options.endianness||s,this._options.ignoreCase=this._options.ignoreCase||!1,this._options.freez=this._options.freez||!1,this._options.freeze=this._options.freeze||this._options.freez||!1,this.enums=[],e.length){this._enumLastIndex=e.length;var n=e;e={};for(var r=0;r<n.length;r++)e[n[r]]=Math.pow(2,r)}for(var a in e)u(this._options.name,a),this[a]=new i.default(a,e[a],{ignoreCase:this._options.ignoreCase}),this.enums.push(this[a]);this._enumMap=e,this._options.ignoreCase&&(this.getLowerCaseEnums=function(){for(var e={},t=0,n=this.enums.length;t<n;t++)e[this.enums[t].key.toLowerCase()]=this.enums[t];return e}),this._options.name&&(this.name=this._options.name),this.isFlaggable=(()=>{for(var e=0,t=this.enums.length;e<t;e++){var n=this.enums[e];if(0===n.value||n.value&n.value-1)return!1}return!0})(),this._options.freeze&&this.freezeEnums()}getKey(e){var t=this.get(e);if(t)return t.key}getValue(e){var t=this.get(e);if(t)return t.value}get(e,t){if(null!=e){var n;if(null!=(n=e)&&null!=n.constructor&&"function"==typeof n.constructor.isBuffer&&n.constructor.isBuffer(n)&&(e=e["readUInt32"+this._options.endianness](t||0)),i.default.isEnumItem(e)){if(r.indexOf.call(this.enums,e)>=0)return e;if(!this.isFlaggable||this.isFlaggable&&e.key.indexOf(this._options.separator)<0)return;return this.get(e.key)}if(Object(o.isString)(e)){var s=this;if(this._options.ignoreCase&&(s=this.getLowerCaseEnums(),e=e.toLowerCase()),e.indexOf(this._options.separator)>0){for(var a=e.split(this._options.separator),c=0,u=0;u<a.length;u++)c|=s[a[u]].value;return new i.default(e,c)}return s[e]}for(var d in this)if(this.hasOwnProperty(d)&&this[d].value===e)return this[d];var l=null;if(this.isFlaggable)for(var h in this)this.hasOwnProperty(h)&&0!=(e&this[h].value)&&(l?l+=this._options.separator:l="",l+=h);return this.get(l||null)}}set(e,t,n){var i=this.get(n);if(i)return e["writeUInt32"+this._options.endianness](i.value,t||0)}freezeEnums(){function e(e){return e}return Object.isFrozen&&Object.isSealed&&Object.getOwnPropertyNames&&Object.getOwnPropertyDescriptor&&Object.defineProperties&&Object.__defineGetter__&&Object.__defineSetter__&&function t(n){if("object"==typeof n&&null!==n&&!Object.isFrozen(n)&&!Object.isSealed(n)){for(var i in n)n.hasOwnProperty(i)&&(n.__defineGetter__(i,e.bind(null,n[i])),n.__defineSetter__(i,(function(e){throw TypeError("Cannot redefine property; Enum Type is not extensible.")})),t(n[i]));Object.freeze?Object.freeze(n):function(e){Object.getOwnPropertyNames(e).forEach((function(t){Object.getOwnPropertyDescriptor(e,t).configurable&&Object.defineProperties(e,t,{writable:!1,configurable:!1})}))}(n)}}(this),this}isDefined(e){let t=t=>t===e;return(Object(o.isString)(e)||Object(o.isNumber)(e))&&(t=t=>t.is(e)),this.enums.some(t)}toJSON(){return this._enumMap}extend(e){if(e.length){var t=e;e={};for(var n=0;n<t.length;n++){var o=this._enumLastIndex+n;e[t[n]]=Math.pow(2,o)}for(var r in e)u(this._options.name,r),this[r]=new i.default(r,e[r],{ignoreCase:this._options.ignoreCase}),this.enums.push(this[r]);for(var s in this._enumMap)e[s]=this._enumMap[s];this._enumLastIndex+=e.length,this._enumMap=e,this._options.freeze&&this.freezeEnums()}}static register(t="Enum"){void 0===e||e[t]?"undefined"==typeof window||window[t]||(window[t]=a):e[t]=a}[Symbol.iterator](){let e=0;return{next:()=>e<this.enums.length?{done:!1,value:this.enums[e++]}:{done:!0}}}}var c=["_options","get","getKey","getValue","enums","isFlaggable","_enumMap","toJSON","_enumLastIndex"];function u(e,t){if(e&&"name"===t||r.indexOf.call(c,t)>=0)throw new Error(`Enum key ${t} is a reserved word!`)}}.call(this,n("./node_modules/webpack/buildin/global.js"))},"./node_modules/enum/lib/enumItem.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return o}));var i=n("./node_modules/enum/lib/isType.js");class o{constructor(e,t,n={}){this.key=e,this.value=t,this._options=n,this._options.ignoreCase=this._options.ignoreCase||!1}has(e){return o.isEnumItem(e)?0!=(this.value&e.value):Object(i.isString)(e)?this._options.ignoreCase?this.key.toLowerCase().indexOf(e.toLowerCase())>=0:this.key.indexOf(e)>=0:0!=(this.value&e)}is(e){return o.isEnumItem(e)?this.key===e.key:Object(i.isString)(e)?this._options.ignoreCase?this.key.toLowerCase()===e.toLowerCase():this.key===e:this.value===e}toString(){return this.key}toJSON(){return this.key}valueOf(){return this.value}static isEnumItem(e){return e instanceof o||Object(i.isObject)(e)&&void 0!==e.key&&void 0!==e.value}}},"./node_modules/enum/lib/indexOf.js":function(e,t,n){"use strict";n.r(t),n.d(t,"indexOf",(function(){return i}));const i=Array.prototype.indexOf||function(e,t){void 0===t&&(t=0),t<0&&(t+=this.length),t<0&&(t=0);for(var n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1}},"./node_modules/enum/lib/isType.js":function(e,t,n){"use strict";n.r(t),n.d(t,"isType",(function(){return i})),n.d(t,"isObject",(function(){return o})),n.d(t,"isString",(function(){return r})),n.d(t,"isNumber",(function(){return s}));const i=(e,t)=>typeof t===e,o=e=>i("object",e),r=e=>i("string",e),s=e=>i("number",e)},"./node_modules/events/events.js":function(e,t,n){"use strict";var i,o="object"==typeof Reflect?Reflect:null,r=o&&"function"==typeof o.apply?o.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};i=o&&"function"==typeof o.ownKeys?o.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var s=Number.isNaN||function(e){return e!=e};function a(){a.init.call(this)}e.exports=a,e.exports.once=function(e,t){return new Promise((function(n,i){function o(n){e.removeListener(t,r),i(n)}function r(){"function"==typeof e.removeListener&&e.removeListener("error",o),n([].slice.call(arguments))}y(e,t,r,{once:!0}),"error"!==t&&function(e,t,n){"function"==typeof e.on&&y(e,"error",t,{once:!0})}(e,o)}))},a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var c=10;function u(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function d(e){return void 0===e._maxListeners?a.defaultMaxListeners:e._maxListeners}function l(e,t,n,i){var o,r,s,a;if(u(n),void 0===(r=e._events)?(r=e._events=Object.create(null),e._eventsCount=0):(void 0!==r.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),r=e._events),s=r[t]),void 0===s)s=r[t]=n,++e._eventsCount;else if("function"==typeof s?s=r[t]=i?[n,s]:[s,n]:i?s.unshift(n):s.push(n),(o=d(e))>0&&s.length>o&&!s.warned){s.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=e,c.type=t,c.count=s.length,a=c,console&&console.warn&&console.warn(a)}return e}function h(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function p(e,t,n){var i={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},o=h.bind(i);return o.listener=n,i.wrapFn=o,o}function f(e,t,n){var i=e._events;if(void 0===i)return[];var o=i[t];return void 0===o?[]:"function"==typeof o?n?[o.listener||o]:[o]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(o):g(o,o.length)}function m(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function g(e,t){for(var n=new Array(t),i=0;i<t;++i)n[i]=e[i];return n}function y(e,t,n,i){if("function"==typeof e.on)i.once?e.once(t,n):e.on(t,n);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function o(r){i.once&&e.removeEventListener(t,o),n(r)}))}}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return c},set:function(e){if("number"!=typeof e||e<0||s(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");c=e}}),a.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||s(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},a.prototype.getMaxListeners=function(){return d(this)},a.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var i="error"===e,o=this._events;if(void 0!==o)i=i&&void 0===o.error;else if(!i)return!1;if(i){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var c=o[e];if(void 0===c)return!1;if("function"==typeof c)r(c,this,t);else{var u=c.length,d=g(c,u);for(n=0;n<u;++n)r(d[n],this,t)}return!0},a.prototype.addListener=function(e,t){return l(this,e,t,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(e,t){return l(this,e,t,!0)},a.prototype.once=function(e,t){return u(t),this.on(e,p(this,e,t)),this},a.prototype.prependOnceListener=function(e,t){return u(t),this.prependListener(e,p(this,e,t)),this},a.prototype.removeListener=function(e,t){var n,i,o,r,s;if(u(t),void 0===(i=this._events))return this;if(void 0===(n=i[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(o=-1,r=n.length-1;r>=0;r--)if(n[r]===t||n[r].listener===t){s=n[r].listener,o=r;break}if(o<0)return this;0===o?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,o),1===n.length&&(i[e]=n[0]),void 0!==i.removeListener&&this.emit("removeListener",e,s||t)}return this},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(e){var t,n,i;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var o,r=Object.keys(n);for(i=0;i<r.length;++i)"removeListener"!==(o=r[i])&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this},a.prototype.listeners=function(e){return f(this,e,!0)},a.prototype.rawListeners=function(e){return f(this,e,!1)},a.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):m.call(e,t)},a.prototype.listenerCount=m,a.prototype.eventNames=function(){return this._eventsCount>0?i(this._events):[]}},"./node_modules/filter-obj/index.js":function(e,t,n){"use strict";e.exports=function(e,t){for(var n={},i=Object.keys(e),o=Array.isArray(t),r=0;r<i.length;r++){var s=i[r],a=e[s];(o?-1!==t.indexOf(s):t(s,a,e))&&(n[s]=a)}return n}},"./node_modules/has-binary2/index.js":function(e,t,n){(function(t){var i=n("./node_modules/isarray/index.js"),o=Object.prototype.toString,r="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===o.call(Blob),s="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===o.call(File);e.exports=function e(n){if(!n||"object"!=typeof n)return!1;if(i(n)){for(var o=0,a=n.length;o<a;o++)if(e(n[o]))return!0;return!1}if("function"==typeof t&&t.isBuffer&&t.isBuffer(n)||"function"==typeof ArrayBuffer&&n instanceof ArrayBuffer||r&&n instanceof Blob||s&&n instanceof File)return!0;if(n.toJSON&&"function"==typeof n.toJSON&&1===arguments.length)return e(n.toJSON(),!0);for(var c in n)if(Object.prototype.hasOwnProperty.call(n,c)&&e(n[c]))return!0;return!1}}).call(this,n("./node_modules/node-libs-browser/node_modules/buffer/index.js").Buffer)},"./node_modules/has-cors/index.js":function(e,t){try{e.exports="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(t){e.exports=!1}},"./node_modules/ieee754/index.js":function(e,t){t.read=function(e,t,n,i,o){var r,s,a=8*o-i-1,c=(1<<a)-1,u=c>>1,d=-7,l=n?o-1:0,h=n?-1:1,p=e[t+l];for(l+=h,r=p&(1<<-d)-1,p>>=-d,d+=a;d>0;r=256*r+e[t+l],l+=h,d-=8);for(s=r&(1<<-d)-1,r>>=-d,d+=i;d>0;s=256*s+e[t+l],l+=h,d-=8);if(0===r)r=1-u;else{if(r===c)return s?NaN:1/0*(p?-1:1);s+=Math.pow(2,i),r-=u}return(p?-1:1)*s*Math.pow(2,r-i)},t.write=function(e,t,n,i,o,r){var s,a,c,u=8*r-o-1,d=(1<<u)-1,l=d>>1,h=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,p=i?0:r-1,f=i?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=d):(s=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-s))<1&&(s--,c*=2),(t+=s+l>=1?h/c:h*Math.pow(2,1-l))*c>=2&&(s++,c/=2),s+l>=d?(a=0,s=d):s+l>=1?(a=(t*c-1)*Math.pow(2,o),s+=l):(a=t*Math.pow(2,l-1)*Math.pow(2,o),s=0));o>=8;e[n+p]=255&a,p+=f,a/=256,o-=8);for(s=s<<o|a,u+=o;u>0;e[n+p]=255&s,p+=f,s/=256,u-=8);e[n+p-f]|=128*m}},"./node_modules/indexof/index.js":function(e,t){var n=[].indexOf;e.exports=function(e,t){if(n)return e.indexOf(t);for(var i=0;i<e.length;++i)if(e[i]===t)return i;return-1}},"./node_modules/isarray/index.js":function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},"./node_modules/js-binarypack/lib/binarypack.js":function(e,t,n){var i=n("./node_modules/js-binarypack/lib/bufferbuilder.js").BufferBuilder,o=n("./node_modules/js-binarypack/lib/bufferbuilder.js").binaryFeatures,r={unpack:function(e){return new s(e).unpack()},pack:function(e){var t=new a;return t.pack(e),t.getBuffer()}};function s(e){this.index=0,this.dataBuffer=e,this.dataView=new Uint8Array(this.dataBuffer),this.length=this.dataBuffer.byteLength}function a(){this.bufferBuilder=new i}function c(e){var t=e.charCodeAt(0);return t<=2047?"00":t<=65535?"000":t<=2097151?"0000":t<=67108863?"00000":"000000"}e.exports=r,s.prototype.unpack=function(){var e,t=this.unpack_uint8();if(t<128)return t;if((224^t)<32)return(224^t)-32;if((e=160^t)<=15)return this.unpack_raw(e);if((e=176^t)<=15)return this.unpack_string(e);if((e=144^t)<=15)return this.unpack_array(e);if((e=128^t)<=15)return this.unpack_map(e);switch(t){case 192:return null;case 193:case 212:case 213:case 214:case 215:return;case 194:return!1;case 195:return!0;case 202:return this.unpack_float();case 203:return this.unpack_double();case 204:return this.unpack_uint8();case 205:return this.unpack_uint16();case 206:return this.unpack_uint32();case 207:return this.unpack_uint64();case 208:return this.unpack_int8();case 209:return this.unpack_int16();case 210:return this.unpack_int32();case 211:return this.unpack_int64();case 216:return e=this.unpack_uint16(),this.unpack_string(e);case 217:return e=this.unpack_uint32(),this.unpack_string(e);case 218:return e=this.unpack_uint16(),this.unpack_raw(e);case 219:return e=this.unpack_uint32(),this.unpack_raw(e);case 220:return e=this.unpack_uint16(),this.unpack_array(e);case 221:return e=this.unpack_uint32(),this.unpack_array(e);case 222:return e=this.unpack_uint16(),this.unpack_map(e);case 223:return e=this.unpack_uint32(),this.unpack_map(e)}},s.prototype.unpack_uint8=function(){var e=255&this.dataView[this.index];return this.index++,e},s.prototype.unpack_uint16=function(){var e=this.read(2),t=256*(255&e[0])+(255&e[1]);return this.index+=2,t},s.prototype.unpack_uint32=function(){var e=this.read(4),t=256*(256*(256*e[0]+e[1])+e[2])+e[3];return this.index+=4,t},s.prototype.unpack_uint64=function(){var e=this.read(8),t=256*(256*(256*(256*(256*(256*(256*e[0]+e[1])+e[2])+e[3])+e[4])+e[5])+e[6])+e[7];return this.index+=8,t},s.prototype.unpack_int8=function(){var e=this.unpack_uint8();return e<128?e:e-256},s.prototype.unpack_int16=function(){var e=this.unpack_uint16();return e<32768?e:e-65536},s.prototype.unpack_int32=function(){var e=this.unpack_uint32();return e<Math.pow(2,31)?e:e-Math.pow(2,32)},s.prototype.unpack_int64=function(){var e=this.unpack_uint64();return e<Math.pow(2,63)?e:e-Math.pow(2,64)},s.prototype.unpack_raw=function(e){if(this.length<this.index+e)throw new Error("BinaryPackFailure: index is out of range "+this.index+" "+e+" "+this.length);var t=this.dataBuffer.slice(this.index,this.index+e);return this.index+=e,t},s.prototype.unpack_string=function(e){for(var t,n,i=this.read(e),o=0,r="";o<e;)(t=i[o])<128?(r+=String.fromCharCode(t),o++):(192^t)<32?(n=(192^t)<<6|63&i[o+1],r+=String.fromCharCode(n),o+=2):(n=(15&t)<<12|(63&i[o+1])<<6|63&i[o+2],r+=String.fromCharCode(n),o+=3);return this.index+=e,r},s.prototype.unpack_array=function(e){for(var t=new Array(e),n=0;n<e;n++)t[n]=this.unpack();return t},s.prototype.unpack_map=function(e){for(var t={},n=0;n<e;n++){var i=this.unpack(),o=this.unpack();t[i]=o}return t},s.prototype.unpack_float=function(){var e=this.unpack_uint32(),t=(e>>23&255)-127;return(0==e>>31?1:-1)*(8388607&e|8388608)*Math.pow(2,t-23)},s.prototype.unpack_double=function(){var e=this.unpack_uint32(),t=this.unpack_uint32(),n=(e>>20&2047)-1023;return(0==e>>31?1:-1)*((1048575&e|1048576)*Math.pow(2,n-20)+t*Math.pow(2,n-52))},s.prototype.read=function(e){var t=this.index;if(t+e<=this.length)return this.dataView.subarray(t,t+e);throw new Error("BinaryPackFailure: read index out of range")},a.prototype.getBuffer=function(){return this.bufferBuilder.getBuffer()},a.prototype.pack=function(e){var t=typeof e;if("string"==t)this.pack_string(e);else if("number"==t)Math.floor(e)===e?this.pack_integer(e):this.pack_double(e);else if("boolean"==t)!0===e?this.bufferBuilder.append(195):!1===e&&this.bufferBuilder.append(194);else if("undefined"==t)this.bufferBuilder.append(192);else{if("object"!=t)throw new Error('Type "'+t+'" not yet supported');if(null===e)this.bufferBuilder.append(192);else{var n=e.constructor;if(n==Array)this.pack_array(e);else if(n==Blob||n==File)this.pack_bin(e);else if(n==ArrayBuffer)o.useArrayBufferView?this.pack_bin(new Uint8Array(e)):this.pack_bin(e);else if("BYTES_PER_ELEMENT"in e)o.useArrayBufferView?this.pack_bin(new Uint8Array(e.buffer)):this.pack_bin(e.buffer);else if(n==Object)this.pack_object(e);else if(n==Date)this.pack_string(e.toString());else{if("function"!=typeof e.toBinaryPack)throw new Error('Type "'+n.toString()+'" not yet supported');this.bufferBuilder.append(e.toBinaryPack())}}}this.bufferBuilder.flush()},a.prototype.pack_bin=function(e){var t=e.length||e.byteLength||e.size;if(t<=15)this.pack_uint8(160+t);else if(t<=65535)this.bufferBuilder.append(218),this.pack_uint16(t);else{if(!(t<=4294967295))throw new Error("Invalid length");this.bufferBuilder.append(219),this.pack_uint32(t)}this.bufferBuilder.append(e)},a.prototype.pack_string=function(e){var t=function(e){return e.length>600?new Blob([e]).size:e.replace(/[^\u0000-\u007F]/g,c).length}(e);if(t<=15)this.pack_uint8(176+t);else if(t<=65535)this.bufferBuilder.append(216),this.pack_uint16(t);else{if(!(t<=4294967295))throw new Error("Invalid length");this.bufferBuilder.append(217),this.pack_uint32(t)}this.bufferBuilder.append(e)},a.prototype.pack_array=function(e){var t=e.length;if(t<=15)this.pack_uint8(144+t);else if(t<=65535)this.bufferBuilder.append(220),this.pack_uint16(t);else{if(!(t<=4294967295))throw new Error("Invalid length");this.bufferBuilder.append(221),this.pack_uint32(t)}for(var n=0;n<t;n++)this.pack(e[n])},a.prototype.pack_integer=function(e){if(-32<=e&&e<=127)this.bufferBuilder.append(255&e);else if(0<=e&&e<=255)this.bufferBuilder.append(204),this.pack_uint8(e);else if(-128<=e&&e<=127)this.bufferBuilder.append(208),this.pack_int8(e);else if(0<=e&&e<=65535)this.bufferBuilder.append(205),this.pack_uint16(e);else if(-32768<=e&&e<=32767)this.bufferBuilder.append(209),this.pack_int16(e);else if(0<=e&&e<=4294967295)this.bufferBuilder.append(206),this.pack_uint32(e);else if(-2147483648<=e&&e<=2147483647)this.bufferBuilder.append(210),this.pack_int32(e);else if(-0x8000000000000000<=e&&e<=0x8000000000000000)this.bufferBuilder.append(211),this.pack_int64(e);else{if(!(0<=e&&e<=0x10000000000000000))throw new Error("Invalid integer");this.bufferBuilder.append(207),this.pack_uint64(e)}},a.prototype.pack_double=function(e){var t=0;e<0&&(t=1,e=-e);var n=Math.floor(Math.log(e)/Math.LN2),i=e/Math.pow(2,n)-1,o=Math.floor(i*Math.pow(2,52)),r=Math.pow(2,32),s=t<<31|n+1023<<20|o/r&1048575,a=o%r;this.bufferBuilder.append(203),this.pack_int32(s),this.pack_int32(a)},a.prototype.pack_object=function(e){var t=Object.keys(e).length;if(t<=15)this.pack_uint8(128+t);else if(t<=65535)this.bufferBuilder.append(222),this.pack_uint16(t);else{if(!(t<=4294967295))throw new Error("Invalid length");this.bufferBuilder.append(223),this.pack_uint32(t)}for(var n in e)e.hasOwnProperty(n)&&(this.pack(n),this.pack(e[n]))},a.prototype.pack_uint8=function(e){this.bufferBuilder.append(e)},a.prototype.pack_uint16=function(e){this.bufferBuilder.append(e>>8),this.bufferBuilder.append(255&e)},a.prototype.pack_uint32=function(e){var t=4294967295&e;this.bufferBuilder.append((4278190080&t)>>>24),this.bufferBuilder.append((16711680&t)>>>16),this.bufferBuilder.append((65280&t)>>>8),this.bufferBuilder.append(255&t)},a.prototype.pack_uint64=function(e){var t=e/Math.pow(2,32),n=e%Math.pow(2,32);this.bufferBuilder.append((4278190080&t)>>>24),this.bufferBuilder.append((16711680&t)>>>16),this.bufferBuilder.append((65280&t)>>>8),this.bufferBuilder.append(255&t),this.bufferBuilder.append((4278190080&n)>>>24),this.bufferBuilder.append((16711680&n)>>>16),this.bufferBuilder.append((65280&n)>>>8),this.bufferBuilder.append(255&n)},a.prototype.pack_int8=function(e){this.bufferBuilder.append(255&e)},a.prototype.pack_int16=function(e){this.bufferBuilder.append((65280&e)>>8),this.bufferBuilder.append(255&e)},a.prototype.pack_int32=function(e){this.bufferBuilder.append(e>>>24&255),this.bufferBuilder.append((16711680&e)>>>16),this.bufferBuilder.append((65280&e)>>>8),this.bufferBuilder.append(255&e)},a.prototype.pack_int64=function(e){var t=Math.floor(e/Math.pow(2,32)),n=e%Math.pow(2,32);this.bufferBuilder.append((4278190080&t)>>>24),this.bufferBuilder.append((16711680&t)>>>16),this.bufferBuilder.append((65280&t)>>>8),this.bufferBuilder.append(255&t),this.bufferBuilder.append((4278190080&n)>>>24),this.bufferBuilder.append((16711680&n)>>>16),this.bufferBuilder.append((65280&n)>>>8),this.bufferBuilder.append(255&n)}},"./node_modules/js-binarypack/lib/bufferbuilder.js":function(e,t){var n={};n.useBlobBuilder=function(){try{return new Blob([]),!1}catch(e){return!0}}(),n.useArrayBufferView=!n.useBlobBuilder&&function(){try{return 0===new Blob([new Uint8Array([])]).size}catch(e){return!0}}(),e.exports.binaryFeatures=n;var i=e.exports.BlobBuilder;function o(){this._pieces=[],this._parts=[]}"undefined"!=typeof window&&(i=e.exports.BlobBuilder=window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder||window.BlobBuilder),o.prototype.append=function(e){"number"==typeof e?this._pieces.push(e):(this.flush(),this._parts.push(e))},o.prototype.flush=function(){if(this._pieces.length>0){var e=new Uint8Array(this._pieces);n.useArrayBufferView||(e=e.buffer),this._parts.push(e),this._pieces=[]}},o.prototype.getBuffer=function(){if(this.flush(),n.useBlobBuilder){for(var e=new i,t=0,o=this._parts.length;t<o;t++)e.append(this._parts[t]);return e.getBlob()}return new Blob(this._parts)},e.exports.BufferBuilder=o},"./node_modules/ms/index.js":function(e,t){var n=1e3,i=60*n,o=60*i,r=24*o;function s(e,t,n){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+n:Math.ceil(e/t)+" "+n+"s"}e.exports=function(e,t){t=t||{};var a,c=typeof e;if("string"===c&&e.length>0)return function(e){if(!((e=String(e)).length>100)){var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(t){var s=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*s;case"days":case"day":case"d":return s*r;case"hours":case"hour":case"hrs":case"hr":case"h":return s*o;case"minutes":case"minute":case"mins":case"min":case"m":return s*i;case"seconds":case"second":case"secs":case"sec":case"s":return s*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return s;default:return}}}}(e);if("number"===c&&!1===isNaN(e))return t.long?s(a=e,r,"day")||s(a,o,"hour")||s(a,i,"minute")||s(a,n,"second")||a+" ms":function(e){return e>=r?Math.round(e/r)+"d":e>=o?Math.round(e/o)+"h":e>=i?Math.round(e/i)+"m":e>=n?Math.round(e/n)+"s":e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},"./node_modules/node-libs-browser/node_modules/buffer/index.js":function(e,t,n){"use strict";(function(e){var i=n("./node_modules/base64-js/index.js"),o=n("./node_modules/ieee754/index.js"),r=n("./node_modules/node-libs-browser/node_modules/isarray/index.js");function s(){return c.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function a(e,t){if(s()<t)throw new RangeError("Invalid typed array length");return c.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=c.prototype:(null===e&&(e=new c(t)),e.length=t),e}function c(e,t,n){if(!(c.TYPED_ARRAY_SUPPORT||this instanceof c))return new c(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return l(this,e)}return u(this,e,t,n)}function u(e,t,n,i){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,i){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(i||0))throw new RangeError("'length' is out of bounds");return t=void 0===n&&void 0===i?new Uint8Array(t):void 0===i?new Uint8Array(t,n):new Uint8Array(t,n,i),c.TYPED_ARRAY_SUPPORT?(e=t).__proto__=c.prototype:e=h(e,t),e}(e,t,n,i):"string"==typeof t?function(e,t,n){if("string"==typeof n&&""!==n||(n="utf8"),!c.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var i=0|f(t,n),o=(e=a(e,i)).write(t,n);return o!==i&&(e=e.slice(0,o)),e}(e,t,n):function(e,t){if(c.isBuffer(t)){var n=0|p(t.length);return 0===(e=a(e,n)).length||t.copy(e,0,0,n),e}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(i=t.length)!=i?a(e,0):h(e,t);if("Buffer"===t.type&&r(t.data))return h(e,t.data)}var i;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function d(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function l(e,t){if(d(t),e=a(e,t<0?0:0|p(t)),!c.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function h(e,t){var n=t.length<0?0:0|p(t.length);e=a(e,n);for(var i=0;i<n;i+=1)e[i]=255&t[i];return e}function p(e){if(e>=s())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s().toString(16)+" bytes");return 0|e}function f(e,t){if(c.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var i=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return F(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return z(e).length;default:if(i)return F(e).length;t=(""+t).toLowerCase(),i=!0}}function m(e,t,n){var i=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return I(this,t,n);case"utf8":case"utf-8":return T(this,t,n);case"ascii":return R(this,t,n);case"latin1":case"binary":return N(this,t,n);case"base64":return k(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return x(this,t,n);default:if(i)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),i=!0}}function g(e,t,n){var i=e[t];e[t]=e[n],e[n]=i}function y(e,t,n,i,o){if(0===e.length)return-1;if("string"==typeof n?(i=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=o?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(o)return-1;n=e.length-1}else if(n<0){if(!o)return-1;n=0}if("string"==typeof t&&(t=c.from(t,i)),c.isBuffer(t))return 0===t.length?-1:v(e,t,n,i,o);if("number"==typeof t)return t&=255,c.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):v(e,[t],n,i,o);throw new TypeError("val must be string, number or Buffer")}function v(e,t,n,i,o){var r,s=1,a=e.length,c=t.length;if(void 0!==i&&("ucs2"===(i=String(i).toLowerCase())||"ucs-2"===i||"utf16le"===i||"utf-16le"===i)){if(e.length<2||t.length<2)return-1;s=2,a/=2,c/=2,n/=2}function u(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(o){var d=-1;for(r=n;r<a;r++)if(u(e,r)===u(t,-1===d?0:r-d)){if(-1===d&&(d=r),r-d+1===c)return d*s}else-1!==d&&(r-=r-d),d=-1}else for(n+c>a&&(n=a-c),r=n;r>=0;r--){for(var l=!0,h=0;h<c;h++)if(u(e,r+h)!==u(t,h)){l=!1;break}if(l)return r}return-1}function _(e,t,n,i){n=Number(n)||0;var o=e.length-n;i?(i=Number(i))>o&&(i=o):i=o;var r=t.length;if(r%2!=0)throw new TypeError("Invalid hex string");i>r/2&&(i=r/2);for(var s=0;s<i;++s){var a=parseInt(t.substr(2*s,2),16);if(isNaN(a))return s;e[n+s]=a}return s}function b(e,t,n,i){return V(F(t,e.length-n),e,n,i)}function S(e,t,n,i){return V(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,i)}function w(e,t,n,i){return S(e,t,n,i)}function E(e,t,n,i){return V(z(t),e,n,i)}function C(e,t,n,i){return V(function(e,t){for(var n,i,o,r=[],s=0;s<e.length&&!((t-=2)<0);++s)i=(n=e.charCodeAt(s))>>8,o=n%256,r.push(o),r.push(i);return r}(t,e.length-n),e,n,i)}function k(e,t,n){return 0===t&&n===e.length?i.fromByteArray(e):i.fromByteArray(e.slice(t,n))}function T(e,t,n){n=Math.min(e.length,n);for(var i=[],o=t;o<n;){var r,s,a,c,u=e[o],d=null,l=u>239?4:u>223?3:u>191?2:1;if(o+l<=n)switch(l){case 1:u<128&&(d=u);break;case 2:128==(192&(r=e[o+1]))&&(c=(31&u)<<6|63&r)>127&&(d=c);break;case 3:r=e[o+1],s=e[o+2],128==(192&r)&&128==(192&s)&&(c=(15&u)<<12|(63&r)<<6|63&s)>2047&&(c<55296||c>57343)&&(d=c);break;case 4:r=e[o+1],s=e[o+2],a=e[o+3],128==(192&r)&&128==(192&s)&&128==(192&a)&&(c=(15&u)<<18|(63&r)<<12|(63&s)<<6|63&a)>65535&&c<1114112&&(d=c)}null===d?(d=65533,l=1):d>65535&&(d-=65536,i.push(d>>>10&1023|55296),d=56320|1023&d),i.push(d),o+=l}return function(e){var t=e.length;if(t<=A)return String.fromCharCode.apply(String,e);for(var n="",i=0;i<t;)n+=String.fromCharCode.apply(String,e.slice(i,i+=A));return n}(i)}t.Buffer=c,t.SlowBuffer=function(e){return+e!=e&&(e=0),c.alloc(+e)},t.INSPECT_MAX_BYTES=50,c.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=s(),c.poolSize=8192,c._augment=function(e){return e.__proto__=c.prototype,e},c.from=function(e,t,n){return u(null,e,t,n)},c.TYPED_ARRAY_SUPPORT&&(c.prototype.__proto__=Uint8Array.prototype,c.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&c[Symbol.species]===c&&Object.defineProperty(c,Symbol.species,{value:null,configurable:!0})),c.alloc=function(e,t,n){return function(e,t,n,i){return d(t),t<=0?a(e,t):void 0!==n?"string"==typeof i?a(e,t).fill(n,i):a(e,t).fill(n):a(e,t)}(null,e,t,n)},c.allocUnsafe=function(e){return l(null,e)},c.allocUnsafeSlow=function(e){return l(null,e)},c.isBuffer=function(e){return!(null==e||!e._isBuffer)},c.compare=function(e,t){if(!c.isBuffer(e)||!c.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,i=t.length,o=0,r=Math.min(n,i);o<r;++o)if(e[o]!==t[o]){n=e[o],i=t[o];break}return n<i?-1:i<n?1:0},c.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(e,t){if(!r(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return c.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var i=c.allocUnsafe(t),o=0;for(n=0;n<e.length;++n){var s=e[n];if(!c.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(i,o),o+=s.length}return i},c.byteLength=f,c.prototype._isBuffer=!0,c.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)g(this,t,t+1);return this},c.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)g(this,t,t+3),g(this,t+1,t+2);return this},c.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)g(this,t,t+7),g(this,t+1,t+6),g(this,t+2,t+5),g(this,t+3,t+4);return this},c.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?T(this,0,e):m.apply(this,arguments)},c.prototype.equals=function(e){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===c.compare(this,e)},c.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},c.prototype.compare=function(e,t,n,i,o){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===i&&(i=0),void 0===o&&(o=this.length),t<0||n>e.length||i<0||o>this.length)throw new RangeError("out of range index");if(i>=o&&t>=n)return 0;if(i>=o)return-1;if(t>=n)return 1;if(this===e)return 0;for(var r=(o>>>=0)-(i>>>=0),s=(n>>>=0)-(t>>>=0),a=Math.min(r,s),u=this.slice(i,o),d=e.slice(t,n),l=0;l<a;++l)if(u[l]!==d[l]){r=u[l],s=d[l];break}return r<s?-1:s<r?1:0},c.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},c.prototype.indexOf=function(e,t,n){return y(this,e,t,n,!0)},c.prototype.lastIndexOf=function(e,t,n){return y(this,e,t,n,!1)},c.prototype.write=function(e,t,n,i){if(void 0===t)i="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)i=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===i&&(i="utf8")):(i=n,n=void 0)}var o=this.length-t;if((void 0===n||n>o)&&(n=o),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");for(var r=!1;;)switch(i){case"hex":return _(this,e,t,n);case"utf8":case"utf-8":return b(this,e,t,n);case"ascii":return S(this,e,t,n);case"latin1":case"binary":return w(this,e,t,n);case"base64":return E(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return C(this,e,t,n);default:if(r)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),r=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var A=4096;function R(e,t,n){var i="";n=Math.min(e.length,n);for(var o=t;o<n;++o)i+=String.fromCharCode(127&e[o]);return i}function N(e,t,n){var i="";n=Math.min(e.length,n);for(var o=t;o<n;++o)i+=String.fromCharCode(e[o]);return i}function I(e,t,n){var i,o=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>o)&&(n=o);for(var r="",s=t;s<n;++s)r+=(i=e[s])<16?"0"+i.toString(16):i.toString(16);return r}function x(e,t,n){for(var i=e.slice(t,n),o="",r=0;r<i.length;r+=2)o+=String.fromCharCode(i[r]+256*i[r+1]);return o}function O(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function M(e,t,n,i,o,r){if(!c.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>o||t<r)throw new RangeError('"value" argument is out of bounds');if(n+i>e.length)throw new RangeError("Index out of range")}function P(e,t,n,i){t<0&&(t=65535+t+1);for(var o=0,r=Math.min(e.length-n,2);o<r;++o)e[n+o]=(t&255<<8*(i?o:1-o))>>>8*(i?o:1-o)}function B(e,t,n,i){t<0&&(t=4294967295+t+1);for(var o=0,r=Math.min(e.length-n,4);o<r;++o)e[n+o]=t>>>8*(i?o:3-o)&255}function L(e,t,n,i,o,r){if(n+i>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function j(e,t,n,i,r){return r||L(e,0,n,4),o.write(e,t,n,i,23,4),n+4}function D(e,t,n,i,r){return r||L(e,0,n,8),o.write(e,t,n,i,52,8),n+8}c.prototype.slice=function(e,t){var n,i=this.length;if((e=~~e)<0?(e+=i)<0&&(e=0):e>i&&(e=i),(t=void 0===t?i:~~t)<0?(t+=i)<0&&(t=0):t>i&&(t=i),t<e&&(t=e),c.TYPED_ARRAY_SUPPORT)(n=this.subarray(e,t)).__proto__=c.prototype;else{var o=t-e;n=new c(o,void 0);for(var r=0;r<o;++r)n[r]=this[r+e]}return n},c.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||O(e,t,this.length);for(var i=this[e],o=1,r=0;++r<t&&(o*=256);)i+=this[e+r]*o;return i},c.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||O(e,t,this.length);for(var i=this[e+--t],o=1;t>0&&(o*=256);)i+=this[e+--t]*o;return i},c.prototype.readUInt8=function(e,t){return t||O(e,1,this.length),this[e]},c.prototype.readUInt16LE=function(e,t){return t||O(e,2,this.length),this[e]|this[e+1]<<8},c.prototype.readUInt16BE=function(e,t){return t||O(e,2,this.length),this[e]<<8|this[e+1]},c.prototype.readUInt32LE=function(e,t){return t||O(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},c.prototype.readUInt32BE=function(e,t){return t||O(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},c.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||O(e,t,this.length);for(var i=this[e],o=1,r=0;++r<t&&(o*=256);)i+=this[e+r]*o;return i>=(o*=128)&&(i-=Math.pow(2,8*t)),i},c.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||O(e,t,this.length);for(var i=t,o=1,r=this[e+--i];i>0&&(o*=256);)r+=this[e+--i]*o;return r>=(o*=128)&&(r-=Math.pow(2,8*t)),r},c.prototype.readInt8=function(e,t){return t||O(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},c.prototype.readInt16LE=function(e,t){t||O(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt16BE=function(e,t){t||O(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt32LE=function(e,t){return t||O(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},c.prototype.readInt32BE=function(e,t){return t||O(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},c.prototype.readFloatLE=function(e,t){return t||O(e,4,this.length),o.read(this,e,!0,23,4)},c.prototype.readFloatBE=function(e,t){return t||O(e,4,this.length),o.read(this,e,!1,23,4)},c.prototype.readDoubleLE=function(e,t){return t||O(e,8,this.length),o.read(this,e,!0,52,8)},c.prototype.readDoubleBE=function(e,t){return t||O(e,8,this.length),o.read(this,e,!1,52,8)},c.prototype.writeUIntLE=function(e,t,n,i){e=+e,t|=0,n|=0,i||M(this,e,t,n,Math.pow(2,8*n)-1,0);var o=1,r=0;for(this[t]=255&e;++r<n&&(o*=256);)this[t+r]=e/o&255;return t+n},c.prototype.writeUIntBE=function(e,t,n,i){e=+e,t|=0,n|=0,i||M(this,e,t,n,Math.pow(2,8*n)-1,0);var o=n-1,r=1;for(this[t+o]=255&e;--o>=0&&(r*=256);)this[t+o]=e/r&255;return t+n},c.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||M(this,e,t,1,255,0),c.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},c.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||M(this,e,t,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):P(this,e,t,!0),t+2},c.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||M(this,e,t,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):P(this,e,t,!1),t+2},c.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||M(this,e,t,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):B(this,e,t,!0),t+4},c.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||M(this,e,t,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):B(this,e,t,!1),t+4},c.prototype.writeIntLE=function(e,t,n,i){if(e=+e,t|=0,!i){var o=Math.pow(2,8*n-1);M(this,e,t,n,o-1,-o)}var r=0,s=1,a=0;for(this[t]=255&e;++r<n&&(s*=256);)e<0&&0===a&&0!==this[t+r-1]&&(a=1),this[t+r]=(e/s>>0)-a&255;return t+n},c.prototype.writeIntBE=function(e,t,n,i){if(e=+e,t|=0,!i){var o=Math.pow(2,8*n-1);M(this,e,t,n,o-1,-o)}var r=n-1,s=1,a=0;for(this[t+r]=255&e;--r>=0&&(s*=256);)e<0&&0===a&&0!==this[t+r+1]&&(a=1),this[t+r]=(e/s>>0)-a&255;return t+n},c.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||M(this,e,t,1,127,-128),c.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},c.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||M(this,e,t,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):P(this,e,t,!0),t+2},c.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||M(this,e,t,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):P(this,e,t,!1),t+2},c.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||M(this,e,t,4,2147483647,-2147483648),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):B(this,e,t,!0),t+4},c.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||M(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):B(this,e,t,!1),t+4},c.prototype.writeFloatLE=function(e,t,n){return j(this,e,t,!0,n)},c.prototype.writeFloatBE=function(e,t,n){return j(this,e,t,!1,n)},c.prototype.writeDoubleLE=function(e,t,n){return D(this,e,t,!0,n)},c.prototype.writeDoubleBE=function(e,t,n){return D(this,e,t,!1,n)},c.prototype.copy=function(e,t,n,i){if(n||(n=0),i||0===i||(i=this.length),t>=e.length&&(t=e.length),t||(t=0),i>0&&i<n&&(i=n),i===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),e.length-t<i-n&&(i=e.length-t+n);var o,r=i-n;if(this===e&&n<t&&t<i)for(o=r-1;o>=0;--o)e[o+t]=this[o+n];else if(r<1e3||!c.TYPED_ARRAY_SUPPORT)for(o=0;o<r;++o)e[o+t]=this[o+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+r),t);return r},c.prototype.fill=function(e,t,n,i){if("string"==typeof e){if("string"==typeof t?(i=t,t=0,n=this.length):"string"==typeof n&&(i=n,n=this.length),1===e.length){var o=e.charCodeAt(0);o<256&&(e=o)}if(void 0!==i&&"string"!=typeof i)throw new TypeError("encoding must be a string");if("string"==typeof i&&!c.isEncoding(i))throw new TypeError("Unknown encoding: "+i)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var r;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(r=t;r<n;++r)this[r]=e;else{var s=c.isBuffer(e)?e:F(new c(e,i).toString()),a=s.length;for(r=0;r<n-t;++r)this[r+t]=s[r%a]}return this};var U=/[^+\/0-9A-Za-z-_]/g;function F(e,t){var n;t=t||1/0;for(var i=e.length,o=null,r=[],s=0;s<i;++s){if((n=e.charCodeAt(s))>55295&&n<57344){if(!o){if(n>56319){(t-=3)>-1&&r.push(239,191,189);continue}if(s+1===i){(t-=3)>-1&&r.push(239,191,189);continue}o=n;continue}if(n<56320){(t-=3)>-1&&r.push(239,191,189),o=n;continue}n=65536+(o-55296<<10|n-56320)}else o&&(t-=3)>-1&&r.push(239,191,189);if(o=null,n<128){if((t-=1)<0)break;r.push(n)}else if(n<2048){if((t-=2)<0)break;r.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;r.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;r.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return r}function z(e){return i.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(U,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function V(e,t,n,i){for(var o=0;o<i&&!(o+n>=t.length||o>=e.length);++o)t[o+n]=e[o];return o}}).call(this,n("./node_modules/webpack/buildin/global.js"))},"./node_modules/node-libs-browser/node_modules/isarray/index.js":function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},"./node_modules/object-sizeof/byte_size.js":function(e,t){e.exports={STRING:2,BOOLEAN:4,NUMBER:8}},"./node_modules/object-sizeof/index.js":function(e,t,n){"use strict";var i=n("./node_modules/object-sizeof/byte_size.js"),o=n("./node_modules/node-libs-browser/node_modules/buffer/index.js").Buffer;function r(e){return function(t){if(o.isBuffer(t))return t.length;switch(typeof t){case"string":return t.length*i.STRING;case"boolean":return i.BOOLEAN;case"number":return i.NUMBER;case"symbol":return Symbol.keyFor&&Symbol.keyFor(t)?Symbol.keyFor(t).length*i.STRING:(t.toString().length-8)*i.STRING;case"object":return Array.isArray(t)?t.map(r(e)).reduce((function(e,t){return e+t}),0):function(e,t){if(null==t)return 0;for(var n=0,i=function(e){const t=[];for(var n in e)t.push(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);Array.prototype.push.apply(t,i)}return t}(t),o=0;o<i.length;o++){var s=i[o];if("object"==typeof t[s]&&null!==t[s]){if(e.has(t[s]))continue;e.add(t[s])}n+=r(e)(s);try{n+=r(e)(t[s])}catch(e){e instanceof RangeError&&(n=0)}}return n}(e,t);default:return 0}}}e.exports=function(e){return r(new WeakSet)(e)}},"./node_modules/parseqs/index.js":function(e,t){t.encode=function(e){var t="";for(var n in e)e.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t},t.decode=function(e){for(var t={},n=e.split("&"),i=0,o=n.length;i<o;i++){var r=n[i].split("=");t[decodeURIComponent(r[0])]=decodeURIComponent(r[1])}return t}},"./node_modules/parseuri/index.js":function(e,t){var n=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,i=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];e.exports=function(e){var t,o,r,s=e,a=e.indexOf("["),c=e.indexOf("]");-1!=a&&-1!=c&&(e=e.substring(0,a)+e.substring(a,c).replace(/:/g,";")+e.substring(c,e.length));for(var u,d,l=n.exec(e||""),h={},p=14;p--;)h[i[p]]=l[p]||"";return-1!=a&&-1!=c&&(h.source=s,h.host=h.host.substring(1,h.host.length-1).replace(/;/g,":"),h.authority=h.authority.replace("[","").replace("]","").replace(/;/g,":"),h.ipv6uri=!0),h.pathNames=(o=/\/{2,9}/g,r=(t=h.path).replace(o,"/").split("/"),"/"!=t.substr(0,1)&&0!==t.length||r.splice(0,1),"/"==t.substr(t.length-1,1)&&r.splice(r.length-1,1),r),h.queryKey=(u=h.query,d={},u.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,(function(e,t,n){t&&(d[t]=n)})),d),h}},"./node_modules/process/browser.js":function(e,t){var n,i,o=e.exports={};function r(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(e){if(n===setTimeout)return setTimeout(e,0);if((n===r||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:r}catch(e){n=r}try{i="function"==typeof clearTimeout?clearTimeout:s}catch(e){i=s}}();var c,u=[],d=!1,l=-1;function h(){d&&c&&(d=!1,c.length?u=c.concat(u):l=-1,u.length&&p())}function p(){if(!d){var e=a(h);d=!0;for(var t=u.length;t;){for(c=u,u=[];++l<t;)c&&c[l].run();l=-1,t=u.length}c=null,d=!1,function(e){if(i===clearTimeout)return clearTimeout(e);if((i===s||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(e);try{i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function m(){}o.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];u.push(new f(e,t)),1!==u.length||d||a(p)},f.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=m,o.addListener=m,o.once=m,o.off=m,o.removeListener=m,o.removeAllListeners=m,o.emit=m,o.prependListener=m,o.prependOnceListener=m,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},"./node_modules/query-string/index.js":function(e,t,n){"use strict";const i=n("./node_modules/strict-uri-encode/index.js"),o=n("./node_modules/decode-uri-component/index.js"),r=n("./node_modules/split-on-first/index.js"),s=n("./node_modules/filter-obj/index.js");function a(e){if("string"!=typeof e||1!==e.length)throw new TypeError("arrayFormatSeparator must be single character string")}function c(e,t){return t.encode?t.strict?i(e):encodeURIComponent(e):e}function u(e,t){return t.decode?o(e):e}function d(e){return Array.isArray(e)?e.sort():"object"==typeof e?d(Object.keys(e)).sort(((e,t)=>Number(e)-Number(t))).map((t=>e[t])):e}function l(e){const t=e.indexOf("#");return-1!==t&&(e=e.slice(0,t)),e}function h(e){const t=(e=l(e)).indexOf("?");return-1===t?"":e.slice(t+1)}function p(e,t){return t.parseNumbers&&!Number.isNaN(Number(e))&&"string"==typeof e&&""!==e.trim()?e=Number(e):!t.parseBooleans||null===e||"true"!==e.toLowerCase()&&"false"!==e.toLowerCase()||(e="true"===e.toLowerCase()),e}function f(e,t){a((t=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},t)).arrayFormatSeparator);const n=function(e){let t;switch(e.arrayFormat){case"index":return(e,n,i)=>{t=/\[(\d*)\]$/.exec(e),e=e.replace(/\[\d*\]$/,""),t?(void 0===i[e]&&(i[e]={}),i[e][t[1]]=n):i[e]=n};case"bracket":return(e,n,i)=>{t=/(\[\])$/.exec(e),e=e.replace(/\[\]$/,""),t?void 0!==i[e]?i[e]=[].concat(i[e],n):i[e]=[n]:i[e]=n};case"comma":case"separator":return(t,n,i)=>{const o="string"==typeof n&&n.includes(e.arrayFormatSeparator),r="string"==typeof n&&!o&&u(n,e).includes(e.arrayFormatSeparator);n=r?u(n,e):n;const s=o||r?n.split(e.arrayFormatSeparator).map((t=>u(t,e))):null===n?n:u(n,e);i[t]=s};default:return(e,t,n)=>{void 0!==n[e]?n[e]=[].concat(n[e],t):n[e]=t}}}(t),i=Object.create(null);if("string"!=typeof e)return i;if(!(e=e.trim().replace(/^[?#&]/,"")))return i;for(const o of e.split("&")){if(""===o)continue;let[e,s]=r(t.decode?o.replace(/\+/g," "):o,"=");s=void 0===s?null:["comma","separator"].includes(t.arrayFormat)?s:u(s,t),n(u(e,t),s,i)}for(const e of Object.keys(i)){const n=i[e];if("object"==typeof n&&null!==n)for(const e of Object.keys(n))n[e]=p(n[e],t);else i[e]=p(n,t)}return!1===t.sort?i:(!0===t.sort?Object.keys(i).sort():Object.keys(i).sort(t.sort)).reduce(((e,t)=>{const n=i[t];return Boolean(n)&&"object"==typeof n&&!Array.isArray(n)?e[t]=d(n):e[t]=n,e}),Object.create(null))}t.extract=h,t.parse=f,t.stringify=(e,t)=>{if(!e)return"";a((t=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},t)).arrayFormatSeparator);const n=n=>t.skipNull&&null==e[n]||t.skipEmptyString&&""===e[n],i=function(e){switch(e.arrayFormat){case"index":return t=>(n,i)=>{const o=n.length;return void 0===i||e.skipNull&&null===i||e.skipEmptyString&&""===i?n:null===i?[...n,[c(t,e),"[",o,"]"].join("")]:[...n,[c(t,e),"[",c(o,e),"]=",c(i,e)].join("")]};case"bracket":return t=>(n,i)=>void 0===i||e.skipNull&&null===i||e.skipEmptyString&&""===i?n:null===i?[...n,[c(t,e),"[]"].join("")]:[...n,[c(t,e),"[]=",c(i,e)].join("")];case"comma":case"separator":return t=>(n,i)=>null==i||0===i.length?n:0===n.length?[[c(t,e),"=",c(i,e)].join("")]:[[n,c(i,e)].join(e.arrayFormatSeparator)];default:return t=>(n,i)=>void 0===i||e.skipNull&&null===i||e.skipEmptyString&&""===i?n:null===i?[...n,c(t,e)]:[...n,[c(t,e),"=",c(i,e)].join("")]}}(t),o={};for(const t of Object.keys(e))n(t)||(o[t]=e[t]);const r=Object.keys(o);return!1!==t.sort&&r.sort(t.sort),r.map((n=>{const o=e[n];return void 0===o?"":null===o?c(n,t):Array.isArray(o)?o.reduce(i(n),[]).join("&"):c(n,t)+"="+c(o,t)})).filter((e=>e.length>0)).join("&")},t.parseUrl=(e,t)=>{t=Object.assign({decode:!0},t);const[n,i]=r(e,"#");return Object.assign({url:n.split("?")[0]||"",query:f(h(e),t)},t&&t.parseFragmentIdentifier&&i?{fragmentIdentifier:u(i,t)}:{})},t.stringifyUrl=(e,n)=>{n=Object.assign({encode:!0,strict:!0},n);const i=l(e.url).split("?")[0]||"",o=t.extract(e.url),r=t.parse(o,{sort:!1}),s=Object.assign(r,e.query);let a=t.stringify(s,n);a&&(a=`?${a}`);let u=function(e){let t="";const n=e.indexOf("#");return-1!==n&&(t=e.slice(n)),t}(e.url);return e.fragmentIdentifier&&(u=`#${c(e.fragmentIdentifier,n)}`),`${i}${a}${u}`},t.pick=(e,n,i)=>{i=Object.assign({parseFragmentIdentifier:!0},i);const{url:o,query:r,fragmentIdentifier:a}=t.parseUrl(e,i);return t.stringifyUrl({url:o,query:s(r,n),fragmentIdentifier:a},i)},t.exclude=(e,n,i)=>{const o=Array.isArray(n)?e=>!n.includes(e):(e,t)=>!n(e,t);return t.pick(e,o,i)}},"./node_modules/sdp-transform/lib/grammar.js":function(e,t){var n=e.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(e){return e.encoding?"rtpmap:%d %s/%s/%s":e.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(e){return null!=e.address?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(e){return null!=e.subtype?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(e){return"extmap:%d"+(e.direction?"/%s":"%v")+(e["encrypt-uri"]?" %s":"%v")+" %s"+(e.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(e){return null!=e.sessionConfig?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(e){var t="candidate:%s %d %s %d %s %d typ %s";return t+=null!=e.raddr?" raddr %s rport %d":"%v%v",t+=null!=e.tcptype?" tcptype %s":"%v",null!=e.generation&&(t+=" generation %d"),(t+=null!=e["network-id"]?" network-id %d":"%v")+(null!=e["network-cost"]?" network-cost %d":"%v")}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(e){var t="ssrc:%d";return null!=e.attribute&&(t+=" %s",null!=e.value&&(t+=":%s")),t}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(e){return null!=e.maxMessageSize?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(e){return e.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(e){return"imageattr:%s %s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(e){return"simulcast:%s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(e){return"ts-refclk:%s"+(null!=e.clksrcExt?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(e){var t="mediaclk:";return t+=null!=e.id?"id=%s %s":"%v%s",t+=null!=e.mediaClockValue?"=%s":"",(t+=null!=e.rateNumerator?" rate=%s":"")+(null!=e.rateDenominator?"/%s":"")}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};Object.keys(n).forEach((function(e){n[e].forEach((function(e){e.reg||(e.reg=/(.*)/),e.format||(e.format="%s")}))}))},"./node_modules/sdp-transform/lib/index.js":function(e,t,n){var i=n("./node_modules/sdp-transform/lib/parser.js"),o=n("./node_modules/sdp-transform/lib/writer.js");t.write=o,t.parse=i.parse,t.parseParams=i.parseParams,t.parseFmtpConfig=i.parseFmtpConfig,t.parsePayloads=i.parsePayloads,t.parseRemoteCandidates=i.parseRemoteCandidates,t.parseImageAttributes=i.parseImageAttributes,t.parseSimulcastStreamList=i.parseSimulcastStreamList},"./node_modules/sdp-transform/lib/parser.js":function(e,t,n){var i=function(e){return String(Number(e))===e?Number(e):e},o=function(e,t,n){var o=e.name&&e.names;e.push&&!t[e.push]?t[e.push]=[]:o&&!t[e.name]&&(t[e.name]={});var r=e.push?{}:o?t[e.name]:t;!function(e,t,n,o){if(o&&!n)t[o]=i(e[1]);else for(var r=0;r<n.length;r+=1)null!=e[r+1]&&(t[n[r]]=i(e[r+1]))}(n.match(e.reg),r,e.names,e.name),e.push&&t[e.push].push(r)},r=n("./node_modules/sdp-transform/lib/grammar.js"),s=RegExp.prototype.test.bind(/^([a-z])=(.*)/);t.parse=function(e){var t={},n=[],i=t;return e.split(/(\r\n|\r|\n)/).filter(s).forEach((function(e){var t=e[0],s=e.slice(2);"m"===t&&(n.push({rtp:[],fmtp:[]}),i=n[n.length-1]);for(var a=0;a<(r[t]||[]).length;a+=1){var c=r[t][a];if(c.reg.test(s))return o(c,i,s)}})),t.media=n,t};var a=function(e,t){var n=t.split(/=(.+)/,2);return 2===n.length?e[n[0]]=i(n[1]):1===n.length&&t.length>1&&(e[n[0]]=void 0),e};t.parseParams=function(e){return e.split(/;\s?/).reduce(a,{})},t.parseFmtpConfig=t.parseParams,t.parsePayloads=function(e){return e.toString().split(" ").map(Number)},t.parseRemoteCandidates=function(e){for(var t=[],n=e.split(" ").map(i),o=0;o<n.length;o+=3)t.push({component:n[o],ip:n[o+1],port:n[o+2]});return t},t.parseImageAttributes=function(e){return e.split(" ").map((function(e){return e.substring(1,e.length-1).split(",").reduce(a,{})}))},t.parseSimulcastStreamList=function(e){return e.split(";").map((function(e){return e.split(",").map((function(e){var t,n=!1;return"~"!==e[0]?t=i(e):(t=i(e.substring(1,e.length)),n=!0),{scid:t,paused:n}}))}))}},"./node_modules/sdp-transform/lib/writer.js":function(e,t,n){var i=n("./node_modules/sdp-transform/lib/grammar.js"),o=/%[sdv%]/g,r=function(e){var t=1,n=arguments,i=n.length;return e.replace(o,(function(e){if(t>=i)return e;var o=n[t];switch(t+=1,e){case"%%":return"%";case"%s":return String(o);case"%d":return Number(o);case"%v":return""}}))},s=function(e,t,n){var i=[e+"="+(t.format instanceof Function?t.format(t.push?n:n[t.name]):t.format)];if(t.names)for(var o=0;o<t.names.length;o+=1){var s=t.names[o];t.name?i.push(n[t.name][s]):i.push(n[t.names[o]])}else i.push(n[t.name]);return r.apply(null,i)},a=["v","o","s","i","u","e","p","c","b","t","r","z","a"],c=["i","c","b","a"];e.exports=function(e,t){t=t||{},null==e.version&&(e.version=0),null==e.name&&(e.name=" "),e.media.forEach((function(e){null==e.payloads&&(e.payloads="")}));var n=t.outerOrder||a,o=t.innerOrder||c,r=[];return n.forEach((function(t){i[t].forEach((function(n){n.name in e&&null!=e[n.name]?r.push(s(t,n,e)):n.push in e&&null!=e[n.push]&&e[n.push].forEach((function(e){r.push(s(t,n,e))}))}))})),e.media.forEach((function(e){r.push(s("m",i.m[0],e)),o.forEach((function(t){i[t].forEach((function(n){n.name in e&&null!=e[n.name]?r.push(s(t,n,e)):n.push in e&&null!=e[n.push]&&e[n.push].forEach((function(e){r.push(s(t,n,e))}))}))}))})),r.join("\r\n")+"\r\n"}},"./node_modules/socket.io-client/lib/index.js":function(e,t,n){var i=n("./node_modules/socket.io-client/lib/url.js"),o=n("./node_modules/socket.io-parser/index.js"),r=n("./node_modules/socket.io-client/lib/manager.js"),s=n("./node_modules/debug/src/browser.js")("socket.io-client");e.exports=t=c;var a=t.managers={};function c(e,t){"object"==typeof e&&(t=e,e=void 0),t=t||{};var n,o=i(e),c=o.source,u=o.id,d=o.path,l=a[u]&&d in a[u].nsps;return t.forceNew||t["force new connection"]||!1===t.multiplex||l?(s("ignoring socket cache for %s",c),n=r(c,t)):(a[u]||(s("new io instance for %s",c),a[u]=r(c,t)),n=a[u]),o.query&&!t.query&&(t.query=o.query),n.socket(o.path,t)}t.protocol=o.protocol,t.connect=c,t.Manager=n("./node_modules/socket.io-client/lib/manager.js"),t.Socket=n("./node_modules/socket.io-client/lib/socket.js")},"./node_modules/socket.io-client/lib/manager.js":function(e,t,n){var i=n("./node_modules/engine.io-client/lib/index.js"),o=n("./node_modules/socket.io-client/lib/socket.js"),r=n("./node_modules/component-emitter/index.js"),s=n("./node_modules/socket.io-parser/index.js"),a=n("./node_modules/socket.io-client/lib/on.js"),c=n("./node_modules/component-bind/index.js"),u=n("./node_modules/debug/src/browser.js")("socket.io-client:manager"),d=n("./node_modules/indexof/index.js"),l=n("./node_modules/backo2/index.js"),h=Object.prototype.hasOwnProperty;function p(e,t){if(!(this instanceof p))return new p(e,t);e&&"object"==typeof e&&(t=e,e=void 0),(t=t||{}).path=t.path||"/socket.io",this.nsps={},this.subs=[],this.opts=t,this.reconnection(!1!==t.reconnection),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(t.randomizationFactor||.5),this.backoff=new l({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this.readyState="closed",this.uri=e,this.connecting=[],this.lastPing=null,this.encoding=!1,this.packetBuffer=[];var n=t.parser||s;this.encoder=new n.Encoder,this.decoder=new n.Decoder,this.autoConnect=!1!==t.autoConnect,this.autoConnect&&this.open()}e.exports=p,p.prototype.emitAll=function(){for(var e in this.emit.apply(this,arguments),this.nsps)h.call(this.nsps,e)&&this.nsps[e].emit.apply(this.nsps[e],arguments)},p.prototype.updateSocketIds=function(){for(var e in this.nsps)h.call(this.nsps,e)&&(this.nsps[e].id=this.generateId(e))},p.prototype.generateId=function(e){return("/"===e?"":e+"#")+this.engine.id},r(p.prototype),p.prototype.reconnection=function(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection},p.prototype.reconnectionAttempts=function(e){return arguments.length?(this._reconnectionAttempts=e,this):this._reconnectionAttempts},p.prototype.reconnectionDelay=function(e){return arguments.length?(this._reconnectionDelay=e,this.backoff&&this.backoff.setMin(e),this):this._reconnectionDelay},p.prototype.randomizationFactor=function(e){return arguments.length?(this._randomizationFactor=e,this.backoff&&this.backoff.setJitter(e),this):this._randomizationFactor},p.prototype.reconnectionDelayMax=function(e){return arguments.length?(this._reconnectionDelayMax=e,this.backoff&&this.backoff.setMax(e),this):this._reconnectionDelayMax},p.prototype.timeout=function(e){return arguments.length?(this._timeout=e,this):this._timeout},p.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()},p.prototype.open=p.prototype.connect=function(e,t){if(u("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;u("opening %s",this.uri),this.engine=i(this.uri,this.opts);var n=this.engine,o=this;this.readyState="opening",this.skipReconnect=!1;var r=a(n,"open",(function(){o.onopen(),e&&e()})),s=a(n,"error",(function(t){if(u("connect_error"),o.cleanup(),o.readyState="closed",o.emitAll("connect_error",t),e){var n=new Error("Connection error");n.data=t,e(n)}else o.maybeReconnectOnOpen()}));if(!1!==this._timeout){var c=this._timeout;u("connect attempt will timeout after %d",c),0===c&&r.destroy();var d=setTimeout((function(){u("connect attempt timed out after %d",c),r.destroy(),n.close(),n.emit("error","timeout"),o.emitAll("connect_timeout",c)}),c);this.subs.push({destroy:function(){clearTimeout(d)}})}return this.subs.push(r),this.subs.push(s),this},p.prototype.onopen=function(){u("open"),this.cleanup(),this.readyState="open",this.emit("open");var e=this.engine;this.subs.push(a(e,"data",c(this,"ondata"))),this.subs.push(a(e,"ping",c(this,"onping"))),this.subs.push(a(e,"pong",c(this,"onpong"))),this.subs.push(a(e,"error",c(this,"onerror"))),this.subs.push(a(e,"close",c(this,"onclose"))),this.subs.push(a(this.decoder,"decoded",c(this,"ondecoded")))},p.prototype.onping=function(){this.lastPing=new Date,this.emitAll("ping")},p.prototype.onpong=function(){this.emitAll("pong",new Date-this.lastPing)},p.prototype.ondata=function(e){this.decoder.add(e)},p.prototype.ondecoded=function(e){this.emit("packet",e)},p.prototype.onerror=function(e){u("error",e),this.emitAll("error",e)},p.prototype.socket=function(e,t){var n=this.nsps[e];if(!n){n=new o(this,e,t),this.nsps[e]=n;var i=this;n.on("connecting",r),n.on("connect",(function(){n.id=i.generateId(e)})),this.autoConnect&&r()}function r(){~d(i.connecting,n)||i.connecting.push(n)}return n},p.prototype.destroy=function(e){var t=d(this.connecting,e);~t&&this.connecting.splice(t,1),this.connecting.length||this.close()},p.prototype.packet=function(e){u("writing packet %j",e);var t=this;e.query&&0===e.type&&(e.nsp+="?"+e.query),t.encoding?t.packetBuffer.push(e):(t.encoding=!0,this.encoder.encode(e,(function(n){for(var i=0;i<n.length;i++)t.engine.write(n[i],e.options);t.encoding=!1,t.processPacketQueue()})))},p.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var e=this.packetBuffer.shift();this.packet(e)}},p.prototype.cleanup=function(){u("cleanup");for(var e=this.subs.length,t=0;t<e;t++)this.subs.shift().destroy();this.packetBuffer=[],this.encoding=!1,this.lastPing=null,this.decoder.destroy()},p.prototype.close=p.prototype.disconnect=function(){u("disconnect"),this.skipReconnect=!0,this.reconnecting=!1,"opening"===this.readyState&&this.cleanup(),this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},p.prototype.onclose=function(e){u("onclose"),this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",e),this._reconnection&&!this.skipReconnect&&this.reconnect()},p.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var e=this;if(this.backoff.attempts>=this._reconnectionAttempts)u("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var t=this.backoff.duration();u("will wait %dms before reconnect attempt",t),this.reconnecting=!0;var n=setTimeout((function(){e.skipReconnect||(u("attempting reconnect"),e.emitAll("reconnect_attempt",e.backoff.attempts),e.emitAll("reconnecting",e.backoff.attempts),e.skipReconnect||e.open((function(t){t?(u("reconnect attempt error"),e.reconnecting=!1,e.reconnect(),e.emitAll("reconnect_error",t.data)):(u("reconnect success"),e.onreconnect())})))}),t);this.subs.push({destroy:function(){clearTimeout(n)}})}},p.prototype.onreconnect=function(){var e=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",e)}},"./node_modules/socket.io-client/lib/on.js":function(e,t){e.exports=function(e,t,n){return e.on(t,n),{destroy:function(){e.removeListener(t,n)}}}},"./node_modules/socket.io-client/lib/socket.js":function(e,t,n){var i=n("./node_modules/socket.io-parser/index.js"),o=n("./node_modules/component-emitter/index.js"),r=n("./node_modules/to-array/index.js"),s=n("./node_modules/socket.io-client/lib/on.js"),a=n("./node_modules/component-bind/index.js"),c=n("./node_modules/debug/src/browser.js")("socket.io-client:socket"),u=n("./node_modules/parseqs/index.js"),d=n("./node_modules/has-binary2/index.js");e.exports=p;var l={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1},h=o.prototype.emit;function p(e,t,n){this.io=e,this.nsp=t,this.json=this,this.ids=0,this.acks={},this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0,this.flags={},n&&n.query&&(this.query=n.query),this.io.autoConnect&&this.open()}o(p.prototype),p.prototype.subEvents=function(){if(!this.subs){var e=this.io;this.subs=[s(e,"open",a(this,"onopen")),s(e,"packet",a(this,"onpacket")),s(e,"close",a(this,"onclose"))]}},p.prototype.open=p.prototype.connect=function(){return this.connected||(this.subEvents(),this.io.reconnecting||this.io.open(),"open"===this.io.readyState&&this.onopen(),this.emit("connecting")),this},p.prototype.send=function(){var e=r(arguments);return e.unshift("message"),this.emit.apply(this,e),this},p.prototype.emit=function(e){if(l.hasOwnProperty(e))return h.apply(this,arguments),this;var t=r(arguments),n={type:(void 0!==this.flags.binary?this.flags.binary:d(t))?i.BINARY_EVENT:i.EVENT,data:t,options:{}};return n.options.compress=!this.flags||!1!==this.flags.compress,"function"==typeof t[t.length-1]&&(c("emitting packet with ack id %d",this.ids),this.acks[this.ids]=t.pop(),n.id=this.ids++),this.connected?this.packet(n):this.sendBuffer.push(n),this.flags={},this},p.prototype.packet=function(e){e.nsp=this.nsp,this.io.packet(e)},p.prototype.onopen=function(){if(c("transport is open - connecting"),"/"!==this.nsp)if(this.query){var e="object"==typeof this.query?u.encode(this.query):this.query;c("sending connect packet with query %s",e),this.packet({type:i.CONNECT,query:e})}else this.packet({type:i.CONNECT})},p.prototype.onclose=function(e){c("close (%s)",e),this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",e)},p.prototype.onpacket=function(e){var t=e.nsp===this.nsp,n=e.type===i.ERROR&&"/"===e.nsp;if(t||n)switch(e.type){case i.CONNECT:this.onconnect();break;case i.EVENT:case i.BINARY_EVENT:this.onevent(e);break;case i.ACK:case i.BINARY_ACK:this.onack(e);break;case i.DISCONNECT:this.ondisconnect();break;case i.ERROR:this.emit("error",e.data)}},p.prototype.onevent=function(e){var t=e.data||[];c("emitting event %j",t),null!=e.id&&(c("attaching ack callback to event"),t.push(this.ack(e.id))),this.connected?h.apply(this,t):this.receiveBuffer.push(t)},p.prototype.ack=function(e){var t=this,n=!1;return function(){if(!n){n=!0;var o=r(arguments);c("sending ack %j",o),t.packet({type:d(o)?i.BINARY_ACK:i.ACK,id:e,data:o})}}},p.prototype.onack=function(e){var t=this.acks[e.id];"function"==typeof t?(c("calling ack %s with %j",e.id,e.data),t.apply(this,e.data),delete this.acks[e.id]):c("bad ack %s",e.id)},p.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emit("connect"),this.emitBuffered()},p.prototype.emitBuffered=function(){var e;for(e=0;e<this.receiveBuffer.length;e++)h.apply(this,this.receiveBuffer[e]);for(this.receiveBuffer=[],e=0;e<this.sendBuffer.length;e++)this.packet(this.sendBuffer[e]);this.sendBuffer=[]},p.prototype.ondisconnect=function(){c("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")},p.prototype.destroy=function(){if(this.subs){for(var e=0;e<this.subs.length;e++)this.subs[e].destroy();this.subs=null}this.io.destroy(this)},p.prototype.close=p.prototype.disconnect=function(){return this.connected&&(c("performing disconnect (%s)",this.nsp),this.packet({type:i.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this},p.prototype.compress=function(e){return this.flags.compress=e,this},p.prototype.binary=function(e){return this.flags.binary=e,this}},"./node_modules/socket.io-client/lib/url.js":function(e,t,n){var i=n("./node_modules/parseuri/index.js"),o=n("./node_modules/debug/src/browser.js")("socket.io-client:url");e.exports=function(e,t){var n=e;t=t||"undefined"!=typeof location&&location,null==e&&(e=t.protocol+"//"+t.host),"string"==typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?t.protocol+e:t.host+e),/^(https?|wss?):\/\//.test(e)||(o("protocol-less url %s",e),e=void 0!==t?t.protocol+"//"+e:"https://"+e),o("parse %s",e),n=i(e)),n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/";var r=-1!==n.host.indexOf(":")?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+r+":"+n.port,n.href=n.protocol+"://"+r+(t&&t.port===n.port?"":":"+n.port),n}},"./node_modules/socket.io-parser/binary.js":function(e,t,n){var i=n("./node_modules/isarray/index.js"),o=n("./node_modules/socket.io-parser/is-buffer.js"),r=Object.prototype.toString,s="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===r.call(Blob),a="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===r.call(File);function c(e,t){if(!e)return e;if(o(e)){var n={_placeholder:!0,num:t.length};return t.push(e),n}if(i(e)){for(var r=new Array(e.length),s=0;s<e.length;s++)r[s]=c(e[s],t);return r}if("object"==typeof e&&!(e instanceof Date)){for(var a in r={},e)r[a]=c(e[a],t);return r}return e}function u(e,t){if(!e)return e;if(e&&e._placeholder)return t[e.num];if(i(e))for(var n=0;n<e.length;n++)e[n]=u(e[n],t);else if("object"==typeof e)for(var o in e)e[o]=u(e[o],t);return e}t.deconstructPacket=function(e){var t=[],n=e.data,i=e;return i.data=c(n,t),i.attachments=t.length,{packet:i,buffers:t}},t.reconstructPacket=function(e,t){return e.data=u(e.data,t),e.attachments=void 0,e},t.removeBlobs=function(e,t){var n=0,r=e;!function e(c,u,d){if(!c)return c;if(s&&c instanceof Blob||a&&c instanceof File){n++;var l=new FileReader;l.onload=function(){d?d[u]=this.result:r=this.result,--n||t(r)},l.readAsArrayBuffer(c)}else if(i(c))for(var h=0;h<c.length;h++)e(c[h],h,c);else if("object"==typeof c&&!o(c))for(var p in c)e(c[p],p,c)}(r),n||t(r)}},"./node_modules/socket.io-parser/index.js":function(e,t,n){var i=n("./node_modules/debug/src/browser.js")("socket.io-parser"),o=n("./node_modules/component-emitter/index.js"),r=n("./node_modules/socket.io-parser/binary.js"),s=n("./node_modules/isarray/index.js"),a=n("./node_modules/socket.io-parser/is-buffer.js");function c(){}t.protocol=4,t.types=["CONNECT","DISCONNECT","EVENT","ACK","ERROR","BINARY_EVENT","BINARY_ACK"],t.CONNECT=0,t.DISCONNECT=1,t.EVENT=2,t.ACK=3,t.ERROR=4,t.BINARY_EVENT=5,t.BINARY_ACK=6,t.Encoder=c,t.Decoder=l;var u=t.ERROR+'"encode error"';function d(e){var n=""+e.type;if(t.BINARY_EVENT!==e.type&&t.BINARY_ACK!==e.type||(n+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(n+=e.nsp+","),null!=e.id&&(n+=e.id),null!=e.data){var o=function(e){try{return JSON.stringify(e)}catch(e){return!1}}(e.data);if(!1===o)return u;n+=o}return i("encoded %j as %s",e,n),n}function l(){this.reconstructor=null}function h(e){this.reconPack=e,this.buffers=[]}function p(e){return{type:t.ERROR,data:"parser error: "+e}}c.prototype.encode=function(e,n){i("encoding packet %j",e),t.BINARY_EVENT===e.type||t.BINARY_ACK===e.type?function(e,t){r.removeBlobs(e,(function(e){var n=r.deconstructPacket(e),i=d(n.packet),o=n.buffers;o.unshift(i),t(o)}))}(e,n):n([d(e)])},o(l.prototype),l.prototype.add=function(e){var n;if("string"==typeof e)n=function(e){var n=0,o={type:Number(e.charAt(0))};if(null==t.types[o.type])return p("unknown packet type "+o.type);if(t.BINARY_EVENT===o.type||t.BINARY_ACK===o.type){for(var r=n+1;"-"!==e.charAt(++n)&&n!=e.length;);var a=e.substring(r,n);if(a!=Number(a)||"-"!==e.charAt(n))throw new Error("Illegal attachments");o.attachments=Number(a)}if("/"===e.charAt(n+1)){for(r=n+1;++n&&","!==(u=e.charAt(n))&&n!==e.length;);o.nsp=e.substring(r,n)}else o.nsp="/";var c=e.charAt(n+1);if(""!==c&&Number(c)==c){for(r=n+1;++n;){var u;if(null==(u=e.charAt(n))||Number(u)!=u){--n;break}if(n===e.length)break}o.id=Number(e.substring(r,n+1))}if(e.charAt(++n)){var d=function(e){try{return JSON.parse(e)}catch(e){return!1}}(e.substr(n));if(!1===d||o.type!==t.ERROR&&!s(d))return p("invalid payload");o.data=d}return i("decoded %s as %j",e,o),o}(e),t.BINARY_EVENT===n.type||t.BINARY_ACK===n.type?(this.reconstructor=new h(n),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",n)):this.emit("decoded",n);else{if(!a(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");(n=this.reconstructor.takeBinaryData(e))&&(this.reconstructor=null,this.emit("decoded",n))}},l.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},h.prototype.takeBinaryData=function(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){var t=r.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null},h.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]}},"./node_modules/socket.io-parser/is-buffer.js":function(e,t,n){(function(t){e.exports=function(e){return n&&t.isBuffer(e)||i&&(e instanceof ArrayBuffer||function(e){return"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer}(e))};var n="function"==typeof t&&"function"==typeof t.isBuffer,i="function"==typeof ArrayBuffer}).call(this,n("./node_modules/node-libs-browser/node_modules/buffer/index.js").Buffer)},"./node_modules/split-on-first/index.js":function(e,t,n){"use strict";e.exports=(e,t)=>{if("string"!=typeof e||"string"!=typeof t)throw new TypeError("Expected the arguments to be of type `string`");if(""===t)return[e];const n=e.indexOf(t);return-1===n?[e]:[e.slice(0,n),e.slice(n+t.length)]}},"./node_modules/strict-uri-encode/index.js":function(e,t,n){"use strict";e.exports=e=>encodeURIComponent(e).replace(/[!'()*]/g,(e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`))},"./node_modules/to-array/index.js":function(e,t){e.exports=function(e,t){for(var n=[],i=(t=t||0)||0;i<e.length;i++)n[i-t]=e[i];return n}},"./node_modules/webpack/buildin/global.js":function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},"./node_modules/yeast/index.js":function(e,t,n){"use strict";var i,o="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),r={},s=0,a=0;function c(e){var t="";do{t=o[e%64]+t,e=Math.floor(e/64)}while(e>0);return t}function u(){var e=c(+new Date);return e!==i?(s=0,i=e):e+"."+c(s++)}for(;a<64;a++)r[o[a]]=a;u.encode=c,u.decode=function(e){var t=0;for(a=0;a<e.length;a++)t=64*t+r[e.charAt(a)];return t},e.exports=u},"./package.json":function(e){e.exports=JSON.parse('{"name":"skyway-js","version":"4.4.2","description":"The official JavaScript SDK for SkyWay","main":"dist/skyway.js","types":"skyway-js.d.ts","scripts":{"test":"karma start ./karma.conf.js","clean":"del ./dist","lint":"eslint .","build":"NODE_ENV=production webpack","dev":"webpack -w"},"repository":{"type":"git","url":"git+https://github.com/skyway/skyway-js-sdk"},"files":["dist/skyway.js","skyway-js.d.ts","LICENSE","CHANGELOG.md","README.md"],"author":"NTT Communications Corp.","license":"Apache-2.0","devDependencies":{"babel-loader":"7.1.5","babel-plugin-espower":"2.4.0","babel-plugin-istanbul":"4.1.6","babel-preset-es2015":"^6.24.1","del-cli":"^2.0.0","eslint":"^6.1.0","eslint-config-prettier":"^6.0.0","eslint-plugin-prettier":"^3.1.0","inject-loader":"^4.0.1","karma":"^4.2.0","karma-chrome-launcher":"^3.0.0","karma-coverage":"^1.1.2","karma-mocha":"^1.3.0","karma-mocha-reporter":"^2.2.5","karma-sourcemap-loader":"^0.3.7","karma-webpack":"^4.0.2","mocha":"^6.2.0","power-assert":"^1.6.1","prettier":"^1.18.2","sinon":"^7.3.2","webpack":"^4.38.0","webpack-cli":"^3.3.6"},"dependencies":{"@jitsi/sdp-interop":"^0.1.13","@types/node":"^12.6.8","detect-browser":"^4.6.0","enum":"^3.0.4","events":"^3.0.0","js-binarypack":"0.0.9","object-sizeof":"^1.4.0","query-string":"^6.8.2","sdp-transform":"^2.11.0","socket.io-client":"^2.2.0","socket.io-parser":"~3.3.0"}}')},"./src/peer.js":function(e,t,n){"use strict";n.r(t);var i=n("./node_modules/events/events.js"),o=n.n(i),r=n("./node_modules/enum/lib/enum.js"),s=n("./node_modules/socket.io-client/lib/index.js"),a=n.n(s),c=n("./node_modules/query-string/index.js"),u=n.n(c),d={DISPATCHER_HOST:"dispatcher.webrtc.ecl.ntt.com",DISPATCHER_PORT:443,DISPATCHER_SECURE:!0,DISPATCHER_TIMEOUT:1e4,TURN_HOST:"turn.webrtc.ecl.ntt.com",TURN_PORT:443,MESSAGE_TYPES:{CLIENT:new r.default(["SEND_OFFER","SEND_ANSWER","SEND_CANDIDATE","SEND_LEAVE","ROOM_JOIN","ROOM_LEAVE","ROOM_GET_LOGS","ROOM_GET_USERS","ROOM_SEND_DATA","SFU_GET_OFFER","SFU_ANSWER","SFU_CANDIDATE","PING","UPDATE_CREDENTIAL","SEND_FORCE_CLOSE"]),SERVER:new r.default(["OPEN","ERROR","OFFER","ANSWER","CANDIDATE","LEAVE","AUTH_EXPIRES_IN","ROOM_LOGS","ROOM_USERS","ROOM_DATA","ROOM_USER_JOIN","ROOM_USER_LEAVE","SFU_OFFER","FORCE_CLOSE"])},maxChunkSize:16300,maxDataSize:20971520,minBroadcastIntervalMs:100,maxNumberOfAttempts:10,reconnectionAttempts:2,numberServersToTry:3,sendInterval:1,pingInterval:25e3,defaultConfig:{iceServers:[{urls:"stun:stun.webrtc.ecl.ntt.com:3478",url:"stun:stun.webrtc.ecl.ntt.com:3478"}],iceTransportPolicy:"all"}};const l="SkyWay: ",h=new r.default({NONE:0,ERROR:1,WARN:2,FULL:3});var p=new class{constructor(){this._logLevel=h.NONE.value,this.LOG_LEVELS=h}setLogLevel(e){switch(e.value&&(e=e.value),parseInt(e,10)){default:this._logLevel=h.NONE.value;break;case 1:this._logLevel=h.ERROR.value;break;case 2:this._logLevel=h.WARN.value;break;case 3:this._logLevel=h.FULL.value}}warn(...e){this._logLevel>=h.WARN.value&&console.warn(l,...e)}error(...e){this._logLevel>=h.ERROR.value&&console.error(l,...e)}log(...e){this._logLevel>=h.FULL.value&&console.log(l,...e)}},f=n("./node_modules/detect-browser/index.js"),m=function(e){return!e||/^[A-Za-z0-9_-]+(?:[ _-][A-Za-z0-9]+)*$/.exec(e)},g=function(e){return!e||/^[a-z0-9]{8}(-[a-z0-9]{4}){3}-[a-z0-9]{12}$/.exec(e)},y=function(){return(Math.random().toString(36)+"0000000000000000000").substr(2,16)},v=function(){return Math.random().toString(36).substr(2)},_=function(e){const t=e.reduce(((e,t)=>e+t.byteLength),0),n=new Uint8Array(t);let i=0;for(const t of e)n.set(new Uint8Array(t),i),i+=t.byteLength;return n.buffer},b=function(e,t){const n=new FileReader;n.onload=e=>{t(e.target.result)},n.readAsArrayBuffer(e)},S=function(){const{name:e,version:t}=Object(f.detect)(),[n,i,o]=t.split(".").map((e=>parseInt(e)));return{name:e,major:n,minor:i,patch:o}},w=function(){const{name:e}=Object(f.detect)();return("safari"===e||"ios"===e)&&!RTCRtpTransceiver.prototype.hasOwnProperty("currentDirection")},E=n("./package.json");class C extends o.a{constructor(e,t){if(super(),this._isOpen=!1,this._isPeerIdSet=!1,this._queue=[],this._io=null,this._key=e,this._reconnectAttempts=0,t.host&&t.port){const e=t.secure?"https://":"http://";this.signalingServerUrl=`${e}${t.host}:${t.port}`}else{const e=t.dispatcherHost||d.DISPATCHER_HOST,n=t.dispatcherPort||d.DISPATCHER_PORT,i=t.dispatcherSecure||d.DISPATCHER_SECURE?"https://":"http://";this._dispatcherUrl=`${i}${e}:${n}/signaling`}}get isOpen(){return Boolean(this._io&&this._io.connected&&this._isOpen)}async start(e,t,n){let i=`apiKey=${this._key}&token=${t}&platform=javascript&sdk_version=${E.version}`;if(e&&(i+=`&peerId=${e}`,this._isPeerIdSet=!0),n&&(i+=`&credential=${encodeURIComponent(JSON.stringify(n))}`),this._dispatcherUrl)try{this.signalingServerUrl=await this._fetchSignalingServerUrlWithRetry()}catch(e){return void this.emit("error",e)}const o=S(),r=("ios"===o.name||"safari"===o.name)&&o.major>=15?["polling"]:["polling","websocket"];this._io=a()(this.signalingServerUrl,{"force new connection":!0,query:i,reconnectionAttempts:d.reconnectionAttempts,transports:r}),this._io.on("reconnect_failed",(()=>{this._stopPings(),this._connectToNewServer()})),this._io.on("error",(e=>{p.error(e)})),this._setupMessageHandlers()}async _connectToNewServer(){if(this._reconnectAttempts>=d.numberServersToTry)this.emit("error","Could not connect to server.");else{try{this.signalingServerUrl=await this._fetchSignalingServerUrlWithRetry()}catch(e){return void this.emit("error",e)}this._io.io.uri=this.signalingServerUrl,this._io.connect(),this._reconnectAttempts++}}async _fetchSignalingServerUrlWithRetry(){for(let e=0;e<d.maxNumberOfAttempts;e++){const e=await this._fetchSignalingServer().catch((e=>{p.warn(e)}));if(e&&e.port&&e.host&&(!this.signalingServerUrl||-1===this.signalingServerUrl.indexOf(e.host)))return`${e.secure?"https://":"http://"}${e.host}:${e.port}`}throw new Error("Could not get signaling server url.")}_fetchSignalingServer(){return new Promise(((e,t)=>{const n=new XMLHttpRequest;n.timeout=d.DISPATCHER_TIMEOUT,n.open("GET",this._dispatcherUrl,!0),n.onerror=()=>{t(new Error("There was a problem with the request for the dispatcher. Check your peer options and network connections."))},n.onabort=()=>{t(new Error("The request for the dispatcher was aborted."))},n.ontimeout=()=>{t(new Error("The request for the dispatcher timed out. Check your firewall, network speed, SkyWay failure information"))},n.onload=()=>{if(200===n.status)try{const i=JSON.parse(n.responseText);if(i&&i.domain)return void e({host:i.domain,port:443,secure:!0});t(new Error("The dispatcher server returned an invalid JSON response. have no signaling server domain in JSON."))}catch(e){t(new Error("The dispatcher server returned an invalid JSON response."))}else t(new Error("Connection failed. Unexpected response: "+n.status))},n.send(null)}))}send(e,t){e?this.isOpen?!0===this._io.connected&&this._io.emit(e,t):this._queue.push({type:e,message:t}):this._io.emit("error","Invalid message")}close(){this.isOpen&&(this._stopPings(),this._io.disconnect(),this._isOpen=!1)}reconnect(){this._io.connect()}updateCredential(e){const t=u.a.parse(this._io.io.opts.query);t.credential?t.credential=encodeURIComponent(JSON.stringify(e)):p.warn("Adding a credential when one wasn't specified before."),this._io.io.opts.query=u.a.stringify(t),this.send(d.MESSAGE_TYPES.CLIENT.UPDATE_CREDENTIAL.key,e)}_setupMessageHandlers(){d.MESSAGE_TYPES.SERVER.enums.forEach((e=>{e.key===d.MESSAGE_TYPES.SERVER.OPEN.key?this._io.on(e.key,(t=>{t&&t.peerId&&(this._isPeerIdSet||(this._io.io.opts.query+=`&peerId=${t.peerId}`,this._isPeerIdSet=!0),this._reconnectAttempts=0,this._startPings(),this._sendQueuedMessages(),this._isOpen||(this._isOpen=!0,this.emit(e.key,t)))})):this._io.on(e.key,(t=>{this.emit(e.key,t)}))}))}_sendQueuedMessages(){for(const e of this._queue)this.send(e.type,e.message);this._queue=[]}_startPings(){this._pingIntervalId||(this._pingIntervalId=setInterval((()=>{this.send(d.MESSAGE_TYPES.CLIENT.PING.key)}),d.pingInterval))}_stopPings(){clearInterval(this._pingIntervalId),this._pingIntervalId=void 0}}var k=C,T=n("./node_modules/sdp-transform/lib/index.js"),A=n.n(T),R=n("./node_modules/@jitsi/sdp-interop/lib/index.js"),N=new class{unifiedToPlanB(e){const t=(new R.Interop).toPlanB(e).sdp,n=new Set,i=/a=ssrc:\d+ msid:(\w+)/g;let o;for(;o=i.exec(t);)n.add(o[1]);const r=t.replace("a=msid-semantic:WMS *",`a=msid-semantic:WMS ${Array.from(n).join(" ")}`);return new RTCSessionDescription({type:"offer",sdp:r})}addVideoBandwidth(e,t){return this._validateBandwidth(t),this._addBandwidth(e,t,"video")}addAudioBandwidth(e,t){return this._validateBandwidth(t),this._addBandwidth(e,t,"audio")}filterVideoCodec(e,t){return this._filterCodec(e,t,"video")}filterAudioCodec(e,t){return this._filterCodec(e,t,"audio")}ensureUnifiedPlan(e){return e.split("\r\n").map((e=>e.startsWith("a=msid-semantic")?"a=msid-semantic:WMS *":e)).join("\r\n")}_filterCodec(e,t,n){if(void 0===t)throw new Error("codec is not passed");const i=A.a.parse(e);return i.media=i.media.map((e=>{if(e.type===n){e.rtp=e.rtp.filter((e=>e.codec===t));const n=e.rtp.reduce(((e,t)=>[...e,t.payload]),[]);if(0===e.rtp.length)throw new Error(`${t} does not exist`);e.fmtp&&(e.fmtp=e.fmtp.filter((e=>n.includes(e.payload)))),e.rtcpFb&&(e.rtcpFb=e.rtcpFb.filter((e=>n.includes(e.payload)))),e.payloads=n.join(" ")}return e})),A.a.write(i)}_addBandwidth(e,t,n){const i=A.a.parse(e);return i.media=i.media.map((e=>(e.type===n&&(e.bandwidth=[{type:"AS",limit:t.toString()},{type:"TIAS",limit:(1e3*t).toString()}]),e))),A.a.write(i)}_validateBandwidth(e){if(void 0===e)throw new Error("bandwidth is not passed");if(!/^\d+$/.test(e))throw new Error(`${e} is not a number`)}};const I=new r.default(["addStream","dcCreated","offerCreated","answerCreated","iceCandidate","iceConnectionFailed","negotiationNeeded","error"]);class x extends o.a{constructor(){super(),this._offerQueue=[],this._isExpectingAnswer=!1,this._isNegotiationAllowed=!0,this._isExecutingHandleOffer=!1,this.hasRemoteDescription=!1}async startConnection(e={}){if(this._pc=this._createPeerConnection(e.pcConfig),this._setupPCListeners(),this.originator=e.originator,this._audioBandwidth=e.audioBandwidth,this._videoBandwidth=e.videoBandwidth,this._audioCodec=e.audioCodec,this._videoCodec=e.videoCodec,this._type=e.type,"media"===this._type)if(e.stream){const t=e.stream.getVideoTracks(),n=e.stream.getAudioTracks(),i=this._getReceiveOnlyState(e);t.length>0?t.forEach((t=>this._pc.addTrack(t,e.stream))):i.video&&this._pc.addTransceiver("video",{direction:"recvonly"}),n.length>0?n.forEach((t=>this._pc.addTrack(t,e.stream))):i.audio&&this._pc.addTransceiver("audio",{direction:"recvonly"})}else this.originator&&(this._pc.addTransceiver("audio",{direction:"recvonly"}),this._pc.addTransceiver("video",{direction:"recvonly"}));if(this.originator){if("data"===this._type){const t=e.label||"",n=e.dcInit||{},i=this._pc.createDataChannel(t,n);this.emit(x.EVENTS.dcCreated.key,i)}}else await this.handleOffer(e.offer)}replaceStream(e){if(!this._pc)return;this._isNegotiationAllowed=!0;const t=this,n=e.getVideoTracks(),i=e.getAudioTracks(),o=this._pc.getSenders(),r=o.find((e=>e.track&&"video"===e.track.kind)),s=o.find((e=>e.track&&"audio"===e.track.kind));function a(e,n,i){void 0===n&&void 0===e||(void 0!==n?void 0!==e?e.track.id!==n.id&&e.replaceTrack(n):t._pc.addTrack(n,i):t._pc.removeTrack(e))}a(r,n[0],e),a(s,i[0],e)}async handleOffer(e){if(this._lastOffer&&e&&this._lastOffer.sdp===e.sdp)return;if(this._isNegotiationAllowed=!0,"have-remote-offer"===this._pc.signalingState||this._isExecutingHandleOffer)return void this._offerQueue.push(e);let t;this._lastOffer=e,this._isExecutingHandleOffer=!0;try{await this._setRemoteDescription(e),t=await this._makeAnswerSdp().catch((e=>p.error(e)))}finally{this._isExecutingHandleOffer=!1}if("stable"===this._pc.signalingState){const e=this._offerQueue.shift();e&&this.handleOffer(e)}this.emit(x.EVENTS.answerCreated.key,t)}async handleAnswer(e){this._isNegotiationAllowed=!0,this._isExpectingAnswer?(await this._setRemoteDescription(e),this._isExpectingAnswer=!1):this._pc.onnegotiationneeded&&this._pc.onnegotiationneeded()}async handleCandidate(e){await this._pc.addIceCandidate(new RTCIceCandidate(e)).then((()=>p.log("Successfully added ICE candidate"))).catch((e=>p.error("Failed to add ICE candidate",e)))}cleanup(){p.log("Cleaning up PeerConnection"),!this._pc||"closed"===this._pc.readyState&&"closed"===this._pc.signalingState||this._pc.close(),this._pc=null}_createPeerConnection(e={}){return p.log("Creating RTCPeerConnection"),e.sdpSemantics="unified-plan",new RTCPeerConnection(e)}_setupPCListeners(){const e=this._pc;e.ontrack=e=>{p.log("Received remote media stream track"),e.streams.forEach((e=>{this.emit(x.EVENTS.addStream.key,e)}))},e.ondatachannel=e=>{p.log("Received data channel");const t=e.channel;this.emit(x.EVENTS.dcCreated.key,t)},e.onicecandidate=e=>{e.candidate&&""!==e.candidate.candidate?(p.log("Generated ICE candidate for:",e.candidate),this.emit(x.EVENTS.iceCandidate.key,e.candidate)):p.log("ICE candidates gathering complete")},e.oniceconnectionstatechange=()=>{switch(e.iceConnectionState){case"completed":p.log("iceConnectionState is completed"),e.onicecandidate=()=>{};break;case"disconnected":p.log("iceConnectionState is disconnected, trying reconnect by browser");break;case"failed":p.log("iceConnectionState is failed, closing connection"),this.emit(x.EVENTS.iceConnectionFailed.key);break;default:p.log(`iceConnectionState is ${e.iceConnectionState}`)}},e.onconnectionstatechange=()=>{p.log(`connectionState is ${e.connectionState}`),"failed"===e.connectionState&&"disconnected"===e.iceConnectionState&&(p.log("connectionState is failed, closing connection"),this.emit(x.EVENTS.iceConnectionFailed.key))},e.onnegotiationneeded=async()=>{if(p.log("`negotiationneeded` triggered"),"stable"===e.signalingState&&this._isNegotiationAllowed&&(this._isNegotiationAllowed=!1,this.originator)){const e=await this._makeOfferSdp();this._setLocalDescription(e),this.emit(x.EVENTS.negotiationNeeded.key)}},e.onsignalingstatechange=()=>{if(p.log(`signalingState is ${e.signalingState}`),"stable"===e.signalingState&&!this._isExecutingHandleOffer){const e=this._offerQueue.shift();e&&this.handleOffer(e)}}}async _makeOfferSdp(){let e;try{e=await this._pc.createOffer()}catch(e){throw e.type="webrtc",p.error(e),this.emit(x.EVENTS.error.key,e),p.log("Failed to createOffer, ",e),e}return p.log("Created offer."),this._audioBandwidth&&(e.sdp=N.addAudioBandwidth(e.sdp,this._audioBandwidth)),this._videoBandwidth&&(e.sdp=N.addVideoBandwidth(e.sdp,this._videoBandwidth)),this._audioCodec&&(e.sdp=N.filterAudioCodec(e.sdp,this._audioCodec)),this._videoCodec&&(e.sdp=N.filterVideoCodec(e.sdp,this._videoCodec)),e}async _makeAnswerSdp(){let e;try{e=await this._pc.createAnswer()}catch(e){throw e.type="webrtc",p.error(e),this.emit(x.EVENTS.error.key,e),p.log("Failed to createAnswer, ",e),e}p.log("Created answer."),this._audioBandwidth&&(e.sdp=N.addAudioBandwidth(e.sdp,this._audioBandwidth)),this._videoBandwidth&&(e.sdp=N.addVideoBandwidth(e.sdp,this._videoBandwidth)),this._audioCodec&&(e.sdp=N.filterAudioCodec(e.sdp,this._audioCodec)),this._videoCodec&&(e.sdp=N.filterVideoCodec(e.sdp,this._videoCodec));try{await this._pc.setLocalDescription(e)}catch(e){throw e.type="webrtc",p.error(e),this.emit(x.EVENTS.error.key,e),p.log("Failed to setLocalDescription, ",e),e}return p.log("Set localDescription: answer"),p.log(`Setting local description ${JSON.stringify(e.sdp)}`),e}async _setLocalDescription(e){p.log(`Setting local description ${JSON.stringify(e.sdp)}`);try{await this._pc.setLocalDescription(e)}catch(e){throw e.type="webrtc",p.error(e),this.emit(x.EVENTS.error.key,e),p.log("Failed to setLocalDescription, ",e),e}p.log("Set localDescription: offer"),this._isExpectingAnswer=!0,this.emit(x.EVENTS.offerCreated.key,e)}async _setRemoteDescription(e){p.log(`Setting remote description ${JSON.stringify(e)}`);try{await this._pc.setRemoteDescription(new RTCSessionDescription(e)),this.hasRemoteDescription=!0}catch(e){throw e.type="webrtc",p.error(e),this.emit(x.EVENTS.error.key,e),p.log("Failed to setRemoteDescription: ",e),e}p.log("Set remoteDescription:",e.type)}_getReceiveOnlyState(e={}){const t={audio:!1,video:!1},n=e.stream instanceof MediaStream,i=!!n&&0!==e.stream.getAudioTracks().length,o=!!n&&0!==e.stream.getVideoTracks().length;return!1===n&&void 0===e.audioReceiveEnabled&&void 0===e.videoReceiveEnabled?(t.audio=!0,t.video=!0,t):(e.audioReceiveEnabled&&!1===i&&(t.audio=!0),e.videoReceiveEnabled&&!1===o&&(t.video=!0),!1===e.audioReceiveEnabled&&i&&p.warn("Option audioReceiveEnabled will be treated as true, because passed stream has MediaStreamTrack(kind = audio)"),!1===e.videoReceiveEnabled&&o&&p.warn("Option videoReceiveEnabled will be treated as true, because passed stream has MediaStreamTrack(kind = video)"),t)}static get EVENTS(){return I}}var O=x;const M=new r.default(["candidate","offer","answer","close","forceClose"]);class P extends o.a{constructor(e,t){if(super(),t=t||{},this.constructor===P)throw new TypeError("Cannot construct Connection instances directly");this._options=t,this.open=!1,this.type=void 0,this.metadata=this._options.metadata,this.remoteId=e,this._negotiator=new O,this._idPrefix="c_",this._randomIdSuffix=v(),this._setupNegotiatorMessageHandlers()}get id(){return this._options.connectionId||this._idPrefix+this._randomIdSuffix}async handleAnswer(e){this._pcAvailable?(await this._negotiator.handleAnswer(e.answer),this.open=!0,this._handleQueuedMessages()):(p.log(`Queuing ANSWER message in ${this.id} from ${this.remoteId}`),this._queuedMessages.push({type:d.MESSAGE_TYPES.SERVER.ANSWER.key,payload:e}))}handleCandidate(e){!this._negotiator.originator||this._negotiator.hasRemoteDescription?this._pcAvailable?this._negotiator.handleCandidate(e.candidate):(p.log(`Queuing CANDIDATE message in ${this.id} from ${this.remoteId}`),this._queuedMessages.push({type:d.MESSAGE_TYPES.SERVER.CANDIDATE.key,payload:e})):this._queuedMessages.push({type:d.MESSAGE_TYPES.SERVER.CANDIDATE.key,payload:e})}updateOffer(e){this.open?this._negotiator.handleOffer(e.offer):this._options.payload=e}getPeerConnection(){return this.open?this._negotiator._pc:null}_handleQueuedMessages(){for(const e of this._queuedMessages)switch(e.type){case d.MESSAGE_TYPES.SERVER.ANSWER.key:this.handleAnswer(e.payload);break;case d.MESSAGE_TYPES.SERVER.CANDIDATE.key:this.handleCandidate(e.payload);break;default:p.warn("Unrecognized message type:",e.type,"from peer:",this.remoteId)}this._queuedMessages=[]}close(e){this.open&&(this.open=!1,this._negotiator.cleanup(),this.emit(P.EVENTS.close.key),e?this.emit(P.EVENTS.forceClose.key):void 0===e&&p.warn("Default value of the forceClose parameter will change false to true from future versions."))}_setupNegotiatorMessageHandlers(){this._negotiator.on(O.EVENTS.answerCreated.key,(e=>{const t={answer:e,dst:this.remoteId,connectionId:this.id,connectionType:this.type};this.emit(P.EVENTS.answer.key,t)})),this._negotiator.on(O.EVENTS.offerCreated.key,(e=>{const t={offer:e,dst:this.remoteId,connectionId:this.id,connectionType:this.type,metadata:this.metadata};this.serialization&&(t.serialization=this.serialization),this.label&&(t.label=this.label),this.dcInit&&(t.dcInit=this.dcInit),this.emit(P.EVENTS.offer.key,t)})),this._negotiator.on(O.EVENTS.iceCandidate.key,(e=>{const t={candidate:e,dst:this.remoteId,connectionId:this.id,connectionType:this.type};this.emit(P.EVENTS.candidate.key,t)})),this._negotiator.on(O.EVENTS.iceConnectionFailed.key,(()=>{this.close(!1)}))}get peer(){return p.warn(`${this.constructor.name}.peer is deprecated and may be removed from a future version. Please use ${this.constructor.name}.remoteId instead.`),this.remoteId}static get EVENTS(){return M}}var B=P,L=n("./node_modules/js-binarypack/lib/binarypack.js"),j=n.n(L),D=n("./node_modules/object-sizeof/index.js"),U=n.n(D);const F=new r.default(["open","data","error"]);F.extend(B.EVENTS.enums);const z=new r.default(["binary","binary-utf8","json","none"]);class V extends B{constructor(e,t){if(super(e,t),this._idPrefix="dc_",this.type="data",this._isOnOpenCalled=!1,this.label=this._options.label||this.id,this.dcInit=this._options.dcInit||{},this.serialization=V.SERIALIZATIONS.binary.key,this._options.serialization){if(!V.SERIALIZATIONS.get(this._options.serialization))throw new Error("Invalid serialization");this.serialization=this._options.serialization,this._isUnreliableDCInit(this.dcInit)&&(p.warn("You can not specify serialization with unreliable mode enabled."),this.serialization=V.SERIALIZATIONS.binary.key)}this._sendBuffer=[],this._receivedData={},this._queuedMessages=this._options.queuedMessages||[],this._negotiator.on(O.EVENTS.dcCreated.key,(e=>{this._dc=e,this._dc.binaryType="arraybuffer",this._setupMessageHandlers(),this._isOnOpenCalled||"open"!==this._dc.readyState||this._dc.onopen()})),this._options.payload&&(this._options.payload.pcConfig=this._options.pcConfig)}async startConnection(){await this._negotiator.startConnection(this._options.payload||{originator:!0,type:"data",label:this.label,dcInit:this.dcInit,pcConfig:this._options.pcConfig}),this._pcAvailable=!0,this._handleQueuedMessages()}_setupMessageHandlers(){this._dc.onopen=()=>{this._isOnOpenCalled||(p.log("Data channel connection success"),this.open=!0,this._isOnOpenCalled=!0,this.emit(V.EVENTS.open.key))},this._dc.onmessage=e=>{this._handleDataMessage(e)},this._dc.onclose=()=>{p.log("DataChannel closed for:",this.id),this.close(!1)},this._dc.onerror=e=>{p.error(e)}}_handleDataMessage(e){if(this.serialization===V.SERIALIZATIONS.none.key)return void this.emit(V.EVENTS.data.key,e.data);if(this.serialization===V.SERIALIZATIONS.json.key)return void this.emit(V.EVENTS.data.key,JSON.parse(e.data));const t=j.a.unpack(e.data);let n=this._receivedData[t.id];if(n||(n=this._receivedData[t.id]={size:t.size,type:t.type,name:t.name,mimeType:t.mimeType,totalParts:t.totalParts,parts:new Array(t.totalParts),receivedParts:0}),n.receivedParts++,n.parts[t.index]=t.data,n.receivedParts===n.totalParts){delete this._receivedData[t.id];const e=_(n.parts),i=j.a.unpack(e);let o;switch(n.type){case"Blob":o=new Blob([new Uint8Array(i)],{type:n.mimeType});break;case"File":o=new File([new Uint8Array(i)],n.name,{type:n.mimeType});break;default:o=i}this.emit(V.EVENTS.data.key,o)}}send(e){if(!this.open)return void this.emit(V.EVENTS.error.key,new Error("Connection is not open. You should listen for the `open` event before sending messages."));if(null==e)return;if(this.serialization===V.SERIALIZATIONS.none.key)return this._sendBuffer.push(e),void this._startSendLoop();if(this.serialization===V.SERIALIZATIONS.json.key)return this._sendBuffer.push(JSON.stringify(e)),void this._startSendLoop();const t=j.a.pack(e),n=t.size,i=e.constructor.name,o={id:y(),type:i,size:n,totalParts:0};"File"===i&&(o.name=e.name),e instanceof Blob&&(o.mimeType=e.type);const r=d.maxChunkSize-U()(o),s=Math.ceil(n/r);o.totalParts=s;for(let e=0;e<s;e++){const n=t.slice(e*r,(e+1)*r);o.index=e,o.data=n,b(j.a.pack(o),(e=>{this._sendBuffer.push(e),this._startSendLoop()}))}}close(e){const t=e=>{super.close(e),this._isOnOpenCalled=!1};this._dc?(this._dc.onclose=()=>{p.log("DataChannel closed for:",this.id),t(e)},"closing"!==this._dc.readyState&&("closed"===this._dc.readyState?t(e):this._dc.close())):t(e)}_startSendLoop(){this.sendInterval||(this.sendInterval=setInterval((()=>{const e=this._sendBuffer.shift();try{this._dc.send(e)}catch(t){this._sendBuffer.push(e)}0===this._sendBuffer.length&&(clearInterval(this.sendInterval),this.sendInterval=void 0)}),d.sendInterval))}_isUnreliableDCInit(e){return!!e&&("maxRetransmits"in e||"maxPacketLifeTime"in e)}static get SERIALIZATIONS(){return z}static get EVENTS(){return F}}var G=V;const q=new r.default(["stream"]);q.extend(B.EVENTS.enums);class Y extends B{constructor(e,t){super(e,t),this._idPrefix="mc_",this.type="media",this.localStream=this._options.stream,this._queuedMessages=this._options.queuedMessages||[],this._pcAvailable=!1}async startConnection(){this._options.originator&&(await this._negotiator.startConnection({type:"media",stream:this.localStream,originator:this._options.originator,pcConfig:this._options.pcConfig,videoBandwidth:this._options.videoBandwidth,audioBandwidth:this._options.audioBandwidth,videoCodec:this._options.videoCodec,audioCodec:this._options.audioCodec,videoReceiveEnabled:this._options.videoReceiveEnabled,audioReceiveEnabled:this._options.audioReceiveEnabled}),this._pcAvailable=!0,this._handleQueuedMessages())}answer(e,t={}){this.localStream?p.warn("localStream already exists on this MediaConnection. Are you answering a call twice?"):(this._options.payload.stream=e,this.localStream=e,this._negotiator.startConnection({type:"media",stream:this.localStream,originator:!1,offer:this._options.payload.offer,pcConfig:this._options.pcConfig,audioBandwidth:t.audioBandwidth,videoBandwidth:t.videoBandwidth,videoCodec:t.videoCodec,audioCodec:t.audioCodec}),this._pcAvailable=!0,this._handleQueuedMessages(),this.open=!0)}replaceStream(e){this._negotiator.replaceStream(e),this.localStream=e}_setupNegotiatorMessageHandlers(){super._setupNegotiatorMessageHandlers(),this._negotiator.on(O.EVENTS.addStream.key,(e=>{p.log("Receiving stream",e),this.remoteStream&&this.remoteStream.id===e.id||(this.remoteStream=e,this.emit(Y.EVENTS.stream.key,e))}))}static get EVENTS(){return q}}var $=Y,W=n("./node_modules/socket.io-parser/index.js"),H=n.n(W),K=n("./node_modules/has-binary2/index.js"),J=n.n(K);const X=new r.default(["stream","open","close","peerJoin","peerLeave","error","data","log"]),Q=new r.default(["offer","answer","candidate","leave","close","getLog","broadcast"]);class Z extends o.a{constructor(e,t,n={}){if(super(),this.constructor===Z)throw new TypeError("Cannot construct Room instances directly");this.name=e,this._options=n,this._peerId=t,this._localStream=this._options.stream,this._pcConfig=this._options.pcConfig,this.lastSent=0,this.messageQueue=[],this.sendIntervalID=null}validateSendDataSize(e){const t=J()([e]),n={type:t?H.a.BINARY_EVENT:H.a.EVENT,data:[e]};let i;(new H.a.Encoder).encode(n,(e=>{i=t?e[1].byteLength:e[0].length}));const o=d.maxDataSize;if(i>o)throw new Error("The size of data to send must be less than 20 MB");return!0}_sendData(e,t){const n=d.minBroadcastIntervalMs,i=Date.now(),o=i-this.lastsend;if(0==this.messageQueue.length&&o>=n)return this.lastsend=i,void this.emit(t,e);this.messageQueue.push({msg:e,key:t}),null===this.sendIntervalID&&(this.sendIntervalID=setInterval((()=>{if(0===this.messageQueue.length)return clearInterval(this.sendIntervalID),void(this.sendIntervalID=null);const e=this.messageQueue.shift();this.lastsend=Date.now(),this.emit(e.key,e.msg)}),n))}handleData(e){const t={data:e.data,src:e.src};this.emit(Z.EVENTS.data.key,t)}handleLog(e){this.emit(Z.EVENTS.log.key,e)}getLog(){const e={roomName:this.name};this.emit(Z.MESSAGE_EVENTS.getLog.key,e)}static get EVENTS(){return X}static get MESSAGE_EVENTS(){return Q}}var ee=Z;const te=new r.default([]);te.extend(ee.EVENTS.enums);const ne=new r.default(["offerRequest","candidate"]);ne.extend(ee.MESSAGE_EVENTS.enums);class ie extends ee{constructor(e,t,n){super(e,t,n),this.remoteStreams={},this.members=[],this._open=!1,this._msidMap={},this._unknownStreams={},this._negotiator=new O}call(e){e&&(this._localStream=e);const t={roomName:this.name};this.emit(ie.MESSAGE_EVENTS.offerRequest.key,t)}handleOffer(e){let t=e.offer;w()&&(t=N.unifiedToPlanB(t)),this._connectionStarted?this._negotiator.handleOffer(t):(this._negotiator.startConnection({type:"media",stream:this._localStream,pcConfig:this._options.pcConfig,offer:t}),this._setupNegotiatorMessageHandlers(),this._connectionStarted=!0)}_setupNegotiatorMessageHandlers(){this._negotiator.on(O.EVENTS.addStream.key,(e=>{const t=e;if(this._msidMap[t.id]){if(t.peerId=this._msidMap[t.id],t.peerId===this._peerId)return;const e=this.remoteStreams[t.id];if(e&&e.id===t.id)return;this.remoteStreams[t.id]=t,this.emit(ie.EVENTS.stream.key,t),p.log(`Received remote media stream for ${t.peerId} in ${this.name}`)}else this._unknownStreams[t.id]=t})),this._negotiator.on(O.EVENTS.negotiationNeeded.key,(()=>{const e={roomName:this.name};this.emit(ie.MESSAGE_EVENTS.offerRequest.key,e)})),this._negotiator.on(O.EVENTS.answerCreated.key,(e=>{w()||(e.sdp=N.ensureUnifiedPlan(e.sdp));const t={roomName:this.name,answer:e};this.emit(ie.MESSAGE_EVENTS.answer.key,t)})),this._negotiator.on(O.EVENTS.iceConnectionFailed.key,(()=>{this.close()})),this._negotiator.on(O.EVENTS.iceCandidate.key,(e=>{const t={roomName:this.name,candidate:e};this.emit(ie.MESSAGE_EVENTS.candidate.key,t)}))}handleJoin(e){const{src:t,roomMembers:n}=e;if(t===this._peerId)return this._open=!0,this.members=n.filter((e=>e!==t)),this.call(this._localStream),void this.emit(ie.EVENTS.open.key);this.members.push(t),this.emit(ie.EVENTS.peerJoin.key,t)}handleLeave(e){if(!this._open)return;const t=e.src,n=this.members.indexOf(t);n>=0&&this.members.splice(n,1);for(const e in this.remoteStreams)this.remoteStreams[e].peerId===t&&(delete this.remoteStreams[e],delete this._msidMap[e],delete this._unknownStreams[e]);this.emit(ie.EVENTS.peerLeave.key,t)}send(e){if(!this._open)return;if(!this.validateSendDataSize(e))return;const t={roomName:this.name,data:e};this._sendData(t,ie.MESSAGE_EVENTS.broadcast.key)}close(){if(!this._open)return;this._negotiator&&this._negotiator.cleanup(),this._open=!1;const e={roomName:this.name};this.emit(ie.MESSAGE_EVENTS.leave.key,e),this.emit(ie.EVENTS.close.key)}replaceStream(e){this._localStream=e,this._negotiator.replaceStream(e)}updateMsidMap(e={}){this._msidMap=e;for(const e of Object.keys(this._unknownStreams))if(this._msidMap[e]){const t=this._unknownStreams[e];if(t.peerId=this._msidMap[t.id],delete this._unknownStreams[e],t.peerId===this._peerId)return;this.remoteStreams[t.id]=t,this.emit(ie.EVENTS.stream.key,t)}}getPeerConnection(){return this._connectionStarted?this._negotiator._pc:null}static get EVENTS(){return te}static get MESSAGE_EVENTS(){return ne}}var oe=ie;const re=new r.default([]);re.extend(ee.EVENTS.enums);const se=new r.default(["broadcastByDC","getPeers"]);se.extend(ee.MESSAGE_EVENTS.enums);class ae extends ee{constructor(e,t,n){super(e,t,n),this.connections={},this._queuedMessages={}}call(e){e&&(this._localStream=e);const t={roomName:this.name,type:"media"};this.emit(ae.MESSAGE_EVENTS.getPeers.key,t)}connect(){const e={roomName:this.name,type:"data"};this.emit(ae.MESSAGE_EVENTS.getPeers.key,e)}makeMediaConnections(e){const t={stream:this._localStream,pcConfig:this._pcConfig,originator:!0,videoBandwidth:this._options.videoBandwidth,audioBandwidth:this._options.audioBandwidth,videoCodec:this._options.videoCodec,audioCodec:this._options.audioCodec,videoReceiveEnabled:this._options.videoReceiveEnabled,audioReceiveEnabled:this._options.audioReceiveEnabled};this._makeConnections(e,"media",t)}makeDataConnections(e){const t={pcConfig:this._pcConfig};this._makeConnections(e,"data",t)}handleJoin(e){const t=e.src;if(t===this._peerId)return this.call(this._localStream),void this.emit(ae.EVENTS.open.key);this.emit(ae.EVENTS.peerJoin.key,t)}handleLeave(e){const t=e.src;this._deleteConnections(t),this.emit(ae.EVENTS.peerLeave.key,t)}handleOffer(e){const t=e.connectionId;let n=this._getConnection(e.src,t);if(n)n.updateOffer(e);else if("media"===e.connectionType){if(this._hasConnection(e.src)&&this._peerId>e.src)return;n=new $(e.src,{connectionId:t,payload:e,metadata:e.metadata,queuedMessages:this._queuedMessages[t],pcConfig:this._pcConfig}),n.startConnection(),p.log("MediaConnection created in OFFER"),this._addConnection(e.src,n),this._setupMessageHandlers(n),n.answer(this._localStream,{videoBandwidth:this._options.videoBandwidth,audioBandwidth:this._options.audioBandwidth,videoCodec:this._options.videoCodec,audioCodec:this._options.audioCodec,videoReceiveEnabled:this._options.videoReceiveEnabled,audioReceiveEnabled:this._options.audioReceiveEnabled})}else p.warn(`Received malformed connection type: ${e.connectionType}`)}handleAnswer(e){const t=this._getConnection(e.src,e.connectionId);t&&t.handleAnswer(e)}handleCandidate(e){const t=this._getConnection(e.src,e.connectionId);t?t.handleCandidate(e):(void 0===this._queuedMessages[e.connectionId]&&(this._queuedMessages[e.connectionId]=[]),this._queuedMessages[e.connectionId].push({type:d.MESSAGE_TYPES.SERVER.CANDIDATE.key,payload:e}))}send(e){if(!this.validateSendDataSize(e))return;const t={roomName:this.name,data:e};this._sendData(t,ae.MESSAGE_EVENTS.broadcast.key)}close(){for(const e in this.connections)this.connections.hasOwnProperty(e)&&this.connections[e].forEach((e=>{e.close(!1)}));const e={roomName:this.name};this.emit(ae.MESSAGE_EVENTS.leave.key,e),this.emit(ae.EVENTS.close.key)}replaceStream(e){this._localStream=e;for(const t in this.connections)this.connections.hasOwnProperty(t)&&this.connections[t].forEach((t=>{"media"===t.type&&t.replaceStream(e)}))}getPeerConnections(){const e={};for(const[t,[n]]of Object.entries(this.connections)){const i=n.getPeerConnection();i&&(e[t]=i)}return e}_addConnection(e,t){this.connections[e]||(this.connections[e]=[]),this.connections[e].push(t)}_makeConnections(e,t,n){e.filter((e=>e!==this._peerId)).filter((e=>!this._hasConnection(e))).forEach((e=>{let i;switch(t){case"data":i=new G(e,n);break;case"media":i=new $(e,n);break;default:return}i.startConnection(),this._addConnection(e,i),this._setupMessageHandlers(i),p.log(`${t} connection to ${e} created in ${this.name}`)}))}_deleteConnections(e){this.connections[e]&&delete this.connections[e]}_getConnection(e,t){return this.connections&&this.connections[e]?this.connections[e].filter((e=>e.id===t))[0]:null}_hasConnection(e){return this.connections[e]&&this.connections[e].length>0}_setupMessageHandlers(e){e.on(B.EVENTS.offer.key,(e=>{e.roomName=this.name,this.emit(ae.MESSAGE_EVENTS.offer.key,e)})),e.on(B.EVENTS.answer.key,(e=>{e.roomName=this.name,this.emit(ae.MESSAGE_EVENTS.answer.key,e)})),e.on(B.EVENTS.candidate.key,(e=>{e.roomName=this.name,this.emit(ae.MESSAGE_EVENTS.candidate.key,e)})),"media"===e.type&&e.on($.EVENTS.stream.key,(t=>{t.peerId=e.remoteId,this.emit(ae.EVENTS.stream.key,t)}))}static get EVENTS(){return re}static get MESSAGE_EVENTS(){return se}}var ce=ae;const ue=new r.default(["open","error","call","connection","expiresin","close","disconnected"]);class de extends o.a{constructor(e,t){super(),this.connections={},this.rooms={},this._queuedMessages={},e&&e.constructor===Object?(t=e,e=void 0):e&&(e=e.toString());const n={debug:p.LOG_LEVELS.NONE,secure:!0,config:d.defaultConfig,turn:!0,dispatcherSecure:d.DISPATCHER_SECURE,dispatcherHost:d.DISPATCHER_HOST,dispatcherPort:d.DISPATCHER_PORT};this.options=Object.assign({},n,t),this.options.token=v(),p.setLogLevel(this.options.debug),m(e)?g(t.key)?("/"===this.options.host&&(this.options.host=window.location.hostname),void 0===t.secure&&443!==this.options.port&&(this.options.secure=void 0),this._initializeServerConnection(e)):this._abort("invalid-key",`API KEY "${this.options.key}" is invalid`):this._abort("invalid-id",`ID "${e}" is invalid`)}call(e,t,n={}){if(!this._checkOpenStatus())return;n.originator=!0,n.stream=t,n.pcConfig=this._pcConfig;const i=new $(e,n);return i.startConnection(),p.log("MediaConnection created in call method"),this._addConnection(e,i),i}connect(e,t={}){if(!this._checkOpenStatus())return;t.pcConfig=this._pcConfig;const n=new G(e,t);return n.startConnection(),p.log("DataConnection created in connect method"),this._addConnection(e,n),n}joinRoom(e,t={}){if(this._checkOpenStatus()){if(!e){const e=new Error("Room name must be defined.");return e.type="room-error",p.error(e),this.emit(de.EVENTS.error.key,e),null}return t.pcConfig=this._pcConfig,t.peerId=this.id,"sfu"===t.mode?this._initializeSfuRoom(e,t):this._initializeFullMeshRoom(e,t)}}getConnection(e,t){if(this._checkOpenStatus()){if(this.connections[e])for(const n of this.connections[e])if(n.id===t)return n;return null}}get open(){return this.socket&&this.socket.isOpen}destroy(){this._cleanup(),this.disconnect(!0)}disconnect(e=!1){e||p.warn("Use peer's destroy method instead. This method may be removed in future versions."),this.open&&(this.socket.close(),this.emit(de.EVENTS.disconnected.key,this.id))}reconnect(){p.warn("Recreate peer instance instead. This method may be removed in future versions."),this.open||this.socket.reconnect()}updateCredential(e){this.socket.updateCredential(e)}listAllPeers(e){if(!this._checkOpenStatus())return;e=e||function(){};const t=this,n=new XMLHttpRequest,i=`${this.socket.signalingServerUrl}/api/apikeys/${this.options.key}/clients/`;n.open("get",i,!0),n.onerror=function(){t._abort("server-error","Could not get peers from the server."),e([])},n.onreadystatechange=function(){if(4===n.readyState)if(401===n.status){e([]);const n=new Error("It doesn't look like you have permission to list peers IDs. Please enable the SkyWay REST API on dashboard");n.type="list-error",p.error(n),t.emit(de.EVENTS.error.key,n)}else 200===n.status?e(JSON.parse(n.responseText)):e([])},n.send(null)}async fetchPeerExists(e){if(!this.open)throw new Error("Peer is not yet connected to signaling server");const t=(new Date).getTime();if(void 0!==this._lastFetchPeerExistsTime&&t-this._lastFetchPeerExistsTime<1e3)throw new Error("fetchPeerExists can only be called once per second");this._lastFetchPeerExistsTime=t;const n=`${this.socket.signalingServerUrl}/api/apikeys/${this.options.key}/peers/${e}/exists`,i=await fetch(n);if(200===i.status)return(await i.json()).exists;{const e=await i.text();throw new Error(e)}}_checkOpenStatus(){return this.open||this._emitNotConnectedError(),this.open}_emitNotConnectedError(){p.warn("You cannot connect to a new Peer because you are not connecting to SkyWay server now.You can create a new Peer to reconnect, or call reconnect() on this peer if you believe its ID to still be available.");const e=new Error("Cannot connect to new Peer before connecting to SkyWay server or after disconnecting from the server.");e.type="disconnected",p.error(e),this.emit(de.EVENTS.error.key,e)}_initializeServerConnection(e){this.socket=new k(this.options.key,{secure:this.options.secure,host:this.options.host,port:this.options.port,dispatcherSecure:this.options.dispatcherSecure,dispatcherHost:this.options.dispatcherHost,dispatcherPort:this.options.dispatcherPort}),this._setupMessageHandlers(),this.socket.on("error",(e=>{this._abort("socket-error",e)})),this.socket.on("disconnect",(()=>{this.disconnect(!0);const e=new Error("Lost connection to server.");e.type="socket-error",p.error(e),this.emit(de.EVENTS.error.key,e)})),this.socket.start(e,this.options.token,this.options.credential)}_initializeSfuRoom(e,t={}){if(this.rooms[e])return this.rooms[e];const n=new oe(e,this.id,t);this.rooms[e]=n,this._setupSFURoomMessageHandlers(n);const i={roomName:e,roomType:"sfu"};return this.socket.send(d.MESSAGE_TYPES.CLIENT.ROOM_JOIN.key,i),n}_initializeFullMeshRoom(e,t={}){if(this.rooms[e])return this.rooms[e];const n=new ce(e,this.id,t);this.rooms[e]=n,this._setupMeshRoomMessageHandlers(n);const i={roomName:e,roomType:"mesh"};return this.socket.send(d.MESSAGE_TYPES.CLIENT.ROOM_JOIN.key,i),n}_setupMessageHandlers(){this.socket.on(d.MESSAGE_TYPES.SERVER.OPEN.key,(e=>{this.id=e.peerId,this._pcConfig=Object.assign({},this.options.config);const t=this._pcConfig.iceServers;this._pcConfig.iceServers=t?t.slice():[];const n=e.turnCredential;let i,o;if("object"==typeof n?(i=n.username,o=n.credential):"string"==typeof n&&(i=`${this.options.key}$${this.id}`,o=n),!0===this.options.turn&&i&&o){const e=[{protocol:"turn",transport:"tcp"},{protocol:"turn",transport:"udp"}];"edge"!==S().name&&e.push({protocol:"turns",transport:"tcp"});for(const t of e){const e=t.protocol,n=t.transport,r={urls:`${e}:${d.TURN_HOST}:${d.TURN_PORT}?transport=${n}`,url:`${e}:${d.TURN_HOST}:${d.TURN_PORT}?transport=${n}`,username:i,credential:o};this._pcConfig.iceServers.push(r)}p.log("SkyWay TURN Server is available")}else p.log("SkyWay TURN Server is unavailable");this.emit(de.EVENTS.open.key,this.id)})),this.socket.on(d.MESSAGE_TYPES.SERVER.ERROR.key,(e=>{const t=new Error(e.message);t.type=e.type,p.error(t),this.emit(de.EVENTS.error.key,t)})),this.socket.on(d.MESSAGE_TYPES.SERVER.LEAVE.key,(e=>{p.log(`Received leave message from ${e}`),this._cleanupPeer(e)})),this.socket.on(d.MESSAGE_TYPES.SERVER.FORCE_CLOSE.key,(({src:e,connectionId:t})=>{const n=this.getConnection(e,t);n&&n.close(!1)})),this.socket.on(d.MESSAGE_TYPES.SERVER.AUTH_EXPIRES_IN.key,(e=>{p.log(`Credential expires in ${e}`),this.emit(de.EVENTS.expiresin.key,e)})),this.socket.on(d.MESSAGE_TYPES.SERVER.OFFER.key,(e=>{const t=e.roomName;if(t){const n=this.rooms[t];return void(n&&n.handleOffer(e))}const n=e.connectionId;let i=this.getConnection(e.src,n);i?i.updateOffer(e):("media"===e.connectionType?(i=new $(e.src,{connectionId:n,payload:e,metadata:e.metadata,originator:!1,queuedMessages:this._queuedMessages[n],pcConfig:this._pcConfig}),i.startConnection(),p.log("MediaConnection created in OFFER"),this._addConnection(e.src,i),this.emit(de.EVENTS.call.key,i)):"data"===e.connectionType?(i=new G(e.src,{connectionId:n,payload:e,metadata:e.metadata,label:e.label,dcInit:e.dcInit,serialization:e.serialization,queuedMessages:this._queuedMessages[n],pcConfig:this._pcConfig}),i.startConnection(),p.log("DataConnection created in OFFER"),this._addConnection(e.src,i),this.emit(de.EVENTS.connection.key,i)):p.warn("Received malformed connection type: ",e.connectionType),delete this._queuedMessages[n])})),this.socket.on(d.MESSAGE_TYPES.SERVER.ANSWER.key,(e=>{const t=e.roomName;if(t){const n=this.rooms[t];return void(n&&n.handleAnswer(e))}const n=this.getConnection(e.src,e.connectionId);n?n.handleAnswer(e):this._storeMessage(d.MESSAGE_TYPES.SERVER.ANSWER.key,e)})),this.socket.on(d.MESSAGE_TYPES.SERVER.CANDIDATE.key,(e=>{const t=e.roomName;if(t){const n=this.rooms[t];return void(n&&n.handleCandidate(e))}const n=this.getConnection(e.src,e.connectionId);n?n.handleCandidate(e):this._storeMessage(d.MESSAGE_TYPES.SERVER.CANDIDATE.key,e)})),this.socket.on(d.MESSAGE_TYPES.SERVER.ROOM_USER_JOIN.key,(e=>{const t=this.rooms[e.roomName];t&&t.handleJoin(e)})),this.socket.on(d.MESSAGE_TYPES.SERVER.ROOM_USER_LEAVE.key,(e=>{const t=this.rooms[e.roomName];t&&t.handleLeave(e)})),this.socket.on(d.MESSAGE_TYPES.SERVER.ROOM_DATA.key,(e=>{const t=this.rooms[e.roomName];t&&t.handleData(e)})),this.socket.on(d.MESSAGE_TYPES.SERVER.ROOM_LOGS.key,(e=>{const t=this.rooms[e.roomName];t&&t.handleLog(e.log)})),this.socket.on(d.MESSAGE_TYPES.SERVER.ROOM_USERS.key,(e=>{const t=this.rooms[e.roomName];t&&("media"===e.type?t.makeMediaConnections(e.userList):t.makeDataConnections(e.userList))})),this.socket.on(d.MESSAGE_TYPES.SERVER.SFU_OFFER.key,(e=>{const t=this.rooms[e.roomName];t&&(t.updateMsidMap(e.msids),t.handleOffer(e))}))}_setupConnectionMessageHandlers(e){e.on(B.EVENTS.candidate.key,(e=>{this.socket.send(d.MESSAGE_TYPES.CLIENT.SEND_CANDIDATE.key,e)})),e.on(B.EVENTS.answer.key,(e=>{this.socket.send(d.MESSAGE_TYPES.CLIENT.SEND_ANSWER.key,e)})),e.on(B.EVENTS.offer.key,(e=>{this.socket.send(d.MESSAGE_TYPES.CLIENT.SEND_OFFER.key,e)})),e.on(B.EVENTS.forceClose.key,(()=>{const t={dst:e.remoteId,connectionId:e.id};this.socket.send(d.MESSAGE_TYPES.CLIENT.SEND_FORCE_CLOSE.key,t)}))}_setupRoomMessageHandlers(e){e.on(oe.MESSAGE_EVENTS.broadcast.key,(e=>{this.socket.send(d.MESSAGE_TYPES.CLIENT.ROOM_SEND_DATA.key,e)})),e.on(oe.MESSAGE_EVENTS.getLog.key,(e=>{this.socket.send(d.MESSAGE_TYPES.CLIENT.ROOM_GET_LOGS.key,e)})),e.on(oe.MESSAGE_EVENTS.leave.key,(t=>{delete this.rooms[e.name],this.socket.send(d.MESSAGE_TYPES.CLIENT.ROOM_LEAVE.key,t)}))}_setupSFURoomMessageHandlers(e){this._setupRoomMessageHandlers(e),e.on(oe.MESSAGE_EVENTS.offerRequest.key,(e=>{this.socket.send(d.MESSAGE_TYPES.CLIENT.SFU_GET_OFFER.key,e)})),e.on(oe.MESSAGE_EVENTS.answer.key,(e=>{this.socket.send(d.MESSAGE_TYPES.CLIENT.SFU_ANSWER.key,e)})),e.on(oe.MESSAGE_EVENTS.candidate.key,(e=>{this.socket.send(d.MESSAGE_TYPES.CLIENT.SFU_CANDIDATE.key,e)}))}_setupMeshRoomMessageHandlers(e){this._setupRoomMessageHandlers(e),e.on(ce.MESSAGE_EVENTS.offer.key,(e=>{this.socket.send(d.MESSAGE_TYPES.CLIENT.SEND_OFFER.key,e)})),e.on(ce.MESSAGE_EVENTS.answer.key,(e=>{this.socket.send(d.MESSAGE_TYPES.CLIENT.SEND_ANSWER.key,e)})),e.on(ce.MESSAGE_EVENTS.candidate.key,(e=>{this.socket.send(d.MESSAGE_TYPES.CLIENT.SEND_CANDIDATE.key,e)})),e.on(ce.MESSAGE_EVENTS.getPeers.key,(e=>{this.socket.send(d.MESSAGE_TYPES.CLIENT.ROOM_GET_USERS.key,e)}))}_abort(e,t){p.error("Aborting!"),this.disconnect(!0);const n=new Error(t);n.type=e,p.error(n),this.emit(de.EVENTS.error.key,n)}_addConnection(e,t){this.connections[e]||(this.connections[e]=[]),this.connections[e].push(t),this._setupConnectionMessageHandlers(t)}_storeMessage(e,t){this._queuedMessages[t.connectionId]||(this._queuedMessages[t.connectionId]=[]),this._queuedMessages[t.connectionId].push({type:e,payload:t})}_cleanup(){if(this.connections)for(const e of Object.keys(this.connections))this._cleanupPeer(e);this.emit(de.EVENTS.close.key)}_cleanupPeer(e){if(this.connections[e])for(const t of this.connections[e])t.close(!1)}static get EVENTS(){return ue}}t.default=de},0:function(e,t){}}).default},e.exports=t()},572:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>g});var i="undefined"!=typeof window?window:null,o=null===i,r=o?void 0:i.document,s="horizontal",a=function(){return!1},c=o?"calc":["","-webkit-","-moz-","-o-"].filter((function(e){var t=r.createElement("div");return t.style.cssText="width:"+e+"calc(9px)",!!t.style.length})).shift()+"calc",u=function(e){return"string"==typeof e||e instanceof String},d=function(e){if(u(e)){var t=r.querySelector(e);if(!t)throw new Error("Selector "+e+" did not match a DOM element");return t}return e},l=function(e,t,n){var i=e[t];return void 0!==i?i:n},h=function(e,t,n,i){if(t){if("end"===i)return 0;if("center"===i)return e/2}else if(n){if("start"===i)return 0;if("center"===i)return e/2}return e},p=function(e,t){var n=r.createElement("div");return n.className="gutter gutter-"+t,n},f=function(e,t,n){var i={};return u(t)?i[e]=t:i[e]=c+"("+t+"% - "+n+"px)",i},m=function(e,t){var n;return(n={})[e]=t+"px",n};const g=function(e,t){if(void 0===t&&(t={}),o)return{};var n,c,u,g,y,v,_=e;Array.from&&(_=Array.from(_));var b=d(_[0]).parentNode,S=getComputedStyle?getComputedStyle(b):null,w=S?S.flexDirection:null,E=l(t,"sizes")||_.map((function(){return 100/_.length})),C=l(t,"minSize",100),k=Array.isArray(C)?C:_.map((function(){return C})),T=l(t,"maxSize",1/0),A=Array.isArray(T)?T:_.map((function(){return T})),R=l(t,"expandToMin",!1),N=l(t,"gutterSize",10),I=l(t,"gutterAlign","center"),x=l(t,"snapOffset",30),O=l(t,"dragInterval",1),M=l(t,"direction",s),P=l(t,"cursor",M===s?"col-resize":"row-resize"),B=l(t,"gutter",p),L=l(t,"elementStyle",f),j=l(t,"gutterStyle",m);function D(e,t,i,o){var r=L(n,t,i,o);Object.keys(r).forEach((function(t){e.style[t]=r[t]}))}function U(){return v.map((function(e){return e.size}))}function F(e){return"touches"in e?e.touches[0][c]:e[c]}function z(e){var t=v[this.a],n=v[this.b],i=t.size+n.size;t.size=e/this.size*i,n.size=i-e/this.size*i,D(t.element,t.size,this._b,t.i),D(n.element,n.size,this._c,n.i)}function V(e){var n,i=v[this.a],o=v[this.b];this.dragging&&(n=F(e)-this.start+(this._b-this.dragOffset),O>1&&(n=Math.round(n/O)*O),n<=i.minSize+x+this._b?n=i.minSize+this._b:n>=this.size-(o.minSize+x+this._c)&&(n=this.size-(o.minSize+this._c)),n>=i.maxSize-x+this._b?n=i.maxSize+this._b:n<=this.size-(o.maxSize-x+this._c)&&(n=this.size-(o.maxSize+this._c)),z.call(this,n),l(t,"onDrag",a)(U()))}function G(){var e=v[this.a].element,t=v[this.b].element,i=e.getBoundingClientRect(),o=t.getBoundingClientRect();this.size=i[n]+o[n]+this._b+this._c,this.start=i[u],this.end=i[g]}function q(e){var t=function(e){if(!getComputedStyle)return null;var t=getComputedStyle(e);if(!t)return null;var n=e[y];return 0===n?null:n-=M===s?parseFloat(t.paddingLeft)+parseFloat(t.paddingRight):parseFloat(t.paddingTop)+parseFloat(t.paddingBottom)}(b);if(null===t)return e;if(k.reduce((function(e,t){return e+t}),0)>t)return e;var n=0,i=[],o=e.map((function(o,r){var s=t*o/100,a=h(N,0===r,r===e.length-1,I),c=k[r]+a;return s<c?(n+=c-s,i.push(0),c):(i.push(s-c),s)}));return 0===n?e:o.map((function(e,o){var r=e;if(n>0&&i[o]-n>0){var s=Math.min(n,i[o]-n);n-=s,r=e-s}return r/t*100}))}function Y(){var e=this,n=v[e.a].element,o=v[e.b].element;e.dragging&&l(t,"onDragEnd",a)(U()),e.dragging=!1,i.removeEventListener("mouseup",e.stop),i.removeEventListener("touchend",e.stop),i.removeEventListener("touchcancel",e.stop),i.removeEventListener("mousemove",e.move),i.removeEventListener("touchmove",e.move),e.stop=null,e.move=null,n.removeEventListener("selectstart",a),n.removeEventListener("dragstart",a),o.removeEventListener("selectstart",a),o.removeEventListener("dragstart",a),n.style.userSelect="",n.style.webkitUserSelect="",n.style.MozUserSelect="",n.style.pointerEvents="",o.style.userSelect="",o.style.webkitUserSelect="",o.style.MozUserSelect="",o.style.pointerEvents="",e.gutter.style.cursor="",e.parent.style.cursor="",r.body.style.cursor=""}function $(e){if(!("button"in e)||0===e.button){var n=this,o=v[n.a].element,s=v[n.b].element;n.dragging||l(t,"onDragStart",a)(U()),e.preventDefault(),n.dragging=!0,n.move=V.bind(n),n.stop=Y.bind(n),i.addEventListener("mouseup",n.stop),i.addEventListener("touchend",n.stop),i.addEventListener("touchcancel",n.stop),i.addEventListener("mousemove",n.move),i.addEventListener("touchmove",n.move),o.addEventListener("selectstart",a),o.addEventListener("dragstart",a),s.addEventListener("selectstart",a),s.addEventListener("dragstart",a),o.style.userSelect="none",o.style.webkitUserSelect="none",o.style.MozUserSelect="none",o.style.pointerEvents="none",s.style.userSelect="none",s.style.webkitUserSelect="none",s.style.MozUserSelect="none",s.style.pointerEvents="none",n.gutter.style.cursor=P,n.parent.style.cursor=P,r.body.style.cursor=P,G.call(n),n.dragOffset=F(e)-n.end}}M===s?(n="width",c="clientX",u="left",g="right",y="clientWidth"):"vertical"===M&&(n="height",c="clientY",u="top",g="bottom",y="clientHeight"),E=q(E);var W=[];function H(e){var t=e.i===W.length,n=t?W[e.i-1]:W[e.i];G.call(n);var i=t?n.size-e.minSize-n._c:e.minSize+n._b;z.call(n,i)}return(v=_.map((function(e,t){var i,o={element:d(e),size:E[t],minSize:k[t],maxSize:A[t],i:t};if(t>0&&((i={a:t-1,b:t,dragging:!1,direction:M,parent:b})._b=h(N,t-1==0,!1,I),i._c=h(N,!1,t===_.length-1,I),"row-reverse"===w||"column-reverse"===w)){var r=i.a;i.a=i.b,i.b=r}if(t>0){var s=B(t,M,o.element);!function(e,t,i){var o=j(n,t,i);Object.keys(o).forEach((function(t){e.style[t]=o[t]}))}(s,N,t),i._a=$.bind(i),s.addEventListener("mousedown",i._a),s.addEventListener("touchstart",i._a),b.insertBefore(s,o.element),i.gutter=s}return D(o.element,o.size,h(N,0===t,t===_.length-1,I),t),t>0&&W.push(i),o}))).forEach((function(e){var t=e.element.getBoundingClientRect()[n];t<e.minSize&&(R?H(e):e.minSize=t)})),{setSizes:function(e){var t=q(e);t.forEach((function(e,n){if(n>0){var i=W[n-1],o=v[i.a],r=v[i.b];o.size=t[n-1],r.size=e,D(o.element,o.size,i._b,o.i),D(r.element,r.size,i._c,r.i)}}))},getSizes:U,collapse:function(e){H(v[e])},destroy:function(e,t){W.forEach((function(i){if(!0!==t?i.parent.removeChild(i.gutter):(i.gutter.removeEventListener("mousedown",i._a),i.gutter.removeEventListener("touchstart",i._a)),!0!==e){var o=L(n,i.a.size,i._b);Object.keys(o).forEach((function(e){v[i.a].element.style[e]="",v[i.b].element.style[e]=""}))}}))},parent:b,pairs:W}}},326:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});class n{static getName(){return null==this.username&&(this.username=localStorage.getItem(this.KEY_STORAGE)||""),this.username}static setName(e){e!==this.username&&(this.username=e,localStorage.setItem(this.KEY_STORAGE,e))}static getRoomName(){return this.roomName}static setRoomName(e){this.roomName=e}static getPassword(){return this.password}static setPassword(e){this.password=e}static getChatType(){return this.chatType}static setChatType(e){this.chatType=e}static useAutoNameOnSend(){return!0}static getDisplayStyle(){return this.displayStyle}static setDisplayStyle(e){this.displayStyle=e}static getIfNarrow(){return"Full"!==this.displayStyle}static getApiKey(){return this.apiKey}static setApiKey(e){this.apiKey=e}static getDebugLevel(){return this.debugLevel}static setDebugLevel(e){this.debugLevel=e}static getRoomConnectionType(){return this.roomConnectionType}static setRoomConnectionType(e){"sfu"!==e&&"mesh"!==e||(this.roomConnectionType=e)}}n.KEY_STORAGE="tmp-mkchat1-config-name",n.roomName="",n.password="",n.SET_NAME_AUTOMATICALLY="a",n.chatType="",n.displayStyle="Full",n.apiKey="",n.debugLevel=1,n.roomConnectionType="sfu",t.default=n},752:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return o(t,e),t},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=r(n(65)),c=s(n(110)),u=s(n(478)),d=s(n(222)),l=n(150),h=n(771),p=n(702),f=n(144),m=n(877),g=n(882),y=n(165),v=n(900),_=n(359),b=n(580),S=n(43),w=s(n(326)),E=s(n(572)),C=s(n(263)),k=n(795),T=n(914),A=s(n(90)),R=s(n(152));t.default=class{constructor(){this.id="",this.pageTitle="",this.isErrorHandling=!1,this.IS_BROWSER_AUTH="browser",this.audioNotify=document.getElementById("audio-notify"),this.isActive=!0,this.KEY_STORAGE="config-mkchat1",this.MEDIA_QUERY_SMALL_SCREEN="screen and (max-width: 519px)";const e=localStorage.getItem(this.KEY_STORAGE);null!=e&&(c.default.w("Info","config found in localStorage"),S.AppConfig.trySetJSON(e));const t=S.AppConfig.data.getLocale();c.default.w("Info",`locale:${t}`),y.T.setLocale(t),window.addEventListener("beforeunload",(e=>{this.onBeforeUnload(e)})),window.addEventListener("unload",(e=>{this.onUnload(e)})),window.addEventListener("focus",(e=>{this.isActive=!0})),window.addEventListener("blur",(e=>{this.isActive=!1})),_.UtilDom.makeDialogsRespondToKey(),this.dialogNotify=new C.default;const n=this.makeCommEventHandlers();this.comm=new a.default(n),this.pane1=new A.default,this.pane2=new R.default,this.appControl=new u.default,this.setAppControlEvents(),this.dialogConfig=new k.DialogConfig,this.setDialogConfigEvents(),this.dialogLogin=new d.default,this.setLoginDialogEvents(),this.dialogLogin.setName(w.default.getName());const i=g.Util.tryGetRoomNameFromURI(),o=g.Util.beforeOf(i,"/");g.Util.isRoomNameLegit(o)&&(this.dialogLogin.setRoom(o),this.dialogLogin.hideRoom());const r=g.Util.tryGetPasswordFromURI();null!=r&&(this.dialogLogin.setPassword(r),this.dialogLogin.hidePass()),this.updatePageTitle(y.T.t("Login","Login")),g.Util.contains(navigator.userAgent,"MSIE","Trident","Edge")||(document.getElementById("shutter").style.display="none",this.dialogLogin.showDialog()),fetch("config.json").then((e=>e.json())).then((e=>{if("api_key"in e){const t=e.api_key;w.default.setApiKey(t),this.dialogLogin.setLoginCondition(1)}if("debug_level"in e){const t=e.debug_level;w.default.setDebugLevel(t)}if("chat_type"in e){const t=e.chat_type;w.default.setChatType(t)}if("room_connection_type"in e){const t=e.room_connection_type;w.default.setRoomConnectionType(t)}})),this.paneMain=new v.PaneMain,this.paneFkey=new h.PaneFkey,this.paneInput=new l.PaneInput,this.setInputEvents(),this.paneMonitor=new p.PaneMonitor,this.setMonitorEvents(),this.paneNote=new T.PaneNote,this.setNoteEvents(),this.panes={i:this.paneInput,f:this.paneFkey},this.localizeAll(),this.setEvents()}sendMain(e){const t=w.default.getName(),n=new f.ContentToSendClass(t,f.ContentType.DISPLAY,e);this.comm.send_room(n);const i=f.ContentClass.fromSendData(this.id,n);this.paneMain.addNewItem(i)}sendNote(e){c.default.w("info",`send note : ${e}`);const t=new f.ContentToSendClass(w.default.getName(),f.ContentType.NOTE,e);this.comm.send_room(t)}updateRoomName(e){w.default.setRoomName(e),g.Util.tryGetRoomNameFromURI()!=e&&_.UtilDom.setQuery(e),e.length>0?this.updatePageTitle(y.T.t("Room","General")+" "+e):this.updatePageTitle(y.T.t("Login","Login"))}updatePageTitle(e,t=!0){this.pageTitle.length<1&&(this.pageTitle=document.title),document.title=t?e+" - "+this.pageTitle:this.pageTitle+" - "+e}setDialogConfigEvents(){this.dialogConfig.onSetClicked=()=>{this.updateAllConfig()},this.dialogConfig.onResetClicked=()=>{S.AppConfig.resetAll(),this.updateAllConfig(),this.dialogConfig.configToDialog()}}setAppControlEvents(){this.appControl.onConfig=()=>{this.dialogConfig.showDialog()},this.appControl.onLogout=()=>{const e=new f.ContentToSendClass(w.default.getName(),f.ContentType.LOGOFF,"");this.comm.send_room(e),this.comm.leaveRoom()},this.appControl.onShowNote=()=>{var e;!0===(null===(e=this.smallScreenMediaQuery)||void 0===e?void 0:e.matches)&&(w.default.setDisplayStyle("OnlySub"),this.setSplits())},this.appControl.onBackToChat=()=>{var e;!0===(null===(e=this.smallScreenMediaQuery)||void 0===e?void 0:e.matches)&&(w.default.setDisplayStyle("OnlyChat"),this.setSplits())}}setLoginDialogEvents(){this.dialogLogin.onDownloadMain=()=>{const e=g.Util.getIsoModifiedDateTimeString()+".log",t=this.paneMain.getMainLog().join(g.Util.getNewLineCode());b.Downloader.start(e,t)},this.dialogLogin.onDownloadNote=()=>{const e=g.Util.getIsoModifiedDateTimeString()+"_note.log",t=this.paneNote.getNote();b.Downloader.start(e,t)},this.dialogLogin.onLoginClick=e=>{this.loginInfo=e,w.default.setRoomName(e.room),w.default.setName(e.name),w.default.setPassword(e.pass);let t=e;this.updateRoomName(e.room),this.paneMonitor.clearMembers(),this.paneMain.goBottom(),this.paneInput.clearAllInput(),this.setSubtitlerStyle(),this.comm.open(w.default.getApiKey(),{handleOpen:e=>{this.comm.joinRoom(t,w.default.getRoomConnectionType()).then((()=>{})).catch((e=>{c.default.w("Error",`Error on login. message:${e}`),this.dialogLogin.showDialog()}))},debugLevel:w.default.getDebugLevel()}),!0!==this.paneInput.isVoiceInputAvailable()&&this.paneInput.alertAndRecommendBrowser()}}setInputEvents(){this.paneInput.setGetFkey((e=>this.paneFkey.getFKey(e))),this.paneInput.setDoOnInput((e=>{const t=new f.ContentToSendClass(w.default.getName(),f.ContentType.MONITOR,e);this.comm.send_room(t)})),this.paneInput.setDoOnEnter((e=>{this.sendMain(e)}))}setMonitorEvents(){this.paneMonitor.setOnNewJoined((e=>{var t;this.paneMain.addMessageMemberAttended(null!==(t=e.name)&&void 0!==t?t:"???")})),this.paneMonitor.setOnLeft((e=>{var t;this.paneMain.addMessageMemberExited(null!==(t=e.name)&&void 0!==t?t:"???")}))}setNoteEvents(){this.paneNote.onUpdate=e=>{this.sendNote(e)}}setSubtitlerStyle(){this.paneInput.focus()}updateAllConfig(){this.paneMain.updateConfig(),this.paneInput.updateConfig(),this.paneMonitor.updateConfig(),this.paneNote.updateConfig(),this.paneFkey.updateConfig()}manageScreenWidth(e){null==e?w.default.setDisplayStyle("Full"):e.matches?(w.default.setDisplayStyle("OnlyChat"),this.paneInput.setupAsNarrowScreen()):w.default.setDisplayStyle("Full"),this.setSplits()}selectWidths(){switch(w.default.getDisplayStyle()){case"Full":return[S.AppConfig.data.misc_pane1_width,S.AppConfig.data.misc_pane2_width];case"OnlyChat":return[100,0];case"OnlySub":return[0,100]}}selectHeights(){return w.default.getIfNarrow()?[100,0]:[S.AppConfig.data.misc_display_input_height,S.AppConfig.data.misc_monitor_height]}setSplits(){const[e,t]=this.selectWidths();e>0?this.pane1.show():this.pane1.hide(),t>0?this.pane2.show():this.pane2.hide(),null==this.splitContainer?this.splitContainer=(0,E.default)(["#pane1","#pane2"],{sizes:[e,t],minSize:0,direction:"horizontal",gutterSize:6,onDragEnd:e=>{var t;!0===w.default.getIfNarrow()?null===(t=this.splitContainer)||void 0===t||t.setSizes(this.selectWidths()):(S.AppConfig.data.misc_pane1_width=e[0],S.AppConfig.data.misc_pane2_width=e[1])}}):this.splitContainer.setSizes([e,t]);const[n,i]=this.selectHeights();null==this.splitDisplayMonitor?this.splitDisplayMonitor=(0,E.default)(["#display-input","#monitor"],{sizes:[n,i],minSize:0,direction:"vertical",gutterSize:6,onDragEnd:e=>{var t;w.default.getIfNarrow()?null===(t=this.splitDisplayMonitor)||void 0===t||t.setSizes([100,0]):(S.AppConfig.data.misc_display_input_height=e[0],S.AppConfig.data.misc_monitor_height=e[1])}}):this.splitDisplayMonitor.setSizes([n,i])}localizeAll(){this.localize(),this.paneInput.localize(),this.paneMonitor.localize(),this.paneFkey.localize()}onPeerIdAcquired(e){this.id=e}onJoined(){const e=new f.ContentToSendClass(w.default.getName(),f.ContentType.LOGIN,"");this.comm.send_room(e)}onLeft(){if(null==this.dialogLogin)return;if(this.isErrorHandling)return;if(this.dialogLogin.isShown())return;this.dialogLogin.setRoom(w.default.getRoomName()),this.dialogLogin.setName(w.default.getName()),this.dialogLogin.setPassword(w.default.getPassword()),this.updateRoomName(w.default.getRoomName()),this.paneMonitor.clearMembers();const e=this.paneMain.hasMainLog(),t=this.paneNote.hasNote();this.dialogLogin.showDialog(e,t)}onSomeoneJoined(e){}onSomeoneLeft(e){this.paneMonitor.deleteMember(e)}onReceived(e){const t=m.MemberInfoClass.fromContent(e);let n=!0;if(e.messageType===f.ContentType.LOGIN){const e=this.paneNote.getNote();let t=this.paneNote.getLastSender();t.length<1&&(t=w.default.getName());const n=new f.ContentToSendClass(w.default.getName(),f.ContentType.RESPONSE,t+"\n"+e);this.comm.send_room(n),this.isActive||this.audioNotify.play()}e.messageType===f.ContentType.RESPONSE&&this.paneNote.updateByResponse(e),e.messageType===f.ContentType.DISPLAY&&(t.inputContent="",this.paneMonitor.updateMember(t,e),this.paneMain.addNewItem(e),n=!1,this.isActive||this.audioNotify.play()),e.messageType===f.ContentType.MONITOR&&(t.inputContent=e.messageBody),e.messageType===f.ContentType.NOTE&&this.paneNote.update(e),f.ContentType.LOGOFF in e?(this.paneMonitor.deleteMember(e.senderID),this.isActive||this.audioNotify.play()):n&&this.paneMonitor.updateMember(t,e)}onAuthError(){this.dialogNotify.onOkClick=()=>{this.onLeft()},this.dialogNotify.showDialog(y.T.t("Error","General"),y.T.t("Login failed.","Login"))}onCommunicationError(e){this.isErrorHandling=!0,this.comm.leaveRoom(),this.dialogNotify.onOkClick=()=>{this.isErrorHandling=!1,this.onLeft()};const t=null!=e.message?"\n"+y.T.t("Detail","General")+" : "+e.message:"";this.dialogNotify.showDialog(y.T.t("Error","General"),y.T.t("Communication error.","General")+t)}onSomeError(e){this.isErrorHandling=!0,this.comm.leaveRoom(),this.dialogNotify.onOkClick=()=>{this.isErrorHandling=!1,this.onLeft()};const t=null!=e.message?"\n"+y.T.t("Detail","General")+" : "+e.message:"";this.dialogNotify.showDialog(y.T.t("Error","General"),y.T.t("Communication error.","General")+t)}onPeerError(e){"authentication"===e.type?this.onAuthError():"socket-error"===e.type?this.onCommunicationError(e):this.onSomeError(e)}makeCommEventHandlers(){const e=new a.MekikuCommEvents;return e.onPeerIdAcquired=e=>{this.onPeerIdAcquired(e)},e.onPeerError=e=>{this.onPeerError(e)},e.onJoinedRoom=()=>{this.onJoined()},e.onLeftRoom=()=>{this.onLeft()},e.onReceived=e=>{this.onReceived(e)},e.onSomeoneJoined=e=>{this.onSomeoneJoined(e)},e.onSomeoneLeft=e=>{this.onSomeoneLeft(e)},e.logger=e=>{c.default.w("Comm",e)},e}onBeforeUnload(e){var t;if(!0===(null===(t=this.comm)||void 0===t?void 0:t.isInRoom()))return e.preventDefault(),e.returnValue="Truly exit?","Truly exit?"}onUnload(e){var t;if(!0===(null===(t=this.comm)||void 0===t?void 0:t.isInRoom())){const e=new f.ContentToSendClass(w.default.getName(),f.ContentType.LOGOFF,"");this.comm.send_room(e),this.comm.leaveRoom()}const n=S.AppConfig.getJSON();localStorage.setItem(this.KEY_STORAGE,n)}setEvents(){this.smallScreenMediaQuery=window.matchMedia(this.MEDIA_QUERY_SMALL_SCREEN),this.smallScreenMediaQuery.addEventListener("change",(e=>{this.manageScreenWidth(this.smallScreenMediaQuery)})),this.manageScreenWidth(this.smallScreenMediaQuery),document.addEventListener("visibilitychange",(e=>{document.hidden})),document.addEventListener("keydown",(e=>{"F5"===e.key&&this.comm.isInRoom()&&(e.preventDefault(),e.stopImmediatePropagation(),e.stopPropagation()),"F1"===e.key&&this.comm.isInRoom()&&(e.preventDefault(),e.stopImmediatePropagation(),e.stopPropagation());const t=_.UtilDom.isCommandOrControlPressed(e)&&!e.shiftKey;if(t){const t=e.key.toLowerCase();t in this.panes&&(this.panes[t].focus(),e.preventDefault(),e.stopImmediatePropagation(),e.stopPropagation())}"o"===e.key&&t&&(e.preventDefault(),e.stopImmediatePropagation(),e.stopPropagation()),"s"===e.key&&t&&(e.preventDefault(),e.stopImmediatePropagation(),e.stopPropagation())}))}localize(){const e=document.getElementsByClassName("l10n");for(const n of e){const e=n.id,i=document.getElementById(e);if(null===i)continue;const o=i.dataset.key,r=i.textContent;var t;if(null!=o)t=o;else{if(null==r){c.default.w("Warning",`app.localize element[${e}] no textContent.`);continue}t=r,i.dataset.key=t}const s=i.dataset.context;if(void 0===s){c.default.w("Warning",`app.localize element[${e}] data-context not exists.`);continue}const a=y.T.t(t,s);i.textContent=a}const n=document.getElementsByClassName("title-l10n");for(const e of n){const t=e.id,n=document.getElementById(t);if(null===n)continue;const i=n.title;if(null===i)continue;const o=n.dataset.context;if(void 0===o)continue;const r=y.T.t(i,o);n.title=r}}}},43:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AppConfig=void 0;const i=n(165);class o{constructor(){this._misc_locale="",this.misc_pane1_width=70,this.misc_pane2_width=30,this.misc_display_input_height=65,this.misc_monitor_height=35,this.main_font_size=24,this.input_font_size=20,this.input_parentheses_1="",this.input_parentheses_2="",this.input_parenthesesShift_1="",this.input_parenthesesShift_2="",this.monitor_font_size=14,this.note_font_size=14,this.fkey_font_size=14}getLocale(){return""===this._misc_locale?i.T.getBrowserLocale():this._misc_locale}setLocale(e){e===i.T.getBrowserLocale()?this._misc_locale="":this._misc_locale=e}getParentheses1_Default(){return i.T.t("“","Config|Input")}getParentheses2_Default(){return i.T.t("”","Config|Input")}getParenthesesShift1_Default(){return i.T.t("(","Config|Input")}getParenthesesShift2_Default(){return i.T.t(")","Config|Input")}getParentheses1(){return""===this.input_parentheses_1?this.getParentheses1_Default():this.input_parentheses_1}setParentheses1(e){if(e===this.getParentheses1_Default()){if(""===this.input_parentheses_1)return!1;this.input_parentheses_1=""}else{if(this.input_parentheses_1===e)return!1;this.input_parentheses_1=e}return!0}getParentheses2(){return""===this.input_parentheses_2?this.getParentheses2_Default():this.input_parentheses_2}setParentheses2(e){if(e===this.getParentheses2_Default()){if(""===this.input_parentheses_2)return!1;this.input_parentheses_2=""}else{if(this.input_parentheses_2===e)return!1;this.input_parentheses_2=e}return!0}getParenthesesShift1(){return""===this.input_parenthesesShift_1?this.getParenthesesShift1_Default():this.input_parenthesesShift_1}setParenthesesShift1(e){if(e===this.getParenthesesShift1_Default()){if(""===this.input_parenthesesShift_1)return!1;this.input_parenthesesShift_1=""}else{if(this.input_parenthesesShift_1===e)return!1;this.input_parenthesesShift_1=e}return!0}getParenthesesShift2(){return""===this.input_parenthesesShift_2?this.getParenthesesShift2_Default():this.input_parenthesesShift_2}setParenthesesShift2(e){if(e===this.getParenthesesShift2_Default()){if(""===this.input_parenthesesShift_2)return!1;this.input_parenthesesShift_2=""}else{if(this.input_parenthesesShift_2===e)return!1;this.input_parenthesesShift_2=e}return!0}static get data(){return void 0===o.configNow&&(o.configNow=new o),o.configNow}static tryApplyNewData(e){for(var t of(this.configNow=new o,Object.keys(e)))t in this.configNow&&typeof this.configNow[t]==typeof e[t]&&(this.configNow[t]=e[t]);return!0}static trySetJSON(e){const t=JSON.parse(e);return this.tryApplyNewData(t)}static getJSON(){return JSON.stringify(o.data)}static resetAll(){o.configNow=new o}}t.AppConfig=o,o.configNow=void 0},144:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ContentType=t.ContentClass=t.ContentToSendClass=void 0;const i=n(882);class o{constructor(e,t,n){this.seqCount=++o.counter,this.sendTimeCount=Date.now(),this.senderName=e,this.messageType=t,this.messageBody=n}}t.ContentToSendClass=o,o.counter=0,t.ContentClass=class{constructor(){this.seqCount=0,this.sendTimeCount=0,this.senderName="",this.messageType="",this.messageBody="",this.senderID="",this.receiveTimeCount=Date.now()}static fromAny(e,t){return null==t?null:i.Util.isNumber(t.seqCount)&&i.Util.isNumber(t.sendTimeCount)&&i.Util.isString(t.senderName)&&i.Util.isString(t.messageType)&&i.Util.isString(t.messageBody)?(t.receiveTimeCount=Date.now(),t.senderID=e,t):null}static fromSendData(e,t){const n=t;return n.senderID=e,n.receiveTimeCount=t.sendTimeCount,n}},t.ContentType={LOGIN:"L",RESPONSE:"R",DISPLAY:"D",MONITOR:"M",NOTE:"N",LOGOFF:"F"}},795:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.DialogConfig=void 0;const o=n(165),r=n(43),s=n(359),a=i(n(110)),c=n(882),u=i(n(326));t.DialogConfig=class{constructor(){this.container=document.getElementById("config-container"),this.pane=document.getElementById("config"),this.buttonReset=document.getElementById("config-reset"),this.buttonCopyUri=document.getElementById("config-copy-uri"),this.buttonOK=document.getElementById("config-button-ok"),this.buttonCancel=document.getElementById("config-button-cancel"),this.onSetClicked=()=>{},this.onResetClicked=()=>{},this.setTitle(o.T.t("Config","Config")),this.buttonReset.addEventListener("click",(e=>{this.onResetClicked()})),this.buttonCopyUri.addEventListener("click",(e=>{this.copyURI()})),this.buttonOK.addEventListener("click",(e=>{this.dialogToConfig(),this.hideDialog(),this.onSetClicked()})),this.buttonCancel.addEventListener("click",(e=>{this.hideDialog()}))}copyURI(){const e=encodeURIComponent(u.default.getPassword()),t=encodeURIComponent(u.default.getRoomName()),n=c.Util.beforeOf(location.href,"?")+`?p=${e}&${t}`;navigator.clipboard.writeText(n).then().catch((e=>alert(o.T.t("Can not copy URI.","General")+" : "+e)))}setTitle(e){}showDialog(){this.configToDialog(),s.UtilDom.show(this.container)}hideDialog(){s.UtilDom.hide(this.container)}configToDialog(){const e=this.pane.getElementsByTagName("input"),t=e.length;for(var n=0;n<t;n++){const t=e[n];if(!t.id.startsWith("config_"))continue;const o=t.id.substr(7);if(null!=r.AppConfig.data[o])"text"===t.type||"number"===t.type||"color"===t.type?e[n].value=r.AppConfig.data[o].toString():"checkbox"===t.type?!0===r.AppConfig.data[o]?e[n].checked=!0:!1===r.AppConfig.data[o]?e[n].checked=!1:a.default.w("Warning",`configToDialog checkbox item --- not boolean [${t.id}]`):a.default.w("Warning",`configToDialog type not found id:${o}`);else if(null!=r.AppConfig.data[t.name]){const o=r.AppConfig.data[t.name];if("radio"===t.type){var i=!1;switch(typeof o){case"string":i=o===t.value;break;case"number":i=o===Number(t.value);break;case"boolean":i=o===("true"===t.value.toLowerCase())}i&&(e[n].checked=!0)}else a.default.w("Warning",`configToDialog type not found name:${t.name} (id:${t.id})`)}else a.default.w("Warning",`configToDialog assign failed id:${t.id} name:${t.name}`)}}dialogToConfig(){const e=this.pane.getElementsByTagName("input"),t=e.length;for(var n=0;n<t;n++)if(e[n].id.startsWith("config_")){var i="";if("radio"===e[n].type){if(!e[n].checked)continue;i=e[n].name}else i=e[n].id.substr(7);if(""===i||void 0!==r.AppConfig.data[i])if("string"==typeof r.AppConfig.data[i]||r.AppConfig.data[i]instanceof String)r.AppConfig.data[i]!==e[n].value&&(r.AppConfig.data[i]=e[n].value);else if("number"==typeof r.AppConfig.data[i]||r.AppConfig.data[i]instanceof Number){const t=Number(e[n].value);if(null==t)continue;r.AppConfig.data[i]!==t&&(r.AppConfig.data[i]=t)}else"boolean"==typeof r.AppConfig.data[i]||r.AppConfig.data[i]instanceof Boolean?"checkbox"===e[n].type?r.AppConfig.data[i]!==e[n].checked&&(r.AppConfig.data[i]=e[n].checked):a.default.w("Warning",`config [${i}] matched non-checkbox input (id=${e[n].id})`):a.default.w("Warning",`configToDialog assign failed : [${e[n].id}]`);else a.default.w("Warning",`dialogToConfig not found : key=${i} element:${e[n].id}`)}}}},222:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(359),r=i(n(487));t.default=class{constructor(){this.dialogLogin=document.getElementById("login"),this.roomRow=document.getElementById("loginTable_roomRow"),this.nameRow=document.getElementById("loginTable_nameRow"),this.passRow=document.getElementById("loginTable_passRow"),this.roomInput=document.getElementById("login-input-room"),this.nameInput=document.getElementById("login-input-name"),this.passInput=document.getElementById("login-input-pass"),this.buttonLogin=document.getElementById("login-button"),this.downloadPane=document.getElementById("loginDialog_log_download_pane"),this.buttonDownload=document.getElementById("loginDialog_log_download"),this.buttonDownloadNote=document.getElementById("loginDialog_note_download"),this.loginCondition=0,this.onLoginClick=e=>{},this.onDownloadMain=()=>{},this.onDownloadNote=()=>{},this.setEvents(),this.updateState()}setLoginCondition(e){this.loginCondition=e,this.updateState()}setEvents(){this.buttonLogin.addEventListener("click",(e=>{const t=new r.default;t.room=this.roomInput.value,t.name=this.nameInput.value,t.pass=this.passInput.value,this.hideDialog(),this.onLoginClick(t)})),this.buttonDownload.addEventListener("click",(e=>{this.onDownloadMain()})),this.buttonDownloadNote.addEventListener("click",(e=>{this.onDownloadNote()})),this.dialogLogin.addEventListener("change",(e=>{this.updateState()})),this.dialogLogin.addEventListener("input",(e=>{this.updateState()})),this.dialogLogin.addEventListener("paste",(e=>{this.updateState()}))}updateState(){!1===o.UtilDom.isDisplayed(this.roomRow)&&!1===o.UtilDom.isDisplayed(this.nameRow)&&!1===o.UtilDom.isDisplayed(this.passRow)&&(this.buttonLogin.disabled=!1);var e=!0;o.UtilDom.isDisplayed(this.roomRow)&&(this.roomInput.value.length<1&&(e=!1),this.roomInput.validationMessage.length>0&&(e=!1)),o.UtilDom.isDisplayed(this.nameRow)&&this.nameInput.value.length<1&&(e=!1),this.loginCondition<1&&(e=!1),this.buttonLogin.disabled=!e}setRoom(e){this.roomInput.value=e}setName(e){this.nameInput.value=e}setPassword(e){this.passInput.value=e}showDialog(e=!1,t=!1){!0===e?o.UtilDom.displayOn(this.buttonDownload):o.UtilDom.displayOff(this.buttonDownload),!0===t?o.UtilDom.displayOn(this.buttonDownloadNote):o.UtilDom.displayOff(this.buttonDownloadNote),o.UtilDom.show(this.dialogLogin),this.updateState(),this.focusMe()}isShown(){return o.UtilDom.isShown(this.dialogLogin)}focusMe(){const e=o.UtilDom.isDisplayed(this.roomRow),t=o.UtilDom.isDisplayed(this.nameRow);e?this.roomInput.focus():t?this.nameInput.focus():this.buttonLogin.focus()}hideDialog(){o.UtilDom.hide(this.dialogLogin)}showRoom(){this.roomInput.required=!0,o.UtilDom.displayOn(this.roomRow,"table-row")}hideRoom(){this.roomInput.required=!1,o.UtilDom.displayOff(this.roomRow)}showName(){this.nameInput.required=!0,o.UtilDom.displayOn(this.nameRow,"table-row")}hideName(){this.nameInput.required=!1,o.UtilDom.displayOff(this.nameRow)}showPass(){this.passInput.required=!0,o.UtilDom.displayOn(this.passRow,"table-row")}hidePass(){this.passInput.required=!1,o.UtilDom.displayOff(this.passRow)}}},263:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(359);t.default=class{constructor(){this.dialog=document.getElementById("notify"),this.title=document.getElementById("notify-title"),this.message=document.getElementById("notify-message"),this.buttonPane=document.getElementById("notify-buttons"),this.okButton=document.getElementById("notify-ok-button"),this.onOkClick=()=>{},this.okButton.addEventListener("click",(()=>{this.hideDialog(),this.onOkClick(),this.resetOkEvents()}))}resetOkEvents(){this.onOkClick=()=>{}}showDialog(e,t){this.title.textContent=e,this.message.textContent=t,i.UtilDom.show(this.dialog)}hideDialog(){i.UtilDom.hide(this.dialog)}}},580:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Downloader=void 0;class n{constructor(){}static start(e,t){this.dlLink.download=e,this.dlLink.href=URL.createObjectURL(new Blob([t],{type:"text/plain"})),this.dlLink.click()}}t.Downloader=n,n.dlLink=document.getElementById("file-download"),t.default=class{constructor(e){this.onAbort=(e,t)=>{},this.onError=(e,t)=>{},this.onLoad=(e,t)=>{},this.opener=document.getElementById(e),this.opener.onchange=e=>{var t;if(1===(null===(t=this.opener.files)||void 0===t?void 0:t.length)){const e=new FileReader,t=this.opener.files[0];e.onabort=e=>{this.onAbort(e,t)},e.onerror=e=>{this.onError(e,t)},e.onload=e=>{this.onLoad(e,t)},e.readAsText(t)}}}openDialogAndReadFile(e){null!=e&&(this.opener.accept=e),this.opener.click()}}},607:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=i(n(752));document.addEventListener("DOMContentLoaded",(()=>{new o.default}))},110:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(882);t.default=class{static w(e,t){const n=i.Util.getNowUTCTimeString();console.log(`${n} [${e}] ${t}`)}}},487:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});class n{constructor(){this.room="",this.name="",this.pass=""}static clone(e){const t=new n;return t.room=e.room,t.name=e.name,t.pass=e.pass,t}}t.default=n},65:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.MekikuCommEvents=void 0;const o=i(n(571)),r=i(n(110)),s=n(144),a=i(n(487)),c=n(882);t.MekikuCommEvents=class{constructor(){this.onPeerIdAcquired=e=>{},this.onPeerError=e=>{},this.onReceived=e=>{},this.onJoinedRoom=()=>{},this.onLeftRoom=()=>{},this.onSomeoneJoined=e=>{},this.onSomeoneLeft=e=>{},this.logger=e=>{}}};class u{constructor(){this.debugLevel=2,this.handleOpen=e=>{}}}t.default=class{constructor(e){this.onPeerIdAcquired=e=>{},this.onPeerError=e=>{},this.onReceived=e=>{},this.onJoinedRoom=()=>{},this.onLeftRoom=()=>{},this.onSomeoneJoined=e=>{},this.onSomeoneLeft=e=>{},this.logger=e=>{},null!=e&&(this.onPeerIdAcquired=e.onPeerIdAcquired,this.onPeerError=e.onPeerError,this.onJoinedRoom=e.onJoinedRoom,this.onLeftRoom=e.onLeftRoom,this.onReceived=e.onReceived,this.onSomeoneJoined=e.onSomeoneJoined,this.onSomeoneLeft=e.onSomeoneLeft,this.logger=e.logger)}isOpen(){var e;return!0===(null===(e=this.peer)||void 0===e?void 0:e.open)}getInfo(){return null==this.info?void 0:a.default.clone(this.info)}isInRoom(){return null!=this.info}open(e,t){var n,i,r;!0===(null===(n=this.peer)||void 0===n?void 0:n.open)&&this.peer.destroy(),this.openOption={...new u,...t};const s={key:e,debug:null!==(i=this.openOption.debugLevel)&&void 0!==i?i:1};null!=this.openOption.id?(Math.min(Math.max(null!==(r=this.openOption.debugLevel)&&void 0!==r?r:1,0),3),this.peer=new o.default(this.openOption.id,s)):this.peer=new o.default(s),this.setPeerEvents(this.peer)}async joinRoom(e,t="sfu"){if(null==this.peer)throw r.default.w("Error","peer is null."),new Error("peer is null");if(!c.Util.isRoomNameLegit(e.room))throw r.default.w("Error",`Illegal room name:[${e.room}]`),new Error("Illegal room name");const n="sfu"===(i=t)||"mesh"===i?i:"sfu";var i;const o=await this.makeRoomName(e.room,e.pass);let s;if(s="mesh"===n?this.peer.joinRoom(o,{mode:"mesh"}):this.peer.joinRoom(o,{mode:"sfu"}),null==s)throw r.default.w("Error","joinRoom failed."),new Error("joinRoom failed.");this.info=a.default.clone(e),this.room=s,this.setRoomEvents(this.room)}async makeRoomName(e,t){return""===t?e:e+"*"+await c.Util.digestMessage(t)}leaveRoom(){null!=this.room&&this.room.close()}send_room(e){var t,n;null===(t=this.info)||void 0===t||t.name,null!=this.room&&(null===(n=this.room)||void 0===n||n.send(e))}setPeerEvents(e){e.on("open",(e=>{var t;null!=(null===(t=this.openOption)||void 0===t?void 0:t.handleOpen)&&(this.openOption.handleOpen(e),delete this.openOption),this.onPeerIdAcquired(e)})),e.on("close",(()=>{})),e.on("connection",(e=>{})),e.on("error",(e=>{r.default.w("Error",`peer error (${e.type}) <${e.message}>`),this.onPeerError(e)}))}setRoomEvents(e){e.on("open",(()=>{this.onJoinedRoom()})),e.on("peerJoin",(e=>{this.onSomeoneJoined(e)})),e.on("peerLeave",(e=>{this.onSomeoneLeft(e)})),e.on("data",(({src:e,data:t})=>{Date.now();const n=s.ContentClass.fromAny(e,t);null!=n&&this.onReceived(n)})),e.on("close",(()=>{var e;delete this.room,delete this.info,null===(e=this.peer)||void 0===e||e.destroy(),this.onLeftRoom()}))}}},877:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.MemberManager=t.MemberInfoClass=void 0;const o=i(n(110)),r=n(441);class s{constructor(e){this.id=e,this.lastReceived=Date.now(),this.lastSequence=0}static fromContent(e){const t=new s(e.senderID);return t.name=e.senderName,t.lastReceived=e.sendTimeCount,t.lastSequence=e.seqCount,t}}t.MemberInfoClass=s;class a{constructor(){this.members=[],this.colorManager=new r.ColorManager}getCount(){return this.members.length}getColor(e){const t=this.colorManager.color(e);if(null!=t)return r.ColorManager.toString(t)}getMember(e){const t=this.members.find((t=>t.id===e));if(null!=t)return{...t}}enumerateMembers(){return this.members.map((e=>{var t;return null!==(t=e.name)&&void 0!==t?t:"?"}))}update(e){var t,n;const i=this.members.findIndex((t=>t.id===e.id));if(i<0)return this.colorManager.regist(e.id),this.members.push(e),{v1:-1,v2:e};{const r=this.members[i];e.lastSequence!==r.lastSequence+1&&o.default.w("Warning",`Member [${e.id}](${e.name}) seq jump from ${r.lastSequence} to ${e.lastSequence}`);const s=null!==(n=null!==(t=e.inputContent)&&void 0!==t?t:r.inputContent)&&void 0!==n?n:"",a={...e,inputContent:s};return this.members=this.members.map((t=>t.id===e.id?a:t)),{v1:i,v2:a}}}unregist(e){this.colorManager.unregist(e);const t=this.members.findIndex((t=>t.id===e));if(t<0)return{v1:t,v2:null};const n=this.members[t];return this.members=this.members.filter((t=>t.id!==e)),{v1:t,v2:n}}clear(){this.colorManager.clear(),this.members=[]}static get data(){return void 0===a.instance&&(a.instance=new a),a.instance}}t.MemberManager=a,a.instance=void 0},90:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(359);t.default=class{constructor(){this.pane=document.getElementById("pane1")}show(){i.UtilDom.displayOn(this.pane,"flex")}hide(){i.UtilDom.displayOff(this.pane)}}},152:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(359);t.default=class{constructor(){this.pane=document.getElementById("pane2")}show(){i.UtilDom.displayOn(this.pane,"flex")}hide(){i.UtilDom.displayOff(this.pane)}}},478:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{constructor(){this.control=document.getElementById("control"),this.back=document.getElementById("appBackToChat"),this.config=document.getElementById("appConfig"),this.logout=document.getElementById("appLogout"),this.controlChat=document.getElementById("controlOnChat"),this.showNoteChat=document.getElementById("appShowNoteOnChat"),this.configChat=document.getElementById("appConfigOnChat"),this.logoutChat=document.getElementById("appLogoutOnChat"),this.onConfig=()=>{},this.onLogout=()=>{},this.onShowNote=()=>{},this.onBackToChat=()=>{},this.back.addEventListener("click",(e=>{this.onBackToChat()})),this.config.addEventListener("click",(e=>{this.onConfig()})),this.logout.addEventListener("click",(e=>{this.onLogout()})),this.showNoteChat.addEventListener("click",(e=>{this.onShowNote()})),this.configChat.addEventListener("click",(e=>{this.onConfig()})),this.logoutChat.addEventListener("click",(e=>{this.onLogout()}))}}},771:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PaneFkey=void 0;const i=n(43),o=n(882),r=n(165);t.PaneFkey=class{constructor(){this.pane=document.getElementById("fkey"),this.titlebar=document.getElementById("fkey-title"),this.outerTable=document.getElementById("fkey-table"),this.localize(),this.fkeys=[document.getElementById("fkey01"),document.getElementById("fkey02"),document.getElementById("fkey03"),document.getElementById("fkey04"),null,null,null,null,null],this.configToScreen()}getName(){return"PaneFkey"}applyFont(e){e.style.fontSize=i.AppConfig.data.fkey_font_size+"pt"}configToScreen(){const e=this.outerTable.getElementsByClassName("fkey-label");for(var t of e){const e=document.getElementById(t.id);null!==e&&this.applyFont(e)}const n=this.outerTable.getElementsByClassName("fkey-input");for(var i of n){const e=document.getElementById(i.id);null!==e&&this.applyFont(e)}const o=this.outerTable.getElementsByClassName("fkey-text-readonly");for(var r of o){const e=document.getElementById(r.id);null!==e&&this.applyFont(e)}}getFKey(e){if(e>=0&&e<this.fkeys.length){const t=this.fkeys[e];if(null!=t)return t.value}return""}localize(){this.setTitle(r.T.t("Shortcut","Fkey")+o.Util.getShortcutParenthesized("F"))}setTitle(e){this.titlebar.textContent=e}updateConfig(){this.configToScreen()}setPaneToConfig(){}focus(){var e;null===(e=this.fkeys[0])||void 0===e||e.focus()}}},150:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.PaneInput=void 0;const o=n(43),r=n(359),s=n(165),a=n(882),c=i(n(326)),u=i(n(110)),d=n(16);t.PaneInput=class{constructor(){this.pane=document.getElementById("input"),this.input1Vjs=document.getElementById("input1"),this.voiceButton=document.getElementById("input-by-voice"),this.voiceStartLabel=document.getElementById("voice-start"),this.voiceStopLabel=document.getElementById("voice-stop"),this.sendButton=document.getElementById("send-message"),this.warning=document.getElementById("warning-in-input"),this.warningMessage=document.getElementById("warning-in-input-message"),this.warningHide=document.getElementById("warning-in-input-hide"),this.isSpeechRecognising=!1,this.isSpeechRecognitionAvailable=!0,this.getFkey=e=>"",this.doOnInput=e=>{},this.lastSendInput="",this.doOnEnter=e=>{},this.localize(),this.input1Vjs.addEventListener("input",(e=>{this.onInput(this.input1Vjs.value)})),this.input1Vjs.addEventListener("keydown",(e=>{this.onType(this.input1Vjs,e)})),this.sendButton.addEventListener("click",(e=>{this.sendMessage(this.input1Vjs)})),this.warningHide.addEventListener("click",(e=>{this.hideWarning()})),this.configToScreen(),this.recognizer=new d.SpeechRecognitionWrap,null==this.recognizer||!0!==this.recognizer.isAvailable()||a.Util.isLine()?this.hideVoiceUIs():(u.default.w("info",`SpeechRecognition lang=${this.recognizer.lang} navigator.lang=${navigator.language} langs=[${navigator.languages}]`),this.setupRecognizer())}getName(){return"PaneInput"}setGetFkey(e){this.getFkey=t=>e(t)}setDoOnInput(e){this.doOnInput=t=>e(t)}onInput(e){e!==this.lastSendInput&&(this.lastSendInput=e,this.doOnInput(e))}setDoOnEnter(e){this.doOnEnter=t=>e(t)}onEnter(e){this.doOnEnter(e)}alertAndRecommendBrowser(){const e=a.Util.isIPhone()?s.T.t("iPhone's own voice input is recommended.","General"):a.Util.isIPad()?s.T.t("Voice Input is available on Safari.","General"):s.T.t("Voice Input is available on Chrome.","General"),t=s.T.t("You cannot use Voice Input on this browser.","General");window.alert(t+"\n\n"+e)}setupRecognizer(){this.recognizer.ondetectunavailable=()=>{u.default.w("error","Speech recognition : fatal error. seems unavailable."),this.hideVoiceUIs(),this.alertAndRecommendBrowser()},this.recognizer.continuous=!1,this.recognizer.interimResults=!1,this.recognizer.onstart=()=>{},this.recognizer.onend=()=>{},this.recognizer.onaudiostart=()=>{},this.recognizer.onaudioend=()=>{},this.recognizer.onsoundstart=()=>{},this.recognizer.onsoundend=()=>{},this.recognizer.onspeechstart=()=>{},this.recognizer.onspeechend=()=>{},this.recognizer.onnomatch=()=>{u.default.w("error","Speech recognition : no-match"),this.setGuiAsTyping(),this.showWarning(s.T.t("Cannot recognize","Input"))},this.recognizer.onerror=e=>{u.default.w("error",`Speech recognition error : ${e.error}`),this.setGuiAsTyping(),this.recognizer.isAvailable()&&this.showWarning(s.T.t("Error in speech recognition","Input"))},this.recognizer.onresult=e=>{let t="";for(let n=0;n<e.results.length;n++)t+=e.results[n][0].transcript;if(a.Util.isIPhone()&&0==(1&t.length)){const e=t.substring(0,t.length/2);e===t.substring(t.length/2)&&(t=e)}const n=s.T.t(".","Input");/\P{P}$/u.test(t)&&(t+=n),this.addWord(t),this.onInput(this.input1Vjs.value),this.setGuiAsTyping()},this.voiceButton.addEventListener("click",(e=>{this.isSpeechRecognising?(this.setGuiAsTyping(),this.recognizer.stop()):(this.setGuiAsSpeechRecognising(),this.recognizer.start())}))}addWord(e){this.input1Vjs.value+=e;const t=this.input1Vjs.value.length;this.input1Vjs.blur(),this.input1Vjs.setSelectionRange(t,t),this.input1Vjs.focus()}setGuiAsSpeechRecognising(){this.isSpeechRecognising=!0,this.voiceStartLabel.classList.add("noshow"),this.voiceStopLabel.classList.remove("noshow")}setGuiAsTyping(){this.isSpeechRecognising=!1,this.voiceStartLabel.classList.remove("noshow"),this.voiceStopLabel.classList.add("noshow")}showWarning(e){this.warningMessage.textContent=e,r.UtilDom.show(this.warning),this.warningHide.focus()}hideWarning(){r.UtilDom.hide(this.warning)}onType(e,t){if(t.keyCode!==r.UtilDom.KEY_CTRL){if(t.keyCode===r.UtilDom.KEY_ENTER)this.sendMessage(e),t.preventDefault(),t.stopImmediatePropagation();else if(t.keyCode===r.UtilDom.KEY_ESC)this.clearInput(e),t.preventDefault(),t.stopImmediatePropagation();else{const n=r.UtilDom.getCtrlOrFKeyNumber(t)-1;if(n>=0&&n<7){const i=this.getFkey(n);i.length>0&&this.replacePart(e,i),t.preventDefault(),t.stopImmediatePropagation()}else 7===n&&(!0!==t.shiftKey?this.enclose(e,o.AppConfig.data.getParentheses1(),o.AppConfig.data.getParentheses2()):this.enclose(e,o.AppConfig.data.getParenthesesShift1(),o.AppConfig.data.getParenthesesShift2()),t.preventDefault(),t.stopImmediatePropagation())}this.onInput(e.value)}}clearAllInput(){this.clearInput(this.input1Vjs)}sendMessage(e){""!==e.value&&e.value!==this.makeInitialPhrase()&&(this.onEnter(e.value),this.clearInput(e))}clearInput(e){e.value=this.makeInitialPhrase()}makeInitialPhrase(){return c.default.getName()+s.T.t(" : ","Chat")}setupAsNarrowScreen(){""===this.input1Vjs.value&&this.clearInput(this.input1Vjs)}configToScreen(){const e=a.Util.isIOS()?Math.max(o.AppConfig.data.main_font_size,12):o.AppConfig.data.main_font_size;this.input1Vjs.style.fontSize=e+"pt",this.voiceButton.style.fontSize=e+"pt",this.sendButton.style.fontSize=Math.floor(.7*e)+"pt",this.warningMessage.style.fontSize=Math.floor(.5*e)+"pt"}isVoiceInputAvailable(){return this.isSpeechRecognitionAvailable}hideVoiceUIs(){this.isSpeechRecognitionAvailable=!1,this.voiceButton.disabled=!0,r.UtilDom.displayOff(this.voiceButton)}setPaneToConfig(){}replacePart(e,t){const n=e.selectionStart||0,i=e.selectionEnd||0,o=e.value.substring(0,n),r=e.value.substring(i);e.value=o+t+r;const s=n+t.length;e.blur(),e.setSelectionRange(s,s),e.focus()}enclose(e,t,n){const i=e.selectionStart||0,o=e.selectionEnd||0,r=e.value.length;e.value=t+e.value+n;var s=i+t.length,a=o+t.length;i===o&&o===r&&(s+=n.length,a+=n.length),e.blur(),e.setSelectionRange(s,a),e.focus()}updateConfig(){this.configToScreen()}focus(){this.input1Vjs.focus()}localize(){this.input1Vjs.placeholder=s.T.t("Type your message here, then hit enter.","Input")}}},900:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PaneMain=void 0;const i=n(43),o=n(144),r=n(877),s=n(165);t.PaneMain=class{constructor(){this.pane=document.getElementById("display"),this.contents=[],this.configToScreen()}getName(){return"PaneMain"}getMainLog(){return this.contents.map((e=>e.messageBody))}hasMainLog(){return this.contents.length>0}makeSpan(e){const t=document.createElement("span");return t.textContent=e,t}makeAnchor(e,t){const n=document.createElement("a");return n.href=e,n.textContent=t||e,n.rel="noreferrer noopener",n.target="_blank",n}makeMessageElement(e){this.contents.push(e);const t=document.createElement("p");t.classList.add("message");const n=new RegExp("https?://[A-Za-z0-9\\-._~:/?#[\\]@!$&'()*+,;=%]+","g"),i=e.messageBody;let o=n.exec(i),r=0;for(;null!==o;)o.index>r&&t.appendChild(this.makeSpan(i.substring(r,o.index))),t.appendChild(this.makeAnchor(o[0])),r=n.lastIndex,o=n.exec(i);return t.appendChild(this.makeSpan(i.substring(r))),t}addItemToDisplayPane(e){const t=this.pane.scrollTop+this.pane.clientHeight-this.pane.scrollHeight;this.pane.appendChild(e),t>=-this.pane.clientHeight&&this.goBottom()}goBottom(){this.pane.scrollTop=this.pane.scrollHeight-this.pane.clientHeight}addMyNewItem(e){const t=this.makeMessageElement(e);this.addItemToDisplayPane(t)}addMessageMemberAttended(e){const t=new o.ContentClass;t.senderName=e,t.messageType=o.ContentType.LOGIN,t.messageBody=`( ${s.T.t("login","Chat")} : ${e} )`;const n=this.makeMessageElement(t);this.addItemToDisplayPane(n)}addMessageMemberExited(e){const t=new o.ContentClass;t.senderName=e,t.messageType=o.ContentType.LOGOFF,t.messageBody=`( ${s.T.t("logout","Chat")} : ${e} )`;const n=this.makeMessageElement(t);this.addItemToDisplayPane(n)}addNewItem(e){const t=this.makeMessageElement(e),n=r.MemberManager.data.getColor(e.senderID);null!=n&&""!==n&&(t.style.color=n),this.addItemToDisplayPane(t)}configToScreen(){this.pane.style.fontSize=i.AppConfig.data.main_font_size+"pt"}updateConfig(){this.configToScreen()}setPaneToConfig(){}focus(){}}},702:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PaneMonitor=void 0;const i=n(43),o=n(877),r=n(165),s=n(359),a=n(144);t.PaneMonitor=class{constructor(){this.onMemberNewJoined=e=>{},this.onMemberLeft=e=>{},this.pane=document.getElementById("monitor"),this.titlebar=document.getElementById("monitor-title"),this.table=document.getElementById("monitorTable"),this.fontChecker=document.getElementById("monitorFontChecker"),this.header1=document.getElementById("monitorHeader1"),this.header2=document.getElementById("monitorHeader2"),this.memberList=document.getElementById("member-list"),this.IX_NAME=0,this.IX_INPUT=1,this.N_COLUMNS=2,this.localize(),this.configToScreen()}getName(){return"PaneMonitor"}setOnNewJoined(e){this.onMemberNewJoined=t=>e(t)}setOnLeft(e){this.onMemberLeft=t=>e(t)}updateMember(e,t){let n=o.MemberManager.data.update(e).v1;n<0&&(this.addRow(),this.updateMemberList(),n=o.MemberManager.data.getCount()-1,t.messageType===a.ContentType.LOGIN&&this.onMemberNewJoined(e)),this.updateRow(n,e)}deleteMember(e){const t=o.MemberManager.data.unregist(e);t.v1>=0&&(this.removeRow(t.v1+1),this.updateMemberList(),null!=t.v2&&this.onMemberLeft(t.v2))}clearMembers(){o.MemberManager.data.clear(),this.clearRows(),this.updateMemberList()}updateMemberList(){if(o.MemberManager.data.getCount()<1)this.memberList.textContent=r.T.t("(no attendance)","Monitor");else{const e=o.MemberManager.data.enumerateMembers();this.memberList.textContent=e.join(" ")}}configToScreen(){this.table.style.fontSize=i.AppConfig.data.monitor_font_size+"pt",this.fontChecker.style.fontSize=i.AppConfig.data.monitor_font_size+"pt"}clearRows(){for(;this.table.rows[1];)this.table.deleteRow(1)}addRow(){const e=this.table.insertRow(-1);this.addColumns(e,this.N_COLUMNS)}addColumns(e,t){for(var n=0;n<t;n++){const t=e.insertCell(-1),n=document.createTextNode("");t.appendChild(n)}}removeRow(e){this.table.deleteRow(e)}updateRow(e,t){const n=this.table.rows[e+1],i=n.cells[this.IX_NAME].firstChild,o=null!=t.name?t.name:"noname";i&&(i.data=o),n.cells[this.IX_NAME].title=t.id;const r=n.cells[this.IX_INPUT].firstChild,s=void 0===t.inputContent?"":t.inputContent;if(r){const e=this.seekTextStartForShowAll(s);var a=s.substr(e);r.data=a}this.updateStates()}seekTextStartForShowAll(e){const t=e.length,n=s.UtilDom.getWidth(this.header2);this.fontChecker.textContent=e;var i=s.UtilDom.getWidth(this.fontChecker);if(i<=n)return 0;for(var o=Math.floor(t/2),r=t,a=1,c=0;c<10;c++){if(this.fontChecker.textContent=e.substr(t-o,o),(i=s.UtilDom.getWidth(this.fontChecker))>n?o<r&&(r=o):o>a&&(a=o),r===a+1)return t-a;o=Math.floor((r+a)/2)}return t-a}updateStates(){}updateConfig(){this.configToScreen()}localize(){this.setTitle(r.T.t("Input Monitor","Monitor"))}setTitle(e){this.titlebar.textContent=e}focus(){}}},914:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PaneNote=void 0;const i=n(43),o=n(165);t.PaneNote=class{constructor(){this.pane=document.getElementById("note"),this.titlebar=document.getElementById("note-title"),this.noteText=document.getElementById("note-text"),this.noteStateText=document.getElementById("note-state-text"),this.lastSenderName="",this.onUpdate=e=>{},this.setEvent(),this.localize(),this.configToScreen(),this.updateState()}getName(){return"PaneNote"}hasNote(){return this.noteText.value.length>0}getNote(){return this.noteText.value}getLastSender(){return this.lastSenderName}setEvent(){this.noteText.addEventListener("input",(e=>{var t;this.onUpdate(null!==(t=this.noteText.value)&&void 0!==t?t:""),this.updateState(o.T.t("(yourself)","Note"))}))}updateNote(e,t){const n=this.noteText.selectionStart,i=this.noteText.selectionEnd;this.noteText.value=e,this.updateState(t),this.lastSenderName=t,this.noteText.selectionStart=n,this.noteText.selectionEnd=i}update(e){this.updateNote(e.messageBody,e.senderName)}updateByResponse(e){const t=e.messageBody,n=t.indexOf("\n");n<0||n>=t.length-1||this.updateNote(t.substring(n+1),t.substring(0,n))}updateState(e){this.noteStateText.textContent=e?`${o.T.t("Last update","Note")} : ${e}`:o.T.t("Last update","Note")+" : "}applyStyle(e){e.style.fontSize=i.AppConfig.data.note_font_size+"pt"}configToScreen(){this.applyStyle(this.noteText)}updateConfig(){this.configToScreen()}localize(){this.setTitle(o.T.t("Shared Note","Note"))}setTitle(e){this.titlebar.textContent=e}setPaneToConfig(){}focus(){this.noteText.focus()}}},16:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SpeechRecognitionWrap=void 0;const i=n(43),o=n(882);var r;t.SpeechRecognitionWrap=class{constructor(){this.recognizerState=r.None,this.shouldBeContinuous=!1,this.onaudiostart=()=>{},this.onaudioend=()=>{},this.onend=()=>{},this.onerror=e=>{},this.onnomatch=()=>{},this.onresult=e=>{},this.onsoundstart=()=>{},this.onsoundend=()=>{},this.onspeechstart=()=>{},this.onspeechend=()=>{},this.onstart=()=>{},this.ondetectunavailable=()=>{},this.generateRecognizer()}isAvailable(){return null!=this.recognizer}get lang(){var e;return null===(e=this.recognizer)||void 0===e?void 0:e.lang}set lang(e){var t;null!=(null===(t=this.recognizer)||void 0===t?void 0:t.lang)&&(this.recognizer.lang=e)}get continuous(){var e,t;return o.Util.isIPhone()?this.shouldBeContinuous:null!==(t=null===(e=this.recognizer)||void 0===e?void 0:e.continuous)&&void 0!==t&&t}set continuous(e){var t;this.shouldBeContinuous=e,null!=(null===(t=this.recognizer)||void 0===t?void 0:t.continuous)&&!0!==o.Util.isIPhone()&&(this.recognizer.continuous=e)}get interimResults(){var e,t;return null!==(t=null===(e=this.recognizer)||void 0===e?void 0:e.interimResults)&&void 0!==t&&t}set interimResults(e){var t;null!=(null===(t=this.recognizer)||void 0===t?void 0:t.interimResults)&&(this.recognizer.interimResults=e)}start(){null!=this.recognizer&&this.recognizer.start()}abort(){null!=this.recognizer&&this.recognizer.abort()}stop(){null!=this.recognizer&&this.recognizer.stop()}generateRecognizer(){this.recognizer="SpeechRecognition"in window?new window.SpeechRecognition:"webkitSpeechRecognition"in window?new window.webkitSpeechRecognition:null,null!=this.recognizer&&(this.recognizer.lang=i.AppConfig.data.getLocale(),o.Util.isIPhone()&&(this.recognizer.continuous=!0),this.recognizer.onstart=()=>{this.recognizerState|=r.Start,this.onstart()},this.recognizer.onend=()=>{this.recognizerState&=~r.Start,this.onend()},this.recognizer.onaudiostart=()=>{this.recognizerState|=r.AudioStart,this.onaudiostart()},this.recognizer.onaudioend=()=>{this.recognizerState&=~r.AudioStart,this.onaudioend()},this.recognizer.onsoundstart=()=>{this.recognizerState|=r.SoundStart,this.onsoundstart()},this.recognizer.onsoundend=()=>{this.recognizerState&=~r.SoundStart,this.onsoundend()},this.recognizer.onspeechstart=()=>{this.recognizerState|=r.SpeechStart,this.onspeechstart()},this.recognizer.onspeechend=()=>{this.recognizerState&=~r.SpeechStart,this.onspeechend()},this.recognizer.onnomatch=()=>{this.onnomatch()},this.recognizer.onresult=e=>{this.onresult(e),o.Util.isIPhone()&&!1===this.shouldBeContinuous&&e.results[e.results.length-1].isFinal&&this.recognizer.abort()},this.recognizer.onerror=e=>{this.recognizer.abort(),this.recognizer=null,this.recognizerState===r.Start?this.ondetectunavailable():this.generateRecognizer(),this.onerror(e)})}},function(e){e[e.None=0]="None",e[e.Start=1]="Start",e[e.AudioStart=2]="AudioStart",e[e.SoundStart=4]="SoundStart",e[e.SpeechStart=8]="SpeechStart"}(r||(r={}))},165:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.T=void 0;const i=n(882);class o{constructor(){this._locale="",this._failed=[],this._dicts={},this._dict=null,this.initDict()}static data(){return null===o._instance&&(o._instance=new o),o._instance}static t(e,t){const n=o.data().getPhrase(e,t);return""===n?e:(i.Util.isMac()&&n.replace("Ctrl+","Cmd+"),n)}static a(e,t){return o.data().analyze(e,t)}static matchLocale(e){return o.data()._matchLocale(e)}static getBrowserLocale(){return window.navigator.languages&&window.navigator.languages[0]||window.navigator.language}static setLocale(e){return o.data().setInnerLocale(e),!0}static getLocales(){var e=["en"];for(var t of Object.keys(o.data()._dicts))e.push(t);e.sort();var n=[];for(var t of e){if("en"===t){n.push({v1:"en",v2:"English"});continue}const e=o.data()._dicts[t];if(void 0===e)continue;const i=e.MyName;if(void 0===i)continue;const r=i.English;void 0!==r&&n.push({v1:t,v2:r})}return n}static getFails(){return o.data().getAllFails()}_matchLocale(e){if("en"===e||"en-US"===e)return"";if(void 0!==this._dicts[e])return e;const t=e.indexOf("-");if(t<=0)return"";const n=e.substr(0,t);return void 0!==this._dicts[n]?n:""}setInnerLocale(e){this._locale=this._matchLocale(e),""===this._locale?this._dict=null:this._dict=this._dicts[this._locale]}trySetLocale(e){if("en"===e||"en-US"===e)return this._locale="",this._dict=null,!0;const t=this._dicts[e];if(null!=t)return this._locale=e,this._dict=t,!0;const n=e.indexOf("-");if(n<=0)return!1;const i=e.substr(0,n),o=this._dicts[i];return null!=o&&(this._locale=i,this._dict=o,!0)}analyze(e,t){if(null===this._dict)return`dict===null. return [${e}]`;const n=this._dict[t];if(void 0===n)return`dict[${t}] is undef.`;const i=n[e];return void 0===i?`phrases[${e}] is undef.`:`found [${i}]`}getPhrase(e,t){if(null===this._dict)return e;const n=this._dict[t];if(void 0===n)return this._failed.push({v1:e,v2:t}),e;const i=n[e];return void 0===i?(this._failed.push({v1:e,v2:t}),e):i}getAllFails(){return this._failed}initDict(){this._dicts.ja={MyName:{English:"日本語"},General:{"mekiku-web":"web版mekiku","mk-Chat with Voice":"音声入力つきチャット",OK:"OK",Cancel:"キャンセル",Error:"エラー",Warning:"警告","all files":"全てのファイル","file name":"ファイル名",Subtitler:"入力者",Viewer:"閲覧者","Number of Viewers":"閲覧者数","Error occured on file access.\nIf another application is using it, first quit it.":"ファイルへのアクセスでエラーが発生しました。\n他のプログラムでファイルを開いていたら、そちらを終了してください。","Communication error.":"通信エラーです。",Detail:"詳細","Internet Explorer and old version of Microsoft Edge are not supported.":"Internet Explorerおよび旧版のMicrosoft Edgeでは利用できません。",Note:"メモ表示",Chat:"チャット表示","Can not copy URI.":"URLをコピーできませんでした。","You cannot use Voice Input on this browser.":"このブラウザでは音声入力は使用できません。","Voice Input is available on Chrome.":"Chromeブラウザなら音声入力が使えます。","Voice Input is available on Safari.":"Safariブラウザなら音声入力が使えます。","iPhone's own voice input is recommended.":"iPhone自身の音声入力機能をお勧めします。"},Input:{"Input Window":"入力ウインドウ","Type your message here, then hit enter.":"メッセージを入力して、Enterキーで送信","Cannot recognize":"認識できません","Error in speech recognition":"音声認識エラーです",".":"。"},Chat:{Chat:"連絡窓",Start:"カウントダウン開始",Halt:"カウントダウン停止",Reset:"残り時刻リセット","Increase Timer By A Minute":"タイマー1分延長","Decrease Timer By A Minute":"タイマー1分短縮","0:00":"0：00","30 seconds to next turn.":"30秒前です。"," : ":"／","It's new turn now.":"交代です。","Timer started. Next ":"タイマーを開始しました。通知間隔 ","Timer halted.":"タイマーを停止しました。",login:"ログイン","New viewer":"閲覧者がログイン",logout:"ログアウト","A viewer left":"閲覧者が退室"},Monitor:{"Input Monitor":"入力モニター",name:"名前","current input window":"入力中の内容",connect:"接続","(no attendance)":"（参加者なし）"},PFT:{"PFT (Pre-Formatted Text)":"前ロール","Open (Ctrl+O)":"開く (Ctrl+O)","Save As (Ctrl+S)":"名前をつけて保存 (Ctrl+S)","Next Comment (Ctrl+down)":"次のコメント行へジャンプ (Ctrl+↓)","Previous Comment (Ctrl+up)":"前のコメント行へジャンプ (Ctrl+↑)","Next Window (Ctrl+right)":"次のウインドウへ移動 (Ctrl+→)","Previous Window (Ctrl+left)":"前のウインドウへ移動 (Ctrl+←)","PFT files":"前ロールファイル","UTF-8 PFT files":"UTF-8前ロールファイル","Unicode PFT files":"Unicode前ロールファイル","text files":"テキストファイル"},PftMon:{"PFT Monitor":"前ロールモニター","'s Pre-Formatted Text":"の前ロールをモニター中"},Fkey:{Shortcut:"Fキー","Parenthesize all":"行全体をかっこでくくる",Undo:"入力部へ1回分引く(undo)","(Not available)":"（使用不能）"},Note:{"Shared Note":"共有メモ","Last update":"更新者","(yourself)":"（自分）"},Log:{Log:"ログ"},Login:{Login:"ログイン","LAN card":"LANカード",Name:"名前",Channel:"チャンネル",Group:"班","The network port is occupied by other application.\nSelect another channel and login.":"同じネットワークポートが別のプログラムに使われています。\n別チャンネルを指定して再ログインしてみてください。","Network error occurs. Make sure network connection.":"ネットワークエラーです。接続を再確認してください。","(No Network Available)":"（接続可能なLANがありません）",Room:"ルーム",Viewer:"利用者・閲覧者",Subtitler:"入力者（要約筆記者）",Password:"パスワード","Login failed.":"ログインに失敗しました。",Logout:"ログアウト"},Config:{Config:"設定"},"Config|General":{"Font Size":"文字の大きさ","Font Name":"フォント名","Font Color":"文字色",Bold:"太字","Background Color":"背景色",Show:"表示する"},"Config|Misc":{General:"全体的な設定","Re-Login":"LANカードを選んで（再）接続","Full Screen":"全画面化","Select Language":"言語の選択","To make your choice effective, Restart mekiku-M.":"言語選択を有効にするには、mekiku-Mを再起動してください。","Save log":"ログを保存する","Save note":"メモを保存する","Save main log":"表示部のログを保存する","Save chat log":"連絡窓のログを保存する","Startup Settings":"起動時設定","Keep Last Settings":"前回終了時の設定を初期設定にする","Copy URL of this room including password":"このルームのパスワードを含めたURLをコピー"},"Config|Main":{"Main Display":"メイン表示部","Display style":"表示形式",Normal:"通常表示","Full Width":"幅を最大化","Full Window":"ウインドウ内最大化","Line Height":"1行の高さ","Scroll interval per line":"1行のスクロール間隔",msec:"ミリ秒"},"Config|Input":{"Parentheses on F8 press":"F8押下時に囲む文字","Parentheses on Shift+F8 press":"Shift+F8押下時に囲む文字","“":"「","”":"」","(":"（",")":"）"},"Config|Chat":{"Notification Color":"通知時の背景色","Play sound on timer-notifications":"タイマー通知で音を出す"},"Config|Monitor":{"Background Color On Loss":"通信断の際の背景色"},"Config|PFT":{"Background Color (Name)":"前ロール名の背景色","Background Color (Name of Other Panes)":"非選択前ロール名の背景色","Display All":"全ウインドウを表示","Current Window Width":"選択中のウインドウ幅","Same As Others (x1.0)":"他と同じ（1.0倍）","50% wider (x1.5)":"他の5割増（1.5倍）","double (x2.0)":"他の2倍（2.0倍）","triple (x3.0)":"他の3倍（3.0倍）"},"Menu|Menu":{Menu:"メニュー",File:"ファイル",Edit:"編集","Re-Login":"LANカードを選んで（再）接続","Open Settings...":"設定ファイルを開く...","Save Settings As...":"設定に名前をつけて保存...","Config...":"設定...","Reset All Settings":"設定を初期化","Current As Default":"現在の設定を初期設定にする","Full Screen":"全画面化","Version...":"バージョン...",Exit:"終了","mekiku-M settings files":"mekiku-M設定ファイル",Undo:"元に戻す",Cut:"切り取り",Copy:"コピー",Paste:"貼り付け","Select All":"すべて選択"}},this._dicts.th={MyName:{English:"ภาษาไทย"},General:{OK:"OK",Cancel:"ยกเลิก",Error:"ข้อผิดพลาด",Warning:"เตือน","all files":"ไฟล์ทั้งหมด","Error occured on file access.\nIf another application is using it, first quit it.":"เกิดข้อผิดพลาดในการอ่านไฟล์\nถ้าแอพพลิเคชั่นอื่นกำลังใช้ไฟล์นี้\nให้ปิดไฟล์นี้ก่อน"},Input:{"Input Window":"หน้าต่างอินพุท"},Chat:{Chat:"แช็ท",Start:"เริ่ม",Halt:"หยุด",Reset:"ตั้งใหม่","Increase Timer By A Minute":"เพิ่มเวลาเป็น A นาที","Decrease Timer By A Minute":"ลดเวลาเป็น A นาที","0:00":"0:00","30 seconds to next turn.":"อีกสามสิบวิ.จะเริ่มใหม่"," : ":" : ","It's new turn now.":"เริ่มใหม่","Timer started. Next ":"ไทเมอร์เริ่ม ถัดไป ","Timer halted.":"ไทเมอร์หยุด "},Monitor:{"Input Monitor":"มอนิเตอร์อินพุท",name:"ชื่อ","current input window":"หน้าต่างที่กำลังอินพุท",connect:"เชื่อมต่อ"},PFT:{"PFT (Pre-Formatted Text)":"พรีฟอร์แม็ทเท็กซ์","Open... (Ctrl+O)":"เปิด... (Ctrl+O)","Save As (Ctrl+S)":"บันทึกเป็น... (Ctrl+S)","Next Comment (Ctrl+down)":"คอมเมนต์ถัดไป (Ctrl+down)","Previous Comment (Ctrl+up)":"คอมเมนต์ก่อนหน้า (Ctrl+up)","Next Window (Ctrl+right)":"หน้าต่างถัดไป (Ctrl+right)","Previous Window (Ctrl+left)":"หน้าต่างก่อนหน้า (Ctrl+left)","PFT files":"พีเอฟทีไฟล์ ","UTF-8 PFT files":"UTF-8 พีเอฟทีไฟล์ ","Unicode PFT files":"ยูนิโค้ด พีเอฟทีไฟล์ ","text files":"เท็กซ์ไฟล์"},PftMon:{"PFT Monitor":"มอนิเตอร์พีเอฟที","'s Pre-Formatted Text":"พรีฟอร์แม็ทเท็กซ์"},Fkey:{Shortcut:"ปุ่มลัด","Parenthesize all":"วงเล็บทั้งหมด ",Undo:"กลับที่เดิม","(Not available)":"(ไม่สามารถใช้ได้)"},Note:{},Log:{Log:"ล็อก"},Login:{Login:"ล็อกอิน ","LAN card":"แลนการ์ด",Name:"ชื่อ",Channel:"ช่องทาง",Group:"กลุ่ม","The network port is occupied by other application.\nSelect another channel and login.":"เน็ทเวิร์คพอร์ต\nมีแอพพลิเคชั่นอื่นใช้อยู่\nเลือกช่องทางอื่นแล้ว\nล็อกอิน","Network error occurs. Make sure network connection.":"เกิดข้อผิดพลาดจากเน็ทเวิร์ค \nตรวจสอบการเชื่อมต่อ\nเน็ทเวิร์ค","(No Network Available)":"(ไม่มีเน็ทเวิร์ค)"},Config:{Config:"การตั้งค่า "},"Config|General":{"Font Size":"ขนาดฟอนต์","Font Name":"ฟ้อนต์","Font Color":"สีฟ้อนต์",Bold:"ตัวหนา","Background Color":"สีพื้นหลัง",Show:"แสดง"},"Config|Misc":{General:"การติดตั้งทั้งหมด","Re-Login":"ล็อกอินใหม่","Full Screen":"เต็มจอภาพ","Select Language":"เลือกภาษา","To make your choice effective, Restart mekiku-M.":"เพื่อให้ได้งานตามที่คุณ เลือก, เริ่มเปิด mekiku-M อีกครั้ง","Save log":"บันทึก","Save main log":"บันทึก (ล็อกหน้าต่างหลัก)","Save chat log":"บันทึก (ล็อกหน้าต่างแช็ท)","Startup Settings":"ตั้งค่าเริ่มต้น","Keep Last Settings":"ตั้งเป็นค่าล่าสุด"},"Config|Main":{"Main Display":"จอแสดงผลหลัก","Display style":"การแสดงรูปแบบ",Normal:"ปกติ","Full Width":"ความกว้างเต็มจอ","Full Window":"เต็มหน้าต่าง","Line Height":"ความสูงบรรทัด","Scroll interval per line":"ระยะห่างของสกรอล ต่อบรรทัด",msec:"มิลลิเซ็คเคิ่น"},"Config|Input":{"Parentheses on F8 press":"ใส่วงเล็บโดยกด F8","Parentheses on Shift+F8 press":"Shift+F8","“":'""',"”":'""',"(":"(",")":")"},"Config|Chat":{"Notification Color":"สีเตือน"},"Config|Monitor":{"Background Color On Loss":"สีพื้นหลัง  เปิดและตัด"},"Config|PFT":{"Background Color (Name)":"สีพื้นหลัง(ชื่อไฟล์)","Background Color (Name of Other Panes)":"สีพื้นหลัง(ชื่อไฟล์อื่น)","Display All":"ดิสเพลย์ทั้งหมด","Current Window Width":"ความกว้างหน้าต่างปัจจุบัน","Same As Others (x1.0)":"เหมือนอื่นๆ","50% wider (x1.5)":"กว้างขึ้น 1.5 เท่า","double (x2.0)":"2 เท่า","triple (x3.0)":"3 เท่า"},"Menu|Menu":{Menu:"เมนู",File:"ไฟล์",Edit:"การแก้ไข","Re-Login":"ล็อกอินใหม่","Open Settings...":"เปิดไฟล์ตั้งค่าที่เซฟไว้ ...","Save Settings As...":"บันทึกค่าที่ตั้งไว้เป็น ...","Config...":"การตั้งค่า ...","Reset All Settings":"ตั้งค่าใหม่หมด","Current As Default":"ตั้งค่าปัจจุบันเป็นค่าเริ่มต้น","Full Screen":"เต็มจอภาพ","Version...":"เวอร์ชั่น ...",Exit:"ออก","mekiku-M settings files":"ไฟล์ตั้งค่า mekiku-M",Undo:"เลิกทำ",Cut:"ตัด",Copy:"คัดลอก",Paste:"วาง","Select All":"เลือกทั้งหมด"}}}}t.T=o,o._instance=null,o._isMac=!1},882:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Util=void 0;const i=n(359);t.Util=class{static beforeOf(e,t){const n=e.indexOf(t);return n<0?e:e.substring(0,n)}static isRoomNameLegit(e){return/^[A-Za-z0-9]+$/.test(e)}static tryGetRoomNameFromURI(){var e,t;const n=null!==(t=null===(e=i.UtilDom.getQuery().reverse().find((e=>""===e[1])))||void 0===e?void 0:e[0])&&void 0!==t?t:location.hash;return decodeURIComponent(n)}static tryGetPasswordFromURI(){var e;const t=null===(e=i.UtilDom.getQuery().find((e=>"p"===e[0].toLowerCase())))||void 0===e?void 0:e[1];return null==t?t:decodeURIComponent(t)}static contains(e,...t){for(const n in t)if(e.indexOf(t[n])>=0)return!0;return!1}static isString(e){return"string"==typeof e||e instanceof String}static isNumber(e){return"number"==typeof e&&isFinite(e)}static toNumber(e,t=0){if(this.isNumber(e))return e;if(this.isString(e)){const t=parseInt(e,10);if(!1===Number.isNaN(t))return t}return t}static getNowUTCTimeString(){const e=new Date;return`${e.getUTCHours().toString().padStart(2,"0")}:${e.getUTCMinutes().toString().padStart(2,"0")}:${e.getUTCSeconds().toString().padStart(2,"0")}.${e.getUTCMilliseconds().toString().padStart(3,"0")}`}static arraySum(e,t){var n=0;return e.forEach(((e,i,o)=>{n+=t(e,i,o)})),n}static toLf(e){return e.replace(/\r\n?/g,"\n")}static toCrLf(e){return this.toLf(e).replace(/\n/g,"\r\n")}static toStringWithZero(e,t){return("0".repeat(t)+e.toFixed(0)).slice(-t)}static getNewLineCode(){return this.isWin()?"\r\n":"\n"}static isWin(){return!!window.navigator.platform.toLowerCase().includes("win")}static isMac(){const e=window.navigator.platform.toLowerCase();return!!(e.includes("mac")||e.includes("iphone")||e.includes("ipad"))}static isIOS(){const e=window.navigator.platform.toLowerCase();return e.includes("iphone")||e.includes("ipad")||e.includes("ipod")}static isIPhone(){return window.navigator.platform.toLowerCase().includes("iphone")}static isIPad(){return window.navigator.platform.toLowerCase().includes("ipad")}static isLine(){return navigator.userAgent.toLowerCase().includes(" line")}static getShortcutTextRaw(e){return e.length<1?"":(this.isMac()?"Cmd+":"Ctrl+")+e.charAt(0)}static getShortcutText(e){return e.length<1?"":" "+this.getShortcutTextRaw(e)}static getShortcutParenthesized(e){return e.length<1?"":" ("+this.getShortcutTextRaw(e)+")"}static getShiftShortcutTextRaw(e){return e.length<1?"":(this.isMac()?"Shift+Cmd+":"Ctrl+Shift+")+e.charAt(0)}static getShiftShortcutText(e){return e.length<1?"":" "+this.getShiftShortcutTextRaw(e)}static getShiftShortcutParenthesized(e){return e.length<1?"":" ("+this.getShiftShortcutTextRaw(e)+")"}static numberToText2(e){return e.toString().padStart(2,"0")}static getIsoModifiedDateTimeString(){const e=new Date;return`${e.getFullYear().toString()}-${this.numberToText2(e.getMonth()+1)}-${this.numberToText2(e.getDate())}_${this.numberToText2(e.getHours())}:${this.numberToText2(e.getMinutes())}:${this.numberToText2(e.getSeconds())}`}static getIsoStyleDateString(){const e=new Date;return`${e.getFullYear().toString()}-${this.numberToText2(e.getMonth()+1)}-${this.numberToText2(e.getDate())}`}static async digestMessage(e){const t=(new TextEncoder).encode(e),n=await crypto.subtle.digest("SHA-256",t);return Array.from(new Uint8Array(n)).map((e=>e.toString(16).padStart(2,"0"))).join("")}constructor(){}}},441:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ColorManager=void 0;class n{constructor(){this.userColors=[]}color(e){var t;return this.userColors.find((t=>t.id===e)),this.userColors.findIndex((t=>t.id===e)),null===(t=this.userColors.find((t=>t.id===e)))||void 0===t?void 0:t.hsl}regist(e){const t=this.userColors.find((e=>{e.id}));if(void 0!==t)return t.hsl;let i={h:0,s:0,l:25};for(let e=0;e<48;e++){let t=this.selectColor(e);if(this.userColors.findIndex((e=>n.areSameHSLs(e.hsl,t)))<0){i=t;break}}const o={id:e,hsl:i};return this.userColors.push(o),i}unregist(e){this.userColors=this.userColors.filter((t=>t.id!==e))}clear(){this.userColors=[]}static toString(e){return`hsl(${e.h} , ${e.s}%, ${e.l}%)`}static white(){return{h:0,s:100,l:100}}static areSameHSLs(e,t){return e.h===t.h&&e.s===t.s&&e.l===t.l}selectColor(e){return e<0&&(e=-e),e<12?{h:(5*e*30+120)%360,s:100,l:75}:e<24?{h:(5*(e-12)*30+120)%360,s:100,l:50}:e<36?{h:(5*(e-24)*30+15+120)%360,s:100,l:75}:e<48?{h:(5*(e-36)*30+15+120)%360,s:100,l:50}:{h:113*(e-48)+120,s:100,l:62}}}t.ColorManager=n},359:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UtilDom=void 0;const i=n(882);class o{constructor(){}static getQuery(){const e=location.search;if(e.length>0&&"?"===e[0]){const t=[];for(const n of e.substring(1).split("&")){if(n.length<1)continue;const e=n.split("=");e.length<=1?t.push([decodeURIComponent(n),""]):t.push([decodeURIComponent(e[0]),decodeURIComponent(e[1])])}return t}return[]}static setQuery(e){history.replaceState({},"","?"+encodeURIComponent(e))}static getWidth(e){return e?e.getBoundingClientRect().width:-1}static show(e){null!=e&&(e.style.visibility="visible")}static hide(e){null!=e&&(e.style.visibility="hidden")}static isShown(e){return null!=e&&"visible"===e.style.visibility}static displayOn(e,t="initial"){null!=e&&(e.style.display=t)}static displayOff(e){null!=e&&(e.style.display="none")}static isDisplayed(e){return null!=e&&"none"!==e.style.display}static makeDialogsRespondToKey(){for(const e of document.querySelectorAll("div.dialog")){if(e.classList.contains("ignore_return"))continue;const t=e.querySelector("button.submit"),n=null!=t?t:void 0,i=e.querySelector("button.cancel"),r=null!=i?i:void 0;for(const t of e.querySelectorAll('input[type="text"]'))t.addEventListener("keydown",(e=>{e.keyCode===o.KEY_ENTER&&(null==n||n.click()),e.keyCode===o.KEY_ESC&&(null==r||r.click())}));for(const t of e.querySelectorAll('input[type="password"]'))t.addEventListener("keydown",(e=>{e.keyCode===o.KEY_ENTER&&(null==n||n.click()),e.keyCode===o.KEY_ESC&&(null==r||r.click())}))}}static getFKeyNumber(e){if(e.length<2||e.length>3)return-1;if("F"!==e.charAt(0))return-1;const t=Number(e.substr(1));return Number.isInteger(t)&&t>0?t:-1}static getFKeyNumberByKeyCode(e){return e<112||e>123?-1:e-111}static getCtrlOrFKeyNumber(e){const t=this.getFKeyNumberByKeyCode(e.keyCode);return t>=0?t:e.key>="0"&&e.key<="9"&&this.isCommandOrControlPressed(e)?parseInt(e.key):/^Digit[0-9]$/.test(e.code)&&this.isCommandOrControlPressed(e)?parseInt(e.code.substr(5)):-1}static isCommandOrControlPressed(e){return navigator.platform,i.Util.isMac()?e.metaKey:e.ctrlKey}static parseFloatEx(e,t=0){return null!==e?parseFloat(e):t}static makeFontFamily(e,t="sans-serif"){return null===e||e.trim().length<1?t:e.trim()===t?e:e+" , "+t}static addSelectOption(e,t,n){const i=document.createElement("option");i.text=t,i.value=n,e.add(i)}static extractCSSRulesByText(e){return this.extractCSSRules((t=>t.cssText.indexOf(e)>=0))}static extractCSSRules(e){var t=[];for(const n of document.styleSheets)for(const i of n.cssRules)e(i)&&t.push(i);return t}static getModifierKey(e){return(e.shiftKey?this.MK_SHIFT:0)+(e.ctrlKey?this.MK_CTRL:0)+(e.altKey?this.MK_ALT:0)+(e.metaKey?this.MK_META:0)}static getLuminance(e){const t=/^#([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/.exec(e);if(null===t)return-1;if(t[3]){const e=parseInt(t[1],16),n=parseInt(t[2],16),i=parseInt(t[3],16);return(Math.max(e,n,i)+Math.min(e,n,i))/2}return-1}}t.UtilDom=o,o.MK_SHIFT=1,o.MK_CTRL=2,o.MK_ALT=4,o.MK_META=8,o.KEY_TAB=9,o.KEY_ENTER=13,o.KEY_CTRL=17,o.KEY_ESC=27,o.KEY_ARROW_LEFT=37,o.KEY_ARROW_UP=38,o.KEY_ARROW_RIGHT=39,o.KEY_ARROW_DOWN=40,o.KEY_A=65,o.KEY_B=66,o.KEY_C=67,o.KEY_D=68,o.KEY_E=69,o.KEY_F=70,o.KEY_G=71,o.KEY_H=72,o.KEY_I=73,o.KEY_J=74,o.KEY_K=75,o.KEY_L=76,o.KEY_M=77,o.KEY_N=78,o.KEY_O=79,o.KEY_P=80,o.KEY_Q=81,o.KEY_R=82,o.KEY_S=83,o.KEY_T=84,o.KEY_U=85,o.KEY_V=86,o.KEY_W=87,o.KEY_X=88,o.KEY_Y=89,o.KEY_Z=90}},t={};function n(i){var o=t[i];if(void 0!==o)return o.exports;var r=t[i]={exports:{}};return e[i].call(r.exports,r,r.exports,n),r.exports}n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n(607)})();